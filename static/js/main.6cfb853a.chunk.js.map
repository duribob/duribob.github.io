{"version":3,"sources":["../node_modules/peerjs/dist sync","../../types/PlayerBehavior.ts","characters/Player.ts","events/EventCenter.ts","util.ts","../../types/BackgroundMode.ts","stores/UserStore.ts","stores/ChatStore.ts","web/ShareScreenManager.ts","stores/ComputerStore.ts","stores/WhiteboardStore.ts","../../types/Rooms.ts","stores/RoomStore.ts","stores/index.ts","../../types/Items.ts","characters/MyPlayer.ts","characters/OtherPlayer.ts","../../types/Messages.ts","characters/PlayerSelector.ts","scenes/Game.ts","anims/CharacterAnims.ts","scenes/Background.ts","web/WebRTC.ts","services/Network.ts","scenes/Bootstrap.ts","PhaserGame.ts","MuiTheme.js","hooks.ts","components/CustomRoomTable.tsx","components/CreateRoomForm.tsx","components/RoomSelectionDialog.tsx","components/LoginDialog.tsx","assets/Adam_login.png","assets/Lucy_login.png","App.tsx","reportWebVitals.ts","index.tsx"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","PlayerBehavior","Event","sittingShiftData","up","down","left","right","Player","scene","x","y","texture","frame","playerId","playerTexture","playerBehavior","IDLE","readyToConnect","videoConnected","playerName","playerContainer","playerDialogBubble","timeoutID","setDepth","anims","play","add","container","text","setFontFamily","setFontSize","setColor","setOrigin","physics","world","enable","collisionScale","body","setSize","width","height","setOffset","content","this","clearDialogBubble","dialogBubbleText","length","substring","concat","innerText","wordWrap","useAdvancedWrap","innerTextHeight","innerTextWidth","setY","dialogBoxWidth","dialogBoxHeight","dialogBoxX","dialogBoxY","graphics","fillStyle","fillRoundedRect","lineStyle","strokeRoundedRect","window","setTimeout","clearTimeout","removeAll","Phaser","Physics","Arcade","Sprite","phaserEvents","Events","EventEmitter","sanitizeId","sanitized","endsWith","replace","BackgroundMode","colorArr","getColorByString","string","Math","floor","charCodeAt","getAvatarString","name","part","split","MessageType","userSlice","createSlice","initialState","backgroundMode","currentHour","Date","getHours","DAY","NIGHT","getInitialBackgroundMode","sessionId","loggedIn","playerNameMap","Map","reducers","toggleBackgroundMode","state","newMode","phaserGame","bootstrap","changeBackgroundMode","setSessionId","action","payload","setVideoConnected","setLoggedIn","setPlayerNameMap","set","removePlayerNameMap","delete","actions","ShareScreenManager","userId","myPeer","myStream","sanatizedId","makeId","Peer","on","err","console","log","type","error","call","answer","userVideoStream","store","dispatch","addVideoStream","peer","stream","disconnected","reconnect","stopScreenShare","disconnect","navigator","mediaDevices","getDisplayMedia","video","audio","then","track","getVideoTracks","onended","setMyStream","computerItem","game","computerMap","get","getState","computer","computerId","currentUsers","onUserJoined","shouldDispatch","getTracks","forEach","stop","undefined","network","onStopScreenShare","removeVideoStream","computerDialogOpen","peerStreams","shareScreenManager","computerSlice","openComputerDialog","myUserId","disableKeys","onOpen","closeComputerDialog","enableKeys","disconnectFromComputer","values","close","onClose","clear","whiteboardDialogOpen","whiteboardId","whiteboardUrl","urls","whiteboardSlice","openWhiteboardDialog","url","closeWhiteboardDialog","disconnectFromWhiteboard","setWhiteboardUrls","roomId","RoomType","chatSlice","chatMessages","Array","focused","showChat","pushChatMessage","push","messageType","REGULAR_MESSAGE","chatMessage","pushPlayerJoinedMessage","PLAYER_JOINED","createdAt","getTime","author","pushPlayerLeftMessage","PLAYER_LEFT","setFocused","setShowChat","isCustomRoom","room","CUSTOM","roomSlice","lobbyJoined","roomJoined","roomName","roomDescription","availableRooms","setLobbyJoined","setRoomJoined","setJoinedRoomData","description","setAvailableRooms","filter","addAvailableRooms","roomIndex","findIndex","removeAvailableRooms","enableMapSet","ItemType","configureStore","reducer","user","userReducer","computerReducer","whiteboard","whiteboardReducer","chat","chatReducer","roomReducer","middleware","getDefaultMiddleware","serializableCheck","MyPlayer","playContainerBody","chairOnSit","setText","emit","MY_PLAYER_NAME_CHANGE","MY_PLAYER_TEXTURE_CHANGE","currentAnim","key","playerSelector","cursors","keyE","keyR","item","selectedItem","Input","Keyboard","JustDown","itemType","COMPUTER","openDialog","WHITEBOARD","VENDINGMACHINE","open","CHAIR","chairItem","time","addEvent","delay","callback","setVelocity","itemDirection","setPosition","depth","updatePlayer","loop","clearDialogBox","setDialogBox","SITTING","speed","vx","vy","isDown","velocity","setLength","parts","newAnim","join","update","GameObjects","GameObjectFactory","register","sprite","displayList","updateList","enableBody","DYNAMIC_BODY","OtherPlayer","targetPosition","lastUpdateTimestamp","connectionBufferTime","connected","myPlayer","webRTC","myPlayerId","connectToNewUser","field","value","fromScene","destroy","t","dt","animParts","animDir","delta","dx","dy","abs","embedded","touching","none","PLAYER_DISCONNECTED","Message","PlayerSelector","existing","player","overlap","Zone","Game","map","otherPlayers","otherPlayerMap","whiteboardMap","input","keyboard","createCursorKeys","addKey","disableGlobalCapture","event","enabled","data","animsFrameRate","create","frames","generateFrameNames","start","end","repeat","frameRate","createCharacterAnims","make","tilemap","FloorAndGround","addTilesetImage","groundLayer","createLayer","setCollisionByProperty","collides","mySessionId","group","classType","cameras","main","zoom","startFollow","collider","handleItemSelectorOverlap","handlePlayersOverlap","onPlayerJoined","handlePlayerJoined","onPlayerLeft","handlePlayerLeft","onMyPlayerReady","handleMyPlayerReady","onMyPlayerVideoConnected","handleMyVideoConnected","onPlayerUpdated","handlePlayerUpdated","onItemUserAdded","handleItemUserAdded","onItemUserRemoved","handleItemUserRemoved","onChatMessageAdded","handleChatMessageAdded","selectionItem","currentItem","onOverlapDialog","object","tilesetName","actualX","actualY","gid","getTileset","firstgid","objectLayerName","collidable","staticGroup","getObjectLayer","objects","newPlayer","otherPlayer","has","remove","updateOtherPlayer","makeCall","itemId","addCurrentUser","removeCurrentUser","updateDialogBubble","Scene","Background","cloud","cloudKey","backdropKey","sceneHeight","sceneWidth","setBackgroundColor","backdropImage","image","scale","max","setScale","setScrollFactor","sunMoonImage","scale2","textures","getFrameNames","i","RND","between","wrap","WebRTC","peers","onCalledPeers","videoGrid","document","querySelector","buttonGrid","myVideo","createElement","sanitizedId","replaceInvalidId","muted","initialize","permissions","query","result","getUserMedia","alertOnError","setUpButtons","catch","alert","srcObject","addEventListener","append","onCalledPeer","audioButton","audioTrack","getAudioTracks","videoButton","Network","client","lobby","location","protocol","Client","joinLobbyRoom","updatePlayerName","playerStreamDisconnect","a","joinOrCreate","LOBBY","onMessage","rooms","PUBLIC","password","joinById","roomData","autoDispose","leave","players","onAdd","onChange","changes","change","PLAYER_UPDATED","onRemove","deleteVideoStream","deleteOnCalledVideoStream","computers","connectedUser","index","ITEM_USER_ADDED","ITEM_USER_REMOVED","whiteboards","SEND_ROOM_DATA","ADD_CHAT_MESSAGE","clientId","UPDATE_DIALOG_BUBBLE","DISCONNECT_STREAM","STOP_SCREEN_SHARE","onUserLeft","context","MY_PLAYER_READY","MY_PLAYER_VIDEO_CONNECTED","currentX","currentY","send","UPDATE_PLAYER","anim","currentName","UPDATE_PLAYER_NAME","READY_TO_CONNECT","VIDEO_CONNECTED","CONNECT_TO_COMPUTER","DISCONNECT_FROM_COMPUTER","CONNECT_TO_WHITEBOARD","DISCONNECT_FROM_WHITEBOARD","Bootstrap","load","atlas","tilemapTiledJSON","spritesheet","frameWidth","frameHeight","launchBackground","checkPreviousPermission","launch","config","AUTO","parent","backgroundColor","pixelArt","mode","Scale","ScaleModes","RESIZE","innerWidth","innerHeight","default","arcade","gravity","debug","autoFocus","muiTheme","createTheme","palette","primary","secondary","useAppSelector","useSelector","MessageText","styled","p","CustomRoomTableContainer","TableContainer","TableRowWrapper","TableRow","PasswordDialog","Dialog","CustomRoomTable","useState","setPassword","selectedRoom","setSelectedRoom","showPasswordDialog","setShowPasswordDialog","showPasswordError","setShowPasswordError","passwordFieldEmpty","setPasswordFieldEmpty","handleJoinClick","joinCustomById","launchGame","resetPasswordDialog","component","Paper","Table","TableHead","TableCell","align","TableBody","metadata","clients","hasPassword","Avatar","className","style","background","Tooltip","title","Button","variant","color","onClick","onSubmit","preventDefault","isValidPassword","DialogContent","TextField","fullWidth","helperText","label","onInput","target","Alert","severity","DialogActions","CreateRoomFormWrapper","form","CreateRoomForm","setValues","showPassword","setShowPassword","nameFieldEmpty","setNameFieldEmpty","descriptionFieldEmpty","setDescriptionFieldEmpty","handleChange","prop","isValidName","isValidDescription","createCustom","multiline","rows","InputProps","endAdornment","InputAdornment","position","IconButton","edge","Backdrop","div","Wrapper","CustomRoomWrapper","BackButtonWrapper","Title","h1","Content","ProgressBarWrapper","ProgressBar","LinearProgress","RoomSelectionDialog","showCustomRoom","setShowCustomRoom","showCreateRoomForm","setShowCreateRoomForm","showSnackbar","setShowSnackbar","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","placement","joinOrCreatePublic","SwiperCore","use","Navigation","RoomName","RoomDescription","SubTitle","h3","Left","Right","Bottom","Warning","avatars","img","j","random","LoginDialog","setName","avatarIndex","setAvatarIndex","useDispatch","registerKeys","setPlayerName","setPlayerTexture","navigation","spaceBetween","slidesPerView","onSlideChange","swiper","activeIndex","avatar","src","alt","size","App","ui","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","ThemeProvider","theme","getElementById"],"mappings":"qIAAA,SAASA,EAAoBC,GAC5B,IAAIC,EAAI,IAAIC,MAAM,uBAAyBF,EAAM,KAEjD,MADAC,EAAEE,KAAO,mBACHF,EAEPF,EAAoBK,KAAO,WAAa,MAAO,IAC/CL,EAAoBM,QAAUN,EAC9BO,EAAOC,QAAUR,EACjBA,EAAoBS,GAAK,K,mDCRbC,E,sHAAAA,O,eAAAA,I,sBAAAA,M,KCML,ICFKC,EDECC,EAAmB,CAC9BC,GAAI,CAAC,EAAG,GAAI,IACZC,KAAM,CAAC,EAAG,EAAG,GACbC,KAAM,CAAC,GAAI,EAAG,IACdC,MAAO,CAAC,GAAI,EAAG,KAGIC,E,kDAWnB,WACEC,EACAC,EACAC,EACAC,EACAZ,EACAa,GACC,IAAD,uBACA,cAAMJ,EAAOC,EAAGC,EAAGC,EAASC,IAlB9BC,cAiBE,IAhBFC,mBAgBE,IAfFC,eAAiBf,EAAegB,KAe9B,EAdFC,gBAAiB,EAcf,EAbFC,gBAAiB,EAaf,EAZFC,gBAYE,IAXFC,qBAWE,IAVMC,wBAUN,IATMC,eASN,EAGA,EAAKT,SAAWd,EAChB,EAAKe,cAAgBH,EACrB,EAAKY,SAAS,EAAKb,GAEnB,EAAKc,MAAMC,KAAX,UAAmB,EAAKX,cAAxB,eAAmD,GAEnD,EAAKM,gBAAkB,EAAKZ,MAAMkB,IAAIC,UAAU,EAAKlB,EAAG,EAAKC,EAAI,IAAIa,SAAS,KAG9E,EAAKF,mBAAqB,EAAKb,MAAMkB,IAAIC,UAAU,EAAG,GAAGJ,SAAS,KAClE,EAAKH,gBAAgBM,IAAI,EAAKL,oBAG9B,EAAKF,WAAa,EAAKX,MAAMkB,IAC1BE,KAAK,EAAG,EAAG,IACXC,cAAc,SACdC,YAAY,IACZC,SAAS,WACTC,UAAU,IACb,EAAKZ,gBAAgBM,IAAI,EAAKP,YAE9B,EAAKX,MAAMyB,QAAQC,MAAMC,OAAO,EAAKf,iBACrC,IACMgB,EAAiB,CAAC,GAAK,IA1B7B,OAyB0B,EAAKhB,gBAAgBiB,KAG5CC,QAAQ,EAAKC,MAAQH,EAAe,GAAI,EAAKI,OAASJ,EAAe,IACrEK,WAAW,EAAG,EAAKD,QAAU,EAAIJ,EAAe,IAAM,GA7BzD,E,sDAgCF,SAAmBM,GAAkB,IAAD,OAClCC,KAAKC,oBAGL,IAAMC,EAAmBH,EAAQI,QAAU,GAAKJ,EAAUA,EAAQK,UAAU,EAAG,IAAIC,OAAO,OAEpFC,EAAYN,KAAKnC,MAAMkB,IAC1BE,KAAK,EAAG,EAAGiB,EAAkB,CAAEK,SAAU,CAAEX,MAAO,IAAKY,iBAAiB,KACxEtB,cAAc,SACdC,YAAY,IACZC,SAAS,WACTC,UAAU,IAGPoB,EAAkBH,EAAUT,OAC5Ba,EAAiBJ,EAAUV,MAEjCU,EAAUK,MAAMF,EAAkB,EAAIT,KAAKxB,WAAWqB,OAAS,GAC/D,IAAMe,EAAiBF,EAAiB,GAClCG,EAAkBJ,EAAkB,EACpCK,EAAaR,EAAUxC,EAAI4C,EAAiB,EAAI,EAChDK,EAAaT,EAAUvC,EAAI0C,EAAkB,EAAI,EAEvDT,KAAKtB,mBAAmBK,IACtBiB,KAAKnC,MAAMkB,IACRiC,WACAC,UAAU,SAAU,GACpBC,gBAAgBJ,EAAYC,EAAYH,EAAgBC,EAAiB,GACzEM,UAAU,EAAG,EAAU,GACvBC,kBAAkBN,EAAYC,EAAYH,EAAgBC,EAAiB,IAEhFb,KAAKtB,mBAAmBK,IAAIuB,GAG5BN,KAAKrB,UAAY0C,OAAOC,YAAW,WACjC,EAAKrB,sBACJ,O,+BAGL,WACEsB,aAAavB,KAAKrB,WAClBqB,KAAKtB,mBAAmB8C,WAAU,O,GA3FFC,IAAOC,QAAQC,OAAOC,QCX7CC,EAAe,IAAIJ,IAAOK,OAAOC,c,SAElCzE,K,8BAAAA,E,gCAAAA,E,0BAAAA,E,0CAAAA,E,kCAAAA,E,8CAAAA,E,oDAAAA,E,sDAAAA,E,kCAAAA,E,sCAAAA,E,6CAAAA,M,yBCJL,SAAS0E,EAAW5E,GACzB,IAAI6E,EAAY7E,EAMhB,OAJI6E,EAAU9B,OAAS,GAAK8B,EAAUC,SAAS,SAC7CD,EAAYA,EAAU7B,UAAU,EAAG6B,EAAU9B,OAAS,IAGjD8B,EAAUE,QAAQ,cAAe,KAG1C,ICVYC,EDUNC,EAAW,CACf,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAIK,SAASC,EAAiBC,GAC/B,OAAOF,EAASG,KAAKC,MAAMF,EAAOG,WAAW,GAAKL,EAASlC,SAGtD,SAASwC,EAAgBC,GAC9B,IAAMC,EAAOD,EAAKE,MAAM,KACxB,OAAOD,EAAK1C,OAAS,EAAI0C,EAAK,GAAG,GAAKA,EAAK,GAAG,GAAKA,EAAK,GAAG,I,SC5BjDT,O,aAAAA,I,kBAAAA,M,KCYL,ICPKW,EDOCC,EAAYC,YAAY,CACnCL,KAAM,OACNM,aAAc,CACZC,eARG,WACL,IAAMC,GAAc,IAAIC,MAAOC,WAC/B,OAAOF,EAAc,GAAKA,GAAe,GAAKhB,EAAemB,IAAMnB,EAAeoB,MAMhEC,GAChBC,UAAW,GACXnF,gBAAgB,EAChBoF,UAAU,EACVC,cAAe,IAAIC,KAErBC,SAAU,CACRC,qBAAsB,SAACC,GACrB,IAAMC,EACJD,EAAMb,iBAAmBf,EAAemB,IAAMnB,EAAeoB,MAAQpB,EAAemB,IAEtFS,EAAMb,eAAiBc,EACLC,GAAWrG,MAAMb,KAAKmH,UAC9BC,qBAAqBH,IAEjCI,aAAc,SAACL,EAAOM,GACpBN,EAAMN,UAAYY,EAAOC,SAE3BC,kBAAmB,SAACR,EAAOM,GACzBN,EAAMzF,eAAiB+F,EAAOC,SAEhCE,YAAa,SAACT,EAAOM,GACnBN,EAAML,SAAWW,EAAOC,SAE1BG,iBAAkB,SAACV,EAAOM,GACxBN,EAAMJ,cAAce,IAAI3C,EAAWsC,EAAOC,QAAQnH,IAAKkH,EAAOC,QAAQ3B,OAExEgC,oBAAqB,SAACZ,EAAOM,GAC3BN,EAAMJ,cAAciB,OAAO7C,EAAWsC,EAAOC,cAK5C,EAOHvB,EAAU8B,QALZT,GAFK,EACLN,qBADK,EAELM,cACAG,EAHK,EAGLA,kBACAC,EAJK,EAILA,YACAC,EALK,EAKLA,iBACAE,EANK,EAMLA,oBAGa5B,IAAf,Q,yBEnDqB+B,E,WAInB,WAAoBC,GAAiB,yBAAjBA,SAAgB,KAH5BC,YAG4B,OAFpCC,cAEoC,EAClC,IAAMC,EAAcnF,KAAKoF,OAAOJ,GAChChF,KAAKiF,OAAS,IAAII,IAAKF,GACvBnF,KAAKiF,OAAOK,GAAG,SAAS,SAACC,GACvBC,QAAQC,IAAI,6BAA8BF,EAAIG,MAC9CF,QAAQG,MAAM,oBAAqBJ,MAGrCvF,KAAKiF,OAAOK,GAAG,QAAQ,SAACM,GACtBA,EAAKC,SAELD,EAAKN,GAAG,UAAU,SAACQ,GACjBC,GAAMC,SAASC,EAAe,CAAE7I,GAAIwI,EAAKM,KAAMN,OAAMO,OAAQL,W,0CAMnE,WACM9F,KAAKiF,OAAOmB,cACdpG,KAAKiF,OAAOoB,c,qBAIhB,WACErG,KAAKsG,iBAAgB,GACrBtG,KAAKiF,OAAOsB,e,oBAMd,SAAenJ,GACb,MAAM,GAAN,OAAUA,EAAG+E,QAAQ,cAAe,KAApC,S,8BAGF,WAAoB,IAAD,SACjB,UAAAqE,UAAUC,oBAAV,SACIC,gBAAgB,CAChBC,OAAO,EACPC,OAAO,IAERC,MAAK,SAACV,GAGL,IAAMW,EAAQX,EAAOY,iBAAiB,GAClCD,IACFA,EAAME,QAAU,WACd,EAAKV,oBAIT,EAAKpB,SAAWiB,EAChBJ,GAAMC,SAASiB,EAAYd,IAG3B,IACMe,EADOhD,GAAWrG,MAAMb,KAAKmK,KACTC,YAAYC,IAAItB,GAAMuB,WAAWC,SAASC,YACpE,GAAIN,EAAc,CAAC,IAAD,gBACKA,EAAaO,cADlB,IAChB,2BAAgD,CAAC,IAAtCzC,EAAqC,QAC9C,EAAK0C,aAAa1C,IAFJ,qC,6BAWxB,WAAwC,IAAD,EAAvB2C,IAAuB,yDAGrC,GAFA,UAAA3H,KAAKkF,gBAAL,SAAe0C,YAAYC,SAAQ,SAACf,GAAD,OAAWA,EAAMgB,UACpD9H,KAAKkF,cAAW6C,EACZJ,EAAgB,CAClB5B,GAAMC,SAASiB,EAAY,OAE3B,IAAME,EAAOjD,GAAWrG,MAAMb,KAAKmK,KACnCA,EAAKa,QAAQC,kBAAkBlC,GAAMuB,WAAWC,SAASC,e,0BAI7D,SAAaxC,GACX,GAAKhF,KAAKkF,UAAYF,IAAWhF,KAAKgF,OAAtC,CAEA,IAAMG,EAAcnF,KAAKoF,OAAOJ,GAChChF,KAAKiF,OAAOW,KAAKT,EAAanF,KAAKkF,a,wBAGrC,SAAWF,GACT,GAAIA,IAAWhF,KAAKgF,OAApB,CAEA,IAAMG,EAAcnF,KAAKoF,OAAOJ,GAChCe,GAAMC,SAASkC,EAAkB/C,S,KChF/BjC,EAA8B,CAClCiF,oBAAoB,EACpBX,WAAY,KACZtC,SAAU,KACVkD,YAAa,IAAIvE,IACjBwE,mBAAoB,MAGTC,EAAgBrF,YAAY,CACvCL,KAAM,WACNM,eACAY,SAAU,CACRyE,mBAAoB,SAClBvE,EACAM,GAEKN,EAAMqE,qBACTrE,EAAMqE,mBAAqB,IAAItD,EAAmBT,EAAOC,QAAQiE,WAEtDtE,GAAWrG,MAAMb,KAAKmK,KAC9BsB,cACLzE,EAAMqE,mBAAmBK,SACzB1E,EAAMmE,oBAAqB,EAC3BnE,EAAMwD,WAAalD,EAAOC,QAAQiD,YAEpCmB,oBAAqB,SAAC3E,GAAW,IAAD,EAExBmD,EAAOjD,GAAWrG,MAAMb,KAAKmK,KACnCA,EAAKyB,aACLzB,EAAKa,QAAQa,uBAAuB7E,EAAMwD,YAJZ,oBAKPxD,EAAMoE,YAAYU,UALX,IAK9B,2BAAmD,SAAtClD,KACNmD,SANuB,8BAQ9B,UAAA/E,EAAMqE,0BAAN,SAA0BW,UAC1BhF,EAAMmE,oBAAqB,EAC3BnE,EAAMkB,SAAW,KACjBlB,EAAMwD,WAAa,KACnBxD,EAAMoE,YAAYa,SAEpBhC,YAAa,SAACjD,EAAOM,GACnBN,EAAMkB,SAAWZ,EAAOC,SAE1B0B,eAAgB,SACdjC,EACAM,GAEAN,EAAMoE,YAAYzD,IAAI3C,EAAWsC,EAAOC,QAAQnH,IAAK,CACnDwI,KAAMtB,EAAOC,QAAQqB,KACrBO,OAAQ7B,EAAOC,QAAQ4B,UAG3B+B,kBAAmB,SAAClE,EAAOM,GACzBN,EAAMoE,YAAYvD,OAAO7C,EAAWsC,EAAOC,cAK1C,EAMH+D,EAAcxD,QAHhBmC,GAHK,EACL0B,oBADK,EAELJ,mBAFK,EAGLtB,aACAhB,EAJK,EAILA,eACAiC,EALK,EAKLA,kBAGaI,IAAf,QC1EMpF,EAAgC,CACpCgG,sBAAsB,EACtBC,aAAc,KACdC,cAAe,KACfC,KAAM,IAAIxF,KAGCyF,EAAkBrG,YAAY,CACzCL,KAAM,aACNM,eACAY,SAAU,CACRyF,qBAAsB,SAACvF,EAAOM,GAC5BN,EAAMkF,sBAAuB,EAC7BlF,EAAMmF,aAAe7E,EAAOC,QAC5B,IAAMiF,EAAMxF,EAAMqF,KAAKhC,IAAI/C,EAAOC,SAC9BiF,IAAKxF,EAAMoF,cAAgBI,GAClBtF,GAAWrG,MAAMb,KAAKmK,KAC9BsB,eAEPgB,sBAAuB,SAACzF,GACtB,IAAMmD,EAAOjD,GAAWrG,MAAMb,KAAKmK,KACnCA,EAAKyB,aACLzB,EAAKa,QAAQ0B,yBAAyB1F,EAAMmF,cAC5CnF,EAAMkF,sBAAuB,EAC7BlF,EAAMmF,aAAe,KACrBnF,EAAMoF,cAAgB,MAExBO,kBAAmB,SAAC3F,EAAOM,GACzBN,EAAMqF,KAAK1E,IACTL,EAAOC,QAAQ4E,aADjB,8CAEyC7E,EAAOC,QAAQqF,aAMvD,EACLN,EAAgBxE,QAD0C6E,GAArD,EAAQJ,qBAAR,EAA8BE,sBAA9B,EAAqDE,mBAG7CL,IAAf,S,SH9CYvG,O,iCAAAA,I,6BAAAA,I,sCAAAA,M,KAML,IIXK8G,EJWCC,EAAY7G,YAAY,CACnCL,KAAM,OACNM,aAAc,CACZ6G,aAAc,IAAIC,MAClBC,SAAS,EACTC,UAAU,GAEZpG,SAAU,CACRqG,gBAAiB,SAACnG,EAAOM,GACvBN,EAAM+F,aAAaK,KAAK,CACtBC,YAAatH,EAAYuH,gBACzBC,YAAajG,EAAOC,WAGxBiG,wBAAyB,SAACxG,EAAOM,GAC/BN,EAAM+F,aAAaK,KAAK,CACtBC,YAAatH,EAAY0H,cACzBF,YAAa,CACXG,WAAW,IAAIrH,MAAOsH,UACtBC,OAAQtG,EAAOC,QACfxE,QAAS,uBAIf8K,sBAAuB,SAAC7G,EAAOM,GAC7BN,EAAM+F,aAAaK,KAAK,CACtBC,YAAatH,EAAY+H,YACzBP,YAAa,CACXG,WAAW,IAAIrH,MAAOsH,UACtBC,OAAQtG,EAAOC,QACfxE,QAAS,qBAIfgL,WAAY,SAAC/G,EAAOM,GAClB,IAAM6C,EAAOjD,GAAWrG,MAAMb,KAAKmK,KACnC7C,EAAOC,QAAU4C,EAAKsB,cAAgBtB,EAAKyB,aAC3C5E,EAAMiG,QAAU3F,EAAOC,SAEzByG,YAAa,SAAChH,EAAOM,GACnBN,EAAMkG,SAAW5F,EAAOC,YAKvB,GAMHuF,EAAUhF,QALZqF,GADK,GACLA,gBACAK,GAFK,GAELA,wBACAK,GAHK,GAGLA,sBACAE,GAJK,GAILA,WACAC,GALK,GAKLA,YAGalB,KAAf,S,SIhEYD,K,cAAAA,E,mBAAAA,E,iBAAAA,M,KCWZ,IAAMoB,GAAe,SAACC,GACpB,OAAOA,EAAKtI,OAASiH,EAASsB,QAGnBC,GAAYnI,YAAY,CACnCL,KAAM,OACNM,aAAc,CACZmI,aAAa,EACbC,YAAY,EACZ1B,OAAQ,GACR2B,SAAU,GACVC,gBAAiB,GACjBC,eAAgB,IAAIzB,OAEtBlG,SAAU,CACR4H,eAAgB,SAAC1H,EAAOM,GACtBN,EAAMqH,YAAc/G,EAAOC,SAE7BoH,cAAe,SAAC3H,EAAOM,GACrBN,EAAMsH,WAAahH,EAAOC,SAE5BqH,kBAAmB,SACjB5H,EACAM,GAEAN,EAAM4F,OAAStF,EAAOC,QAAQnH,GAC9B4G,EAAMuH,SAAWjH,EAAOC,QAAQ3B,KAChCoB,EAAMwH,gBAAkBlH,EAAOC,QAAQsH,aAEzCC,kBAAmB,SAAC9H,EAAOM,GACzBN,EAAMyH,eAAiBnH,EAAOC,QAAQwH,QAAO,SAACb,GAAD,OAAUD,GAAaC,OAEtEc,kBAAmB,SAAChI,EAAOM,GACzB,GAAK2G,GAAa3G,EAAOC,QAAQ2G,MAAjC,CACA,IAAMe,EAAYjI,EAAMyH,eAAeS,WACrC,SAAChB,GAAD,OAAUA,EAAKtB,SAAWtF,EAAOC,QAAQqF,WAExB,IAAfqC,EACFjI,EAAMyH,eAAeQ,GAAa3H,EAAOC,QAAQ2G,KAEjDlH,EAAMyH,eAAerB,KAAK9F,EAAOC,QAAQ2G,QAG7CiB,qBAAsB,SAACnI,EAAOM,GAC5BN,EAAMyH,eAAiBzH,EAAMyH,eAAeM,QAAO,SAACb,GAAD,OAAUA,EAAKtB,SAAWtF,EAAOC,eAKnF,GAOH6G,GAAUtG,QANZ4G,GADK,GACLA,eACAC,GAFK,GAELA,cACAC,GAHK,GAGLA,kBACAE,GAJK,GAILA,kBACAE,GALK,GAKLA,kBACAG,GANK,GAMLA,qBAGaf,MAAf,QC7DAgB,cAEA,ICVYC,GD+BGtG,GArBDuG,YAAe,CAC3BC,QAAS,CACPC,KAAMC,EACNlF,SAAUmF,EACVC,WAAYC,EACZC,KAAMC,GACN5B,KAAM6B,IAIRC,WAAY,SAACC,GAAD,OACVA,EAAqB,CACnBC,mBAAmB,Q,SCtBbb,O,iBAAAA,I,uBAAAA,I,2BAAAA,I,oCAAAA,Q,SCeSc,G,kDAGnB,WACEtP,EACAC,EACAC,EACAC,EACAZ,EACAa,GACC,IAAD,8BACA,cAAMJ,EAAOC,EAAGC,EAAGC,EAASZ,EAAIa,IAV1BmP,uBASN,IARMC,gBAQN,EAEA,EAAKD,kBAAoB,EAAK3O,gBAAgBiB,KAF9C,E,iDAKF,SAAckD,GACZ5C,KAAKxB,WAAW8O,QAAQ1K,GACxBf,EAAa0L,KAAKjQ,EAAMkQ,sBAAuB5K,GAC/CmD,GAAMC,SAASwE,GAAwB5H,M,8BAGzC,SAAiB5E,GACfgC,KAAK7B,cAAgBH,EACrBgC,KAAKnB,MAAMC,KAAX,UAAmBkB,KAAK7B,cAAxB,eAAmD,GACnD0D,EAAa0L,KAAKjQ,EAAMmQ,yBAA0BzN,KAAKlC,EAAGkC,KAAKjC,EAAGiC,KAAKnB,MAAM6O,YAAYC,O,oBAG3F,SACEC,EACAC,EACAC,EACAC,EACA/F,GACC,IAAD,eACA,GAAK6F,EAAL,CAEA,IAAMG,EAAOJ,EAAeK,aAE5B,GAAIxM,IAAOyM,MAAMC,SAASC,SAASL,GACjC,cAAQC,QAAR,IAAQA,OAAR,EAAQA,EAAMK,UACZ,KAAKhC,GAASiC,SACKN,EACRO,WAAWvO,KAAK9B,SAAU8J,GACnC,MACF,KAAKqE,GAASmC,WACOR,EACRO,WAAWvG,GACtB,MACF,KAAKqE,GAASoC,eAEZpN,OAAOqN,KAAK,yCAA0C,UAK5D,OAAQ1O,KAAK5B,gBACX,KAAKf,EAAegB,KAElB,GAAIoD,IAAOyM,MAAMC,SAASC,SAASN,KAAa,OAAJE,QAAI,IAAJA,OAAA,EAAAA,EAAMK,YAAahC,GAASsC,MAAO,CAC7E,IAAMC,EAAYZ,EA0ClB,OAnCAhO,KAAKnC,MAAMgR,KAAKC,SAAS,CACvBC,MAAO,GACPC,SAAU,WAER,EAAKC,YAAY,EAAG,GAChBL,EAAUM,gBACZ,EAAKC,YACHP,EAAU9Q,EAAIP,EAAiBqR,EAAUM,eAAe,GACxDN,EAAU7Q,EAAIR,EAAiBqR,EAAUM,eAAe,IACxDtQ,SAASgQ,EAAUQ,MAAQ7R,EAAiBqR,EAAUM,eAAe,IAEvE,EAAK9B,kBAAkB6B,YAAY,EAAG,GACtC,EAAKxQ,gBAAgB0Q,YACnBP,EAAU9Q,EAAIP,EAAiBqR,EAAUM,eAAe,GACxDN,EAAU7Q,EAAIR,EAAiBqR,EAAUM,eAAe,GAAK,KAIjE,EAAKpQ,KAAL,UAAa,EAAKX,cAAlB,gBAAuCyQ,EAAUM,gBAAiB,GAClEtB,EAAeK,kBAAelG,EACE,OAA5B6G,EAAUM,cACZtB,EAAeuB,YAAY,EAAKrR,EAAG,EAAKC,EAAI,EAAK8B,QAEjD+N,EAAeuB,YAAY,EAAG,GAGhCnH,EAAQqH,aAAa,EAAKvR,EAAG,EAAKC,EAAG,EAAKc,MAAM6O,YAAYC,MAE9D2B,MAAM,IAGRV,EAAUW,iBACVX,EAAUY,aAAa,oBACvBxP,KAAKqN,WAAauB,OAClB5O,KAAK5B,eAAiBf,EAAeoS,SAIvC,IAAMC,EAAQ,IACVC,EAAK,EACLC,EAAK,EAoBT,IAnBA,UAAI/B,EAAQnQ,YAAZ,aAAI,EAAcmS,UAAQF,GAAMD,IAChC,UAAI7B,EAAQlQ,aAAZ,aAAI,EAAekS,UAAQF,GAAMD,IACjC,UAAI7B,EAAQrQ,UAAZ,aAAI,EAAYqS,UACdD,GAAMF,EACN1P,KAAKpB,SAASoB,KAAKjC,KAErB,UAAI8P,EAAQpQ,YAAZ,aAAI,EAAcoS,UAChBD,GAAMF,EACN1P,KAAKpB,SAASoB,KAAKjC,IAGrBiC,KAAKiP,YAAYU,EAAIC,GACrB5P,KAAKN,KAAKoQ,SAASC,UAAUL,GAE7B1P,KAAKoN,kBAAkB6B,YAAYU,EAAIC,GACvC5P,KAAKoN,kBAAkB0C,SAASC,UAAUL,GAG/B,IAAPC,GAAmB,IAAPC,GAAU5H,EAAQqH,aAAarP,KAAKlC,EAAGkC,KAAKjC,EAAGiC,KAAKnB,MAAM6O,YAAYC,KAClFgC,EAAK,EACP3P,KAAKlB,KAAL,UAAakB,KAAK7B,cAAlB,eAA6C,QACxC,GAAIwR,EAAK,EACd3P,KAAKlB,KAAL,UAAakB,KAAK7B,cAAlB,cAA4C,QACvC,GAAIyR,EAAK,EACd5P,KAAKlB,KAAL,UAAakB,KAAK7B,cAAlB,cAA4C,QACvC,GAAIyR,EAAK,EACd5P,KAAKlB,KAAL,UAAakB,KAAK7B,cAAlB,YAA0C,OACrC,CACL,IAAM6R,EAAQhQ,KAAKnB,MAAM6O,YAAYC,IAAI7K,MAAM,KAC/CkN,EAAM,GAAK,OACX,IAAMC,EAAUD,EAAME,KAAK,KAEvBlQ,KAAKnB,MAAM6O,YAAYC,MAAQsC,IACjCjQ,KAAKlB,KAAKkR,EAAME,KAAK,MAAM,GAE3BlI,EAAQqH,aAAarP,KAAKlC,EAAGkC,KAAKjC,EAAGiC,KAAKnB,MAAM6O,YAAYC,MAGhE,MAEF,KAAKtQ,EAAeoS,QAElB,GAAIhO,IAAOyM,MAAMC,SAASC,SAASN,GAAO,CAAC,IAAD,EAClCkC,EAAQhQ,KAAKnB,MAAM6O,YAAYC,IAAI7K,MAAM,KAC/CkN,EAAM,GAAK,OACXhQ,KAAKlB,KAAKkR,EAAME,KAAK,MAAM,GAC3BlQ,KAAK5B,eAAiBf,EAAegB,KACrC,UAAA2B,KAAKqN,kBAAL,SAAiBkC,iBACjB3B,EAAeuB,YAAYnP,KAAKlC,EAAGkC,KAAKjC,GACxC6P,EAAeuC,OAAOnQ,KAAM6N,GAC5B7F,EAAQqH,aAAarP,KAAKlC,EAAGkC,KAAKjC,EAAGiC,KAAKnB,MAAM6O,YAAYC,Y,GA7JhC/P,GA4KtC6D,IAAO2O,YAAYC,kBAAkBC,SACnC,YACA,SAEExS,EACAC,EACAC,EACAZ,EACAa,GAEA,IAAMsS,EAAS,IAAIpD,GAASnN,KAAKnC,MAAOC,EAAGC,EAAGC,EAASZ,EAAIa,GAE3D+B,KAAKwQ,YAAYzR,IAAIwR,GACrBvQ,KAAKyQ,WAAW1R,IAAIwR,GAEpBvQ,KAAKnC,MAAMyB,QAAQC,MAAMmR,WAAWH,EAAQ9O,IAAOC,QAAQC,OAAOgP,cAElE,IAAMlR,EAAiB,CAAC,GAAK,IAQ7B,OAPA8Q,EAAO7Q,KACJC,QAAQ4Q,EAAO3Q,MAAQH,EAAe,GAAI8Q,EAAO1Q,OAASJ,EAAe,IACzEK,UACCyQ,EAAO3Q,OAAS,EAAIH,EAAe,IAAM,GACzC8Q,EAAO1Q,QAAU,EAAIJ,EAAe,KAGjC8Q,K,sBC7MUK,G,kDAQnB,WACE/S,EACAC,EACAC,EACAC,EACAZ,EACAwF,EACA3E,GACC,IAAD,8BACA,cAAMJ,EAAOC,EAAGC,EAAGC,EAASZ,EAAIa,IAhB1B4S,oBAeN,IAdMC,yBAcN,IAbMC,qBAAuB,EAa7B,EAZMC,WAAY,EAYlB,EAXM5D,uBAWN,IAVM6D,cAUN,EAEA,EAAKJ,eAAiB,CAAC/S,EAAGC,GAE1B,EAAKS,WAAW8O,QAAQ1K,GACxB,EAAKwK,kBAAoB,EAAK3O,gBAAgBiB,KAL9C,E,4CAQF,SAASuR,EAAoBC,GAC3BlR,KAAKiR,SAAWA,EAChB,IAAME,EAAaF,EAAS/S,UAEzB8B,KAAKgR,WACNhR,KAAK+Q,sBAAwB,KAC7BE,EAAS3S,gBACT0B,KAAK1B,gBACL2S,EAAS1S,gBACT4S,EAAanR,KAAK9B,WAElBgT,EAAOE,iBAAiBpR,KAAK9B,UAC7B8B,KAAKgR,WAAY,EACjBhR,KAAK+Q,qBAAuB,K,+BAIhC,SAAkBM,EAAeC,GAC/B,OAAQD,GACN,IAAK,OACkB,kBAAVC,GACTtR,KAAKxB,WAAW8O,QAAQgE,GAE1B,MAEF,IAAK,IACkB,kBAAVA,IACTtR,KAAK6Q,eAAe,GAAKS,GAE3B,MAEF,IAAK,IACkB,kBAAVA,IACTtR,KAAK6Q,eAAe,GAAKS,GAE3B,MAEF,IAAK,OACkB,kBAAVA,GACTtR,KAAKnB,MAAMC,KAAKwS,GAAO,GAEzB,MAEF,IAAK,iBACkB,mBAAVA,IACTtR,KAAK1B,eAAiBgT,GAExB,MAEF,IAAK,iBACkB,mBAAVA,IACTtR,KAAKzB,eAAiB+S,M,qBAM9B,SAAQC,GACNvR,KAAKvB,gBAAgB+S,UAErB,iEAAcD,K,uBAIhB,SAAUE,EAAWC,GAKnB,GAJA,mEAAgBD,EAAGC,GAIf1R,KAAK8Q,qBAAuBW,EAAIzR,KAAK8Q,oBAAsB,IAM7D,OALA9Q,KAAK8Q,oBAAsBW,EAC3BzR,KAAKlC,EAAIkC,KAAK6Q,eAAe,GAC7B7Q,KAAKjC,EAAIiC,KAAK6Q,eAAe,GAC7B7Q,KAAKvB,gBAAgBX,EAAIkC,KAAK6Q,eAAe,QAC7C7Q,KAAKvB,gBAAgBV,EAAIiC,KAAK6Q,eAAe,GAAK,IAIpD7Q,KAAK8Q,oBAAsBW,EAC3BzR,KAAKpB,SAASoB,KAAKjC,GACnB,IAAM4T,EAAY3R,KAAKnB,MAAM6O,YAAYC,IAAI7K,MAAM,KAEnD,GAAkB,QADA6O,EAAU,GACH,CACvB,IAAMC,EAAUD,EAAU,GACLpU,EAAiBqU,IAGpC5R,KAAKpB,SAASoB,KAAKoP,MAAQ7R,EAAiBqU,GAAS,IAIzD,IAAMlC,EAAQ,IACRmC,EAASnC,GAAgBgC,EAC3BI,EAAK9R,KAAK6Q,eAAe,GAAK7Q,KAAKlC,EACnCiU,EAAK/R,KAAK6Q,eAAe,GAAK7Q,KAAKjC,EAGnCyE,KAAKwP,IAAIF,GAAMD,IACjB7R,KAAKlC,EAAIkC,KAAK6Q,eAAe,GAC7B7Q,KAAKvB,gBAAgBX,EAAIkC,KAAK6Q,eAAe,GAC7CiB,EAAK,GAEHtP,KAAKwP,IAAID,GAAMF,IACjB7R,KAAKjC,EAAIiC,KAAK6Q,eAAe,GAC7B7Q,KAAKvB,gBAAgBV,EAAIiC,KAAK6Q,eAAe,GAAK,GAClDkB,EAAK,GAIP,IAAIpC,EAAK,EACLC,EAAK,EAgBT,GAfIkC,EAAK,EAAGnC,GAAMD,EACToC,EAAK,IAAGnC,GAAMD,GACnBqC,EAAK,EAAGnC,GAAMF,EACTqC,EAAK,IAAGnC,GAAMF,GAGvB1P,KAAKiP,YAAYU,EAAIC,GACrB5P,KAAKN,KAAKoQ,SAASC,UAAUL,GAE7B1P,KAAKoN,kBAAkB6B,YAAYU,EAAIC,GACvC5P,KAAKoN,kBAAkB0C,SAASC,UAAUL,GAI1C1P,KAAK+Q,sBAAwBW,EAE3B1R,KAAKgR,YACJhR,KAAKN,KAAKuS,UACXjS,KAAKN,KAAKwS,SAASC,MACnBnS,KAAK+Q,sBAAwB,IAC7B,CACA,GAAI/Q,KAAKlC,EAAI,KAAOkC,KAAKjC,EAAI,KAAOiC,KAAKiR,SAAUnT,EAAI,KAAOkC,KAAKiR,SAAUlT,EAAI,IAAK,OACtF8D,EAAa0L,KAAKjQ,EAAM8U,oBAAqBpS,KAAK9B,UAClD8B,KAAK+Q,qBAAuB,EAC5B/Q,KAAKgR,WAAY,O,GA/JkBpT,GAmLzC6D,IAAO2O,YAAYC,kBAAkBC,SACnC,eACA,SAEExS,EACAC,EACAC,EACAZ,EACAwF,EACA3E,GAEA,IAAMsS,EAAS,IAAIK,GAAY5Q,KAAKnC,MAAOC,EAAGC,EAAGC,EAASZ,EAAIwF,EAAM3E,GAEpE+B,KAAKwQ,YAAYzR,IAAIwR,GACrBvQ,KAAKyQ,WAAW1R,IAAIwR,GAEpBvQ,KAAKnC,MAAMyB,QAAQC,MAAMmR,WAAWH,EAAQ9O,IAAOC,QAAQC,OAAOgP,cAElE,IAAMlR,EAAiB,CAAC,EAAG,GAQ3B,OAPA8Q,EAAO7Q,KACJC,QAAQ4Q,EAAO3Q,MAAQH,EAAe,GAAI8Q,EAAO1Q,OAASJ,EAAe,IACzEK,UACCyQ,EAAO3Q,OAAS,EAAIH,EAAe,IAAM,GACzC8Q,EAAO1Q,QAAU,EAAIJ,EAAe,IAAM,GAAM,IAG7C8Q,K,ICpNC8B,G,SCKSC,G,kDAGnB,WAAYzU,EAAqBC,EAAWC,EAAW6B,EAAeC,GAAiB,IAAD,8BACpF,cAAMhC,EAAOC,EAAGC,EAAG6B,EAAOC,IAH5BoO,kBAEsF,EAGpFpQ,EAAMyB,QAAQP,IAAIwT,SAAlB,iBAHoF,E,0CAMtF,SAAOC,EAAkB3E,GAAkD,IAAD,QACxE,GAAKA,GAKD2E,EAAOpU,iBAAmBf,EAAeoS,QAA7C,CAKA,IAAQ3R,EAAS0U,EAAT1U,EAAGC,EAAMyU,EAANzU,GACX,UAAI8P,EAAQnQ,YAAZ,aAAI,EAAcmS,QAChB7P,KAAKmP,YAAYrR,EAAI,GAAIC,IACpB,UAAI8P,EAAQlQ,aAAZ,aAAI,EAAekS,QACxB7P,KAAKmP,YAAYrR,EAAI,GAAIC,IACpB,UAAI8P,EAAQrQ,UAAZ,aAAI,EAAYqS,QACrB7P,KAAKmP,YAAYrR,EAAGC,EAAI,KACnB,UAAI8P,EAAQpQ,YAAZ,aAAI,EAAcoS,SACvB7P,KAAKmP,YAAYrR,EAAGC,EAAI,IAKtBiC,KAAKiO,eACFjO,KAAKnC,MAAMyB,QAAQmT,QAAQzS,KAAMA,KAAKiO,gBACzCjO,KAAKiO,aAAasB,iBAClBvP,KAAKiO,kBAAelG,S,GApCgBtG,IAAO2O,YAAYsC,MCkB1CC,G,kDAanB,aAAe,IAAD,8BACZ,cAAM,SAbR3K,aAYc,IAXN6F,aAWM,IAVNC,UAUM,IATNC,UASM,IARN6E,SAQM,IAPd3B,cAOc,IANNrD,oBAMM,IALNiF,kBAKM,IAJNC,eAAiB,IAAIjP,IAIf,EAHduD,YAAc,IAAIvD,IAGJ,EAFNkP,cAAgB,IAAIlP,IAEd,E,gDAId,WACE7D,KAAK6N,QAAU7N,KAAKgT,MAAMC,SAASC,mBAEnClT,KAAK8N,KAAO9N,KAAKgT,MAAMC,SAASE,OAAO,KACvCnT,KAAK+N,KAAO/N,KAAKgT,MAAMC,SAASE,OAAO,KACvCnT,KAAKgT,MAAMC,SAASG,uBACpBpT,KAAKgT,MAAMC,SAAS3N,GAAG,iBAAiB,SAAC+N,GACvCtN,GAAMC,SAASgF,IAAY,IAC3BjF,GAAMC,SAAS+E,IAAW,OAE5B/K,KAAKgT,MAAMC,SAAS3N,GAAG,eAAe,SAAC+N,GACrCtN,GAAMC,SAASgF,IAAY,S,yBAI/B,WACEhL,KAAKgT,MAAMC,SAASK,SAAU,I,wBAGhC,WACEtT,KAAKgT,MAAMC,SAASK,SAAU,I,oBAGhC,SAAOC,GACL,IAAKA,EAAKvL,QACR,MAAM,IAAIlL,MAAM,2BAEhBkD,KAAKgI,QAAUuL,EAAKvL,QCjEU,SAACnJ,GACnC,IAAM2U,EAAiB,GAEvB3U,EAAM4U,OAAO,CACX9F,IAAK,mBACL+F,OAAQ7U,EAAM8U,mBAAmB,QAAS,CACxCC,MAAO,EACPC,IAAK,IAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,gBACL+F,OAAQ7U,EAAM8U,mBAAmB,QAAS,CACxCC,MAAO,EACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,kBACL+F,OAAQ7U,EAAM8U,mBAAmB,QAAS,CACxCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,kBACL+F,OAAQ7U,EAAM8U,mBAAmB,QAAS,CACxCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,kBACL+F,OAAQ7U,EAAM8U,mBAAmB,QAAS,CACxCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,eACL+F,OAAQ7U,EAAM8U,mBAAmB,QAAS,CACxCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,iBACL+F,OAAQ7U,EAAM8U,mBAAmB,QAAS,CACxCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,iBACL+F,OAAQ7U,EAAM8U,mBAAmB,QAAS,CACxCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,iBACL+F,OAAQ7U,EAAM8U,mBAAmB,QAAS,CACxCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,iBACL+F,OAAQ7U,EAAM8U,mBAAmB,QAAS,CACxCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,kBACL+F,OAAQ7U,EAAM8U,mBAAmB,QAAS,CACxCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,eACL+F,OAAQ7U,EAAM8U,mBAAmB,QAAS,CACxCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,kBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,EACPC,IAAK,IAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,eACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,EACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,iBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,iBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,iBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,cACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,gBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,gBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,gBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,gBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,iBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,cACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,iBACL+F,OAAQ7U,EAAM8U,mBAAmB,MAAO,CACtCC,MAAO,EACPC,IAAK,IAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,cACL+F,OAAQ7U,EAAM8U,mBAAmB,MAAO,CACtCC,MAAO,EACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,gBACL+F,OAAQ7U,EAAM8U,mBAAmB,MAAO,CACtCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,gBACL+F,OAAQ7U,EAAM8U,mBAAmB,MAAO,CACtCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,gBACL+F,OAAQ7U,EAAM8U,mBAAmB,MAAO,CACtCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,aACL+F,OAAQ7U,EAAM8U,mBAAmB,MAAO,CACtCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,eACL+F,OAAQ7U,EAAM8U,mBAAmB,MAAO,CACtCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,eACL+F,OAAQ7U,EAAM8U,mBAAmB,MAAO,CACtCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,eACL+F,OAAQ7U,EAAM8U,mBAAmB,MAAO,CACtCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,eACL+F,OAAQ7U,EAAM8U,mBAAmB,MAAO,CACtCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,gBACL+F,OAAQ7U,EAAM8U,mBAAmB,MAAO,CACtCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,aACL+F,OAAQ7U,EAAM8U,mBAAmB,MAAO,CACtCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,kBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,EACPC,IAAK,IAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,eACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,EACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,iBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,iBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,iBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,cACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,gBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,gBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,QAAS,EACTC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,gBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,gBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,iBACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,IAGb3U,EAAM4U,OAAO,CACX9F,IAAK,cACL+F,OAAQ7U,EAAM8U,mBAAmB,OAAQ,CACvCC,MAAO,GACPC,IAAK,KAEPC,OAAQ,EACRC,UAAWP,ID5ZXQ,CAAqBhU,KAAKnB,OAE1BmB,KAAK4S,IAAM5S,KAAKiU,KAAKC,QAAQ,CAAEvG,IAAK,YACpC,IAAMwG,EAAiBnU,KAAK4S,IAAIwB,gBAAgB,iBAAkB,cAE5DC,EAAcrU,KAAK4S,IAAI0B,YAAY,SAAUH,GACnDE,EAAYE,uBAAuB,CAAEC,UAAU,IAI/CxU,KAAKiR,SAAWjR,KAAKjB,IAAIkS,SAAS,IAAK,IAAK,OAAQjR,KAAKgI,QAAQyM,aACjEzU,KAAK4N,eAAiB,IAAI0E,GAAetS,KAAM,EAAG,EAAG,GAAI,IAqDzDA,KAAK6S,aAAe7S,KAAKV,QAAQP,IAAI2V,MAAM,CAAEC,UAAW/D,KAExD5Q,KAAK4U,QAAQC,KAAKC,KAAO,IACzB9U,KAAK4U,QAAQC,KAAKE,YAAY/U,KAAKiR,UAAU,GAE7CjR,KAAKV,QAAQP,IAAIiW,SAAS,CAAChV,KAAKiR,SAAUjR,KAAKiR,SAASxS,iBAAkB4V,GAG1ErU,KAAKV,QAAQP,IAAI0T,QACfzS,KAAK4N,eAEL,GACA5N,KAAKiV,+BACLlN,EACA/H,MAGFA,KAAKV,QAAQP,IAAI0T,QACfzS,KAAKiR,SACLjR,KAAK6S,aACL7S,KAAKkV,0BACLnN,EACA/H,MAIFA,KAAKgI,QAAQmN,eAAenV,KAAKoV,mBAAoBpV,MACrDA,KAAKgI,QAAQqN,aAAarV,KAAKsV,iBAAkBtV,MACjDA,KAAKgI,QAAQuN,gBAAgBvV,KAAKwV,oBAAqBxV,MACvDA,KAAKgI,QAAQyN,yBAAyBzV,KAAK0V,uBAAwB1V,MACnEA,KAAKgI,QAAQ2N,gBAAgB3V,KAAK4V,oBAAqB5V,MACvDA,KAAKgI,QAAQ6N,gBAAgB7V,KAAK8V,oBAAqB9V,MACvDA,KAAKgI,QAAQ+N,kBAAkB/V,KAAKgW,sBAAuBhW,MAC3DA,KAAKgI,QAAQiO,mBAAmBjW,KAAKkW,uBAAwBlW,Q,uCAG/D,SAAkC4N,EAAgBuI,GAChD,IAAMC,EAAcxI,EAAeK,aAEnC,GAAImI,EAAa,CAEf,GAAIA,IAAgBD,GAAiBC,EAAYhH,OAAS+G,EAAc/G,MACtE,OAGEpP,KAAKiR,SAAS7S,iBAAmBf,EAAeoS,SAAS2G,EAAY7G,iBAI3E3B,EAAeK,aAAekI,EAC9BA,EAAcE,oB,gCAGhB,SACE3B,EACA4B,EACA3I,EACA4I,GAEA,IAAMC,EAAUF,EAAOxY,EAAqB,GAAhBwY,EAAO1W,MAC7B6W,EAAUH,EAAOvY,EAAsB,GAAjBuY,EAAOzW,OAInC,OAHY6U,EACTrN,IAAImP,EAASC,EAAS9I,EAAK2I,EAAOI,IAAO1W,KAAK4S,IAAI+D,WAAWJ,GAAaK,UAC1EhY,SAAS6X,K,+BAId,SACEI,EACAlJ,EACA4I,EACAO,GACC,IAAD,OACMpC,EAAQ1U,KAAKV,QAAQP,IAAIgY,cACX/W,KAAK4S,IAAIoE,eAAeH,GAChCI,QAAQpP,SAAQ,SAACyO,GAC3B,IAAME,EAAUF,EAAOxY,EAAqB,GAAhBwY,EAAO1W,MAC7B6W,EAAUH,EAAOvY,EAAsB,GAAjBuY,EAAOzW,OACnC6U,EACGrN,IAAImP,EAASC,EAAS9I,EAAK2I,EAAOI,IAAO,EAAK9D,IAAI+D,WAAWJ,GAAaK,UAC1EhY,SAAS6X,MAEVzW,KAAKiR,UAAY6F,GACnB9W,KAAKV,QAAQP,IAAIiW,SAAS,CAAChV,KAAKiR,SAAUjR,KAAKiR,SAASxS,iBAAkBiW,K,gCAI9E,SAA2BwC,EAAoB9Z,GAC7C,IAAM+Z,EAAcnX,KAAKjB,IAAIoY,YAAYD,EAAUpZ,EAAGoZ,EAAUnZ,EAAG,OAAQX,EAAI8Z,EAAUtU,MACzF5C,KAAK6S,aAAa9T,IAAIoY,GACtBnX,KAAK8S,eAAenO,IAAIvH,EAAI+Z,K,8BAI9B,SAAyB/Z,GACvB,GAAI4C,KAAK8S,eAAesE,IAAIha,GAAK,CAC/B,IAAM+Z,EAAcnX,KAAK8S,eAAezL,IAAIjK,GAC5C,IAAK+Z,EAAa,OAClBnX,KAAK6S,aAAawE,OAAOF,GAAa,GAAM,GAC5CnX,KAAK8S,eAAejO,OAAOzH,M,iCAI/B,WACE4C,KAAKiR,SAAS3S,gBAAiB,I,oCAGjC,WACE0B,KAAKiR,SAAS1S,gBAAiB,I,iCAIjC,SAA4B8S,EAAeC,EAAwBlU,GACjE,IAAM+Z,EAAcnX,KAAK8S,eAAezL,IAAIjK,GACjC,OAAX+Z,QAAW,IAAXA,KAAaG,kBAAkBjG,EAAOC,K,kCAGxC,SAA6BL,EAAUkG,GAAc,IAAD,EAClDA,EAAYI,SAAStG,EAArB,UAA+BjR,KAAKgI,eAApC,aAA+B,EAAckJ,U,iCAG/C,SAA4BhT,EAAkBsZ,EAAgBnJ,GAC5D,GAAIA,IAAahC,GAASiC,SAAU,CAClC,IAAM/G,EAAWvH,KAAKoH,YAAYC,IAAImQ,GAC9B,OAARjQ,QAAQ,IAARA,KAAUkQ,eAAevZ,QACpB,GAAImQ,IAAahC,GAASmC,WAAY,CAC3C,IAAM7B,EAAa3M,KAAK+S,cAAc1L,IAAImQ,GAChC,OAAV7K,QAAU,IAAVA,KAAY8K,eAAevZ,M,mCAI/B,SAA8BA,EAAkBsZ,EAAgBnJ,GAC9D,GAAIA,IAAahC,GAASiC,SAAU,CAClC,IAAM/G,EAAWvH,KAAKoH,YAAYC,IAAImQ,GAC9B,OAARjQ,QAAQ,IAARA,KAAUmQ,kBAAkBxZ,QACvB,GAAImQ,IAAahC,GAASmC,WAAY,CAC3C,IAAM7B,EAAa3M,KAAK+S,cAAc1L,IAAImQ,GAChC,OAAV7K,QAAU,IAAVA,KAAY+K,kBAAkBxZ,M,oCAIlC,SAA+BA,EAAkB6B,GAC/C,IAAMoX,EAAcnX,KAAK8S,eAAezL,IAAInJ,GACjC,OAAXiZ,QAAW,IAAXA,KAAaQ,mBAAmB5X,K,oBAGlC,SAAO0R,EAAWC,GACZ1R,KAAKiR,UAAYjR,KAAKgI,UACxBhI,KAAK4N,eAAeuC,OAAOnQ,KAAKiR,SAAUjR,KAAK6N,SAC/C7N,KAAKiR,SAASd,OAAOnQ,KAAK4N,eAAgB5N,KAAK6N,QAAS7N,KAAK8N,KAAM9N,KAAK+N,KAAM/N,KAAKgI,c,GApQvDvG,IAAOmW,OEpBpBC,G,kDAKnB,aAAe,IAAD,8BACZ,cAAM,eALAC,WAIM,IAHNC,cAGM,IAFNC,iBAEM,I,0CAId,SAAOzE,GACL,IAAM0E,EAAcjY,KAAK4U,QAAQC,KAAKhV,OAChCqY,EAAalY,KAAK4U,QAAQC,KAAKjV,MAGjC2T,EAAKpQ,iBAAmBf,EAAemB,KACzCvD,KAAKgY,YAAc,eACnBhY,KAAK+X,SAAW,YAChB/X,KAAK4U,QAAQC,KAAKsD,mBAAmB,aAErCnY,KAAKgY,YAAc,iBACnBhY,KAAK+X,SAAW,cAChB/X,KAAK4U,QAAQC,KAAKsD,mBAAmB,YAIvC,IAAMC,EAAgBpY,KAAKjB,IAAIsZ,MAAMH,EAAa,EAAGD,EAAc,EAAGjY,KAAKgY,aACrEM,EAAQ9V,KAAK+V,IAAIL,EAAaE,EAAcxY,MAAOqY,EAAcG,EAAcvY,QACrFuY,EAAcI,SAASF,GAAOG,gBAAgB,GAG9C,IAAMC,EAAe1Y,KAAKjB,IAAIsZ,MAAMH,EAAa,EAAGD,EAAc,EAAG,YAC/DU,EAASnW,KAAK+V,IAAIL,EAAaQ,EAAa9Y,MAAOqY,EAAcS,EAAa7Y,QACpF6Y,EAAaF,SAASG,GAAQF,gBAAgB,GAG9C,IAAM/E,EAAS1T,KAAK4Y,SAASvR,IAAIrH,KAAK+X,UAAUc,gBAChD7Y,KAAK8X,MAAQ9X,KAAKV,QAAQP,IAAI2V,QAC9B,IAAK,IAAIoE,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAC3B,IAAMhb,EAAI2D,IAAOe,KAAKuW,IAAIC,QAAsB,IAAbd,EAA+B,IAAbA,GAC/Cna,EAAI0D,IAAOe,KAAKuW,IAAIC,QAAsB,GAAdf,EAAiC,GAAdA,GAC/CnI,EAAWrO,IAAOe,KAAKuW,IAAIC,QAAQ,GAAI,IAE7ChZ,KAAK8X,MACFzQ,IAAIvJ,EAAGC,EAAGiC,KAAK+X,SAAUrE,EAAOoF,EAAI,IACpCN,SAAS,GACTvJ,YAAYa,EAAU,M,oBAI7B,SAAO2B,EAAWC,GAChB1R,KAAKV,QAAQC,MAAM0Z,KAAKjZ,KAAK8X,MAAO,S,GAlDArW,IAAOmW,O,0DJHnCvF,O,iCAAAA,I,2CAAAA,I,uCAAAA,I,yCAAAA,I,6CAAAA,I,uDAAAA,I,yCAAAA,I,iDAAAA,I,2DAAAA,I,qCAAAA,I,wCAAAA,I,qCAAAA,Q,SKKS6G,G,WAUnB,WAAYlU,EAAgBgD,GAAmB,yBATvC/C,YASsC,OARtCkU,MAAQ,IAAItV,IAQ0B,KAPtCuV,cAAgB,IAAIvV,IAOkB,KANtCwV,UAAYC,SAASC,cAAc,eAMG,KALtCC,WAAaF,SAASC,cAAc,gBAKE,KAJtCE,QAAUH,SAASI,cAAc,SAIK,KAHtCxU,cAGsC,OAFtC8C,aAEsC,EAC5C,IAAM2R,EAAc3Z,KAAK4Z,iBAAiB5U,GAC1ChF,KAAKiF,OAAS,IAAII,IAAKsU,GACvB3Z,KAAKgI,QAAUA,EACfxC,QAAQC,IAAI,UAAWT,GACvBQ,QAAQC,IAAI,eAAgBkU,GAC5B3Z,KAAKiF,OAAOK,GAAG,SAAS,SAACC,GACvBC,QAAQC,IAAIF,EAAIG,MAChBF,QAAQG,MAAMJ,MAIhBvF,KAAKyZ,QAAQI,OAAQ,EAGrB7Z,KAAK8Z,a,oDAKP,SAAyB9U,GACvB,OAAOA,EAAO7C,QAAQ,cAAe,O,wBAGvC,WAAc,IAAD,OACXnC,KAAKiF,OAAOK,GAAG,QAAQ,SAACM,GACtB,IAAK,EAAKwT,cAAchC,IAAIxR,EAAKM,MAAO,CACtCN,EAAKC,OAAO,EAAKX,UACjB,IAAMyB,EAAQ2S,SAASI,cAAc,SACrC,EAAKN,cAAczU,IAAIiB,EAAKM,KAAM,CAAEN,OAAMe,UAE1Cf,EAAKN,GAAG,UAAU,SAACQ,GACjB,EAAKG,eAAeU,EAAOb,Y,qCAQnC,WAA2B,IAAD,SAExB,UAAAU,UAAUuT,mBAAV,SAAuBC,MAAM,CAAEpX,KADR,eACgCiE,MAAK,SAACoT,GACtC,YAAjBA,EAAOjW,OAAqB,EAAKkW,cAAa,Q,0BAItD,WAAmC,IAAD,SAArBC,IAAqB,yDAEhC,UAAA3T,UAAUC,oBAAV,SACIyT,aAAa,CACbvT,OAAO,EACPC,OAAO,IAERC,MAAK,SAACV,GACL,EAAKjB,SAAWiB,EAChB,EAAKF,eAAe,EAAKwT,QAAS,EAAKvU,UACvC,EAAKkV,eACLrU,GAAMC,SAASxB,GAAkB,IACjC,EAAKwD,QAAQzJ,oBAEd8b,OAAM,SAAC1U,GACFwU,GAAc9Y,OAAOiZ,MAAM,gE,8BAKrC,SAAiBtV,GAAiB,IAAD,OAC/B,GAAIhF,KAAKkF,SAAU,CACjB,IAAMyU,EAAc3Z,KAAK4Z,iBAAiB5U,GAC1C,IAAKhF,KAAKmZ,MAAM/B,IAAIuC,GAAc,CAChCnU,QAAQC,IAAI,UAAWkU,GACvB,IAAM/T,EAAO5F,KAAKiF,OAAOW,KAAK+T,EAAa3Z,KAAKkF,UAC1CyB,EAAQ2S,SAASI,cAAc,SACrC1Z,KAAKmZ,MAAMxU,IAAIgV,EAAa,CAAE/T,OAAMe,UAEpCf,EAAKN,GAAG,UAAU,SAACQ,GACjB,EAAKG,eAAeU,EAAOb,U,4BASnC,SAAea,EAAyBR,GACtCQ,EAAM4T,UAAYpU,EAClBQ,EAAM6T,iBAAiB,kBAAkB,WACvC7T,EAAM7H,UAEJkB,KAAKqZ,WAAWrZ,KAAKqZ,UAAUoB,OAAO9T,K,+BAI5C,SAAkB3B,GAChB,IAAM2U,EAAc3Z,KAAK4Z,iBAAiB5U,GAC1C,GAAIhF,KAAKmZ,MAAM/B,IAAIuC,GAAc,CAC/B,IAAMzT,EAAOlG,KAAKmZ,MAAM9R,IAAIsS,GACxB,OAAJzT,QAAI,IAAJA,KAAMN,KAAKmD,QACP,OAAJ7C,QAAI,IAAJA,KAAMS,MAAM0Q,SACZrX,KAAKmZ,MAAMtU,OAAO8U,M,uCAKtB,SAA0B3U,GACxB,IAAM2U,EAAc3Z,KAAK4Z,iBAAiB5U,GAC1C,GAAIhF,KAAKoZ,cAAchC,IAAIuC,GAAc,CACvC,IAAMe,EAAe1a,KAAKoZ,cAAc/R,IAAIsS,GAChC,OAAZe,QAAY,IAAZA,KAAc9U,KAAKmD,QACP,OAAZ2R,QAAY,IAAZA,KAAc/T,MAAM0Q,SACpBrX,KAAKoZ,cAAcvU,OAAO8U,M,0BAK9B,WAAgB,IAAD,WACPgB,EAAcrB,SAASI,cAAc,UAC3CiB,EAAYra,UAAY,OACxBqa,EAAYH,iBAAiB,SAAS,WACpC,GAAI,EAAKtV,SAAU,CACjB,IAAM0V,EAAa,EAAK1V,SAAS2V,iBAAiB,GAC9CD,EAAWtH,SACbsH,EAAWtH,SAAU,EACrBqH,EAAYra,UAAY,WAExBsa,EAAWtH,SAAU,EACrBqH,EAAYra,UAAY,YAI9B,IAAMwa,EAAcxB,SAASI,cAAc,UAC3CoB,EAAYxa,UAAY,YACxBwa,EAAYN,iBAAiB,SAAS,WACpC,GAAI,EAAKtV,SAAU,CACjB,IAAM0V,EAAa,EAAK1V,SAAS6B,iBAAiB,GAC9C6T,EAAWtH,SACbsH,EAAWtH,SAAU,EACrBwH,EAAYxa,UAAY,aAExBsa,EAAWtH,SAAU,EACrBwH,EAAYxa,UAAY,iBAI9B,UAAAN,KAAKwZ,kBAAL,SAAiBiB,OAAOE,GACxB,UAAA3a,KAAKwZ,kBAAL,SAAiBiB,OAAOK,O,KC3IPC,G,WAQnB,aAAe,yBAPPC,YAOM,OANN9P,UAMM,OALN+P,WAKM,OAJd/J,YAIc,OAFduD,iBAEc,EACKpT,OAAO6Z,SAASC,SAAShZ,QAAQ,OAAQ,MAK1DnC,KAAKgb,OAAS,IAAII,UAHhB,wCAIFpb,KAAKqb,gBAAgBxU,MAAK,WACxBd,GAAMC,SAAS0F,IAAe,OAGhC7J,EAAayD,GAAGhI,EAAMkQ,sBAAuBxN,KAAKsb,iBAAkBtb,MACpE6B,EAAayD,GAAGhI,EAAMmQ,yBAA0BzN,KAAKqP,aAAcrP,MACnE6B,EAAayD,GAAGhI,EAAM8U,oBAAqBpS,KAAKub,uBAAwBvb,M,0FAO1E,uBAAAwb,EAAA,sEACqBxb,KAAKgb,OAAOS,aAAa5R,EAAS6R,OADvD,OACE1b,KAAKib,MADP,OAGEjb,KAAKib,MAAMU,UAAU,SAAS,SAACC,GAC7B7V,GAAMC,SAAS8F,GAAkB8P,OAGnC5b,KAAKib,MAAMU,UAAU,KAAK,YAAqB,IAAD,oBAAlB/R,EAAkB,KAAVsB,EAAU,KAC5CnF,GAAMC,SAASgG,GAAkB,CAAEpC,SAAQsB,aAG7ClL,KAAKib,MAAMU,UAAU,KAAK,SAAC/R,GACzB7D,GAAMC,SAASmG,GAAqBvC,OAZxC,gD,+HAiBA,uBAAA4R,EAAA,sEACoBxb,KAAKgb,OAAOS,aAAa5R,EAASgS,QADtD,OACE7b,KAAKkL,KADP,OAEElL,KAAK8Z,aAFP,gD,2HAMA,WAAqBlQ,EAAgBkS,GAArC,UAAAN,EAAA,sEACoBxb,KAAKgb,OAAOe,SAASnS,EAAQ,CAAEkS,aADnD,OACE9b,KAAKkL,KADP,OAEElL,KAAK8Z,aAFP,gD,4HAMA,WAAmBkC,GAAnB,sBAAAR,EAAA,6DACU5Y,EAA6CoZ,EAA7CpZ,KAAMiJ,EAAuCmQ,EAAvCnQ,YAAaiQ,EAA0BE,EAA1BF,SAAUG,EAAgBD,EAAhBC,YADvC,SAEoBjc,KAAKgb,OAAOvH,OAAO5J,EAASsB,OAAQ,CACpDvI,OACAiJ,cACAiQ,WACAG,gBANJ,OAEEjc,KAAKkL,KAFP,OAQElL,KAAK8Z,aARP,gD,+EAYA,WAAc,IAAD,OACN9Z,KAAKkL,OAEVlL,KAAKib,MAAMiB,QACXlc,KAAKyU,YAAczU,KAAKkL,KAAKxH,UAC7BqC,GAAMC,SAAS3B,EAAarE,KAAKkL,KAAKxH,YACtC1D,KAAKkR,OAAS,IAAIgI,GAAOlZ,KAAKyU,YAAazU,MAG3CA,KAAKkL,KAAKlH,MAAMmY,QAAQC,MAAQ,SAAC5J,EAAiB7E,GAC5CA,IAAQ,EAAK8G,cAGjBjC,EAAO6J,SAAW,SAACC,GACjBA,EAAQzU,SAAQ,SAAC0U,GACf,IAAQlL,EAAiBkL,EAAjBlL,MAAOC,EAAUiL,EAAVjL,MACfzP,EAAa0L,KAAKjQ,EAAMkf,eAAgBnL,EAAOC,EAAO3D,GAGxC,SAAV0D,GAA8B,KAAVC,IACtBzP,EAAa0L,KAAKjQ,EAAMmN,cAAe+H,EAAQ7E,GAC/C5H,GAAMC,SAAStB,EAAiB,CAAEtH,GAAIuQ,EAAK/K,KAAM0O,KACjDvL,GAAMC,SAASwE,GAAwB8G,WAO/CtR,KAAKkL,KAAKlH,MAAMmY,QAAQM,SAAW,SAACjK,EAAiB7E,GAAiB,IAAD,IACnE9L,EAAa0L,KAAKjQ,EAAMwN,YAAa6C,GACrC,YAAKuD,cAAL,SAAawL,kBAAkB/O,GAC/B,YAAKuD,cAAL,SAAayL,0BAA0BhP,GACvC5H,GAAMC,SAAS6E,GAAsB2H,EAAO5P,OAC5CmD,GAAMC,SAASpB,EAAoB+I,KAIrC3N,KAAKkL,KAAKlH,MAAM4Y,UAAUR,MAAQ,SAAC7U,EAAqBoG,GAEtDpG,EAASsV,cAAcT,MAAQ,SAACpO,EAAM8O,GACpCjb,EAAa0L,KAAKjQ,EAAMyf,gBAAiB/O,EAAML,EAAKtB,GAASiC,WAE/D/G,EAASsV,cAAcJ,SAAW,SAACzO,EAAM8O,GACvCjb,EAAa0L,KAAKjQ,EAAM0f,kBAAmBhP,EAAML,EAAKtB,GAASiC,YAKnEtO,KAAKkL,KAAKlH,MAAMiZ,YAAYb,MAAQ,SAACzP,EAAyBgB,GAC5D5H,GAAMC,SACJ2D,EAAkB,CAChBR,aAAcwE,EACd/D,OAAQ+C,EAAW/C,UAIvB+C,EAAWkQ,cAAcT,MAAQ,SAACpO,EAAM8O,GACtCjb,EAAa0L,KAAKjQ,EAAMyf,gBAAiB/O,EAAML,EAAKtB,GAASmC,aAE/D7B,EAAWkQ,cAAcJ,SAAW,SAACzO,EAAM8O,GACzCjb,EAAa0L,KAAKjQ,EAAM0f,kBAAmBhP,EAAML,EAAKtB,GAASmC,cAKnExO,KAAKkL,KAAKlH,MAAM+F,aAAaqS,MAAQ,SAACpO,EAAM8O,GAC1C/W,GAAMC,SAASmE,GAAgB6D,KAIjChO,KAAKkL,KAAKyQ,UAAUtJ,GAAQ6K,gBAAgB,SAACnd,GAC3CgG,GAAMC,SAAS4F,GAAkB7L,OAInCC,KAAKkL,KAAKyQ,UAAUtJ,GAAQ8K,kBAAkB,YAA4B,IAAzBC,EAAwB,EAAxBA,SAAUrd,EAAc,EAAdA,QACzD8B,EAAa0L,KAAKjQ,EAAM+f,qBAAsBD,EAAUrd,MAI1DC,KAAKkL,KAAKyQ,UAAUtJ,GAAQiL,mBAAmB,SAACF,GAAsB,IAAD,EACnE,YAAKlM,cAAL,SAAayL,0BAA0BS,MAIzCpd,KAAKkL,KAAKyQ,UAAUtJ,GAAQkL,mBAAmB,SAACH,GAAsB,IAAD,EAEnE,UADsBrX,GAAMuB,WAAWC,SACzBc,0BAAd,SAAkCmV,WAAWJ,S,gCAKjD,SAAmBpO,EAAuDyO,GACxE5b,EAAayD,GAAGhI,EAAM+f,qBAAsBrO,EAAUyO,K,6BAIxD,SACEzO,EACAyO,GAEA5b,EAAayD,GAAGhI,EAAMyf,gBAAiB/N,EAAUyO,K,+BAInD,SACEzO,EACAyO,GAEA5b,EAAayD,GAAGhI,EAAM0f,kBAAmBhO,EAAUyO,K,4BAIrD,SAAezO,EAAkDyO,GAC/D5b,EAAayD,GAAGhI,EAAMmN,cAAeuE,EAAUyO,K,0BAIjD,SAAazO,EAAiCyO,GAC5C5b,EAAayD,GAAGhI,EAAMwN,YAAakE,EAAUyO,K,6BAI/C,SAAgBzO,EAAiCyO,GAC/C5b,EAAayD,GAAGhI,EAAMogB,gBAAiB1O,EAAUyO,K,sCAInD,SAAyBzO,EAAiCyO,GACxD5b,EAAayD,GAAGhI,EAAMqgB,0BAA2B3O,EAAUyO,K,6BAI7D,SACEzO,EACAyO,GAEA5b,EAAayD,GAAGhI,EAAMkf,eAAgBxN,EAAUyO,K,0BAIlD,SAAaG,EAAkBC,EAAkBnQ,GAAsB,IAAD,EACpE,UAAA1N,KAAKkL,YAAL,SAAW4S,KAAKzL,GAAQ0L,cAAe,CAAEjgB,EAAG8f,EAAU7f,EAAG8f,EAAUG,KAAMtQ,M,8BAI3E,SAAiBuQ,GAAsB,IAAD,EACpC,UAAAje,KAAKkL,YAAL,SAAW4S,KAAKzL,GAAQ6L,mBAAoB,CAAEtb,KAAMqb,M,4BAItD,WAAkB,IAAD,EACf,UAAAje,KAAKkL,YAAL,SAAW4S,KAAKzL,GAAQ8L,kBACxBtc,EAAa0L,KAAKjQ,EAAMogB,mB,4BAI1B,WAAkB,IAAD,EACf,UAAA1d,KAAKkL,YAAL,SAAW4S,KAAKzL,GAAQ+L,iBACxBvc,EAAa0L,KAAKjQ,EAAMqgB,6B,oCAI1B,SAAuBvgB,GAAa,IAAD,IACjC,UAAA4C,KAAKkL,YAAL,SAAW4S,KAAKzL,GAAQiL,kBAAmB,CAAEF,SAAUhgB,IACvD,UAAA4C,KAAKkR,cAAL,SAAawL,kBAAkBtf,K,+BAGjC,SAAkBA,GAAa,IAAD,EAC5B,UAAA4C,KAAKkL,YAAL,SAAW4S,KAAKzL,GAAQgM,oBAAqB,CAAE7W,WAAYpK,M,oCAG7D,SAAuBA,GAAa,IAAD,EACjC,UAAA4C,KAAKkL,YAAL,SAAW4S,KAAKzL,GAAQiM,yBAA0B,CAAE9W,WAAYpK,M,iCAGlE,SAAoBA,GAAa,IAAD,EAC9B,UAAA4C,KAAKkL,YAAL,SAAW4S,KAAKzL,GAAQkM,sBAAuB,CAAEpV,aAAc/L,M,sCAGjE,SAAyBA,GAAa,IAAD,EACnC,UAAA4C,KAAKkL,YAAL,SAAW4S,KAAKzL,GAAQmM,2BAA4B,CAAErV,aAAc/L,M,+BAGtE,SAAkBA,GAAa,IAAD,EAC5B,UAAA4C,KAAKkL,YAAL,SAAW4S,KAAKzL,GAAQkL,kBAAmB,CAAE/V,WAAYpK,M,4BAG3D,SAAe2C,GAAkB,IAAD,EAC9B,UAAAC,KAAKkL,YAAL,SAAW4S,KAAKzL,GAAQ8K,iBAAkB,CAAEpd,QAASA,Q,KCpRpC0e,G,kDAGnB,aAAe,IAAD,8BACZ,cAAM,cAHRzW,aAEc,I,2CAId,WACEhI,KAAK0e,KAAKC,MACR,YACA,kCACA,oCAEF3e,KAAK0e,KAAKrG,MAAM,eAAgB,sCAChCrY,KAAK0e,KAAKC,MACR,cACA,oCACA,sCAEF3e,KAAK0e,KAAKrG,MAAM,iBAAkB,wCAClCrY,KAAK0e,KAAKrG,MAAM,WAAY,kCAE5BrY,KAAK0e,KAAKE,iBAAiB,UAAW,uBACtC5e,KAAK0e,KAAKG,YAAY,aAAc,gCAAiC,CACnEC,WAAY,GACZC,YAAa,KAEf/e,KAAK0e,KAAKG,YAAY,SAAU,yBAA0B,CACxDC,WAAY,GACZC,YAAa,KAEf/e,KAAK0e,KAAKG,YAAY,YAAa,4BAA6B,CAC9DC,WAAY,GACZC,YAAa,KAEf/e,KAAK0e,KAAKG,YAAY,cAAe,8BAA+B,CAClEC,WAAY,GACZC,YAAa,KAEf/e,KAAK0e,KAAKG,YAAY,kBAAmB,kCAAmC,CAC1EC,WAAY,GACZC,YAAa,KAEf/e,KAAK0e,KAAKG,YAAY,SAAU,8CAA+C,CAC7EC,WAAY,GACZC,YAAa,KAEf/e,KAAK0e,KAAKG,YAAY,WAAY,4BAA6B,CAC7DC,WAAY,GACZC,YAAa,KAEf/e,KAAK0e,KAAKG,YAAY,UAAW,2BAA4B,CAC3DC,WAAY,GACZC,YAAa,KAEf/e,KAAK0e,KAAKG,YAAY,OAAQ,4BAA6B,CACzDC,WAAY,GACZC,YAAa,KAEf/e,KAAK0e,KAAKG,YAAY,MAAO,2BAA4B,CACvDC,WAAY,GACZC,YAAa,KAEf/e,KAAK0e,KAAKG,YAAY,OAAQ,4BAA6B,CACzDC,WAAY,GACZC,YAAa,KAEf/e,KAAK0e,KAAKG,YAAY,QAAS,6BAA8B,CAC3DC,WAAY,GACZC,YAAa,O,kBAIjB,WACE/e,KAAKgI,QAAU,IAAI+S,K,oBAGrB,WACE/a,KAAKgf,iBAAiBjZ,GAAMuB,WAAWkF,KAAKrJ,kB,8BAG9C,SAAyBA,M,wBAIzB,WAAc,IAAD,EACX,UAAAnD,KAAKgI,QAAQkJ,cAAb,SAAqB+N,0BACrBjf,KAAKnC,MAAMqhB,OAAO,OAAQ,CACxBlX,QAAShI,KAAKgI,UAIhBjC,GAAMC,SAAS2F,IAAc,M,kCAG/B,SAAqBxI,GACnBnD,KAAKnC,MAAMiK,KAAK,cAChB9H,KAAKgf,iBAAiB7b,O,GAjGa1B,IAAOmW,OCDxCuH,GAAuC,CAC3CzZ,KAAMjE,IAAO2d,KACbC,OAAQ,mBACRC,gBAAiB,UACjBC,UAAU,EACVjH,MAAO,CACLkH,KAAM/d,IAAOge,MAAMC,WAAWC,OAC9B/f,MAAOyB,OAAOue,WACd/f,OAAQwB,OAAOwe,aAEjBvgB,QAAS,CACPwgB,QAAS,SACTC,OAAQ,CACNC,QAAS,CAAEjiB,EAAG,GACdkiB,OAAO,IAGXC,WAAW,EACXriB,MAAO,CAAC4gB,GAAW5G,GAAYlF,KAG3BzO,GAAa,IAAIzC,IAAOkR,KAAKwM,IAEjC9d,OAAe8F,KAAOjD,GAETA,I,uCAAAA,M,UChBAic,GAZEC,aAAY,CAC3BC,QAAS,CACPb,KAAM,OACNc,QAAS,CACPzL,KAAM,WAER0L,UAAW,CACT1L,KAAM,c,kBCJC2L,GAAkDC,I,+QCoBzDC,GAAcC,KAAOC,EAAV,2GAOXC,GAA2BF,aAAOG,KAAPH,CAAH,8FAQxBI,GAAkBJ,aAAOK,KAAPL,CAAH,qcAiCfM,GAAiBN,aAAOO,KAAPP,CAAH,iLAYPQ,GAAkB,WAC7B,MAAgCC,mBAAS,IAAzC,oBAAOtF,EAAP,KAAiBuF,EAAjB,KACA,EAAwCD,mBAAS,IAAjD,oBAAOE,EAAP,KAAqBC,EAArB,KACA,EAAoDH,oBAAS,GAA7D,oBAAOI,EAAP,KAA2BC,EAA3B,KACA,EAAkDL,oBAAS,GAA3D,oBAAOM,EAAP,KAA0BC,EAA1B,KACA,EAAoDP,oBAAS,GAA7D,oBAAOQ,EAAP,KAA2BC,EAA3B,KACMxW,EAAcmV,IAAe,SAACxc,GAAD,OAAWA,EAAMkH,KAAKG,eACnDI,EAAiB+U,IAAe,SAACxc,GAAD,OAAWA,EAAMkH,KAAKO,kBAEtDqW,EAAkB,SAAClY,EAAgBkS,GACvC,GAAKzQ,EAAL,CACA,IAAMlH,EAAYD,GAAWrG,MAAMb,KAAKmH,UACxCA,EAAU6D,QACP+Z,eAAenY,EAAQkS,GACvBjV,MAAK,kBAAM1C,EAAU6d,gBACrB3H,OAAM,SAAC1U,GACNH,QAAQG,MAAMA,GACVmW,GAAU6F,GAAqB,QAYnCM,EAAsB,WAC1BR,GAAsB,GACtBJ,EAAY,IACZQ,GAAsB,GACtBF,GAAqB,IAGvB,OAAiC,IAA1BlW,EAAetL,OACpB,eAACugB,GAAD,kFAEA,uCACE,eAACG,GAAD,CAA0BqB,UAAWC,KAArC,SACE,gBAACC,GAAA,EAAD,WACE,eAACC,GAAA,EAAD,UACE,gBAACrB,GAAA,EAAD,WACE,eAACsB,GAAA,EAAD,IACA,eAACA,GAAA,EAAD,mBACA,eAACA,GAAA,EAAD,0BACA,eAACA,GAAA,EAAD,iBACA,eAACA,GAAA,EAAD,CAAWC,MAAM,SAAjB,SACE,eAAC,KAAD,MAEF,eAACD,GAAA,EAAD,CAAWC,MAAM,eAGrB,eAACC,GAAA,EAAD,UACG/W,EAAemH,KAAI,SAAC1H,GACnB,IAAQtB,EAA8BsB,EAA9BtB,OAAQ6Y,EAAsBvX,EAAtBuX,SAAUC,EAAYxX,EAAZwX,QAClB9f,EAAmC6f,EAAnC7f,KAAMiJ,EAA6B4W,EAA7B5W,YAAa8W,EAAgBF,EAAhBE,YAC3B,OACE,gBAAC5B,GAAD,WACE,eAACuB,GAAA,EAAD,UACE,eAACM,GAAA,EAAD,CAAQC,UAAU,SAASC,MAAO,CAAEC,WAAYzgB,EAAiBM,IAAjE,SACGD,EAAgBC,OAGrB,eAAC0f,GAAA,EAAD,UACE,sBAAKO,UAAU,OAAf,SAAuBjgB,MAEzB,eAAC0f,GAAA,EAAD,UACE,sBAAKO,UAAU,cAAf,SAA8BhX,MAEhC,eAACyW,GAAA,EAAD,UAAY1Y,IACZ,eAAC0Y,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA2BG,IAC3B,eAACJ,GAAA,EAAD,CAAWC,MAAM,SAAjB,SACE,eAACS,GAAA,EAAD,CAASC,MAAON,EAAc,oBAAsB,GAApD,SACE,eAACO,GAAA,EAAD,CACEC,QAAQ,WACRC,MAAM,YACNC,QAAS,WACHV,GACFlB,GAAsB,GACtBF,EAAgB3X,IAEhBkY,EAAgBlY,EAAQ,OAR9B,SAYE,uBAAKiZ,UAAU,eAAf,UACGF,GAAe,eAAC,KAAD,CAAUE,UAAU,cADtC,kBA5BcjZ,aAyChC,eAACqX,GAAD,CAAgBvS,KAAM8S,EAAoBxY,QAASiZ,EAAnD,SACE,wBAAMqB,SAhFiB,SAACjQ,GAC5BA,EAAMkQ,iBACN,IAAMC,EAA+B,KAAb1H,EAEpB0H,IAAoB5B,GAAoBC,GAAuBD,GAC/D4B,GAAiB1B,EAAgBR,EAAcxF,IA2E/C,UACE,gBAAC2H,GAAA,EAAD,CAAeZ,UAAU,iBAAzB,UACE,eAACnC,GAAD,0DACA,eAACgD,GAAA,EAAD,CACExD,WAAS,EACTyD,WAAS,EACThe,MAAOic,EACPgC,WAAYhC,GAAsB,WAClCtQ,MAAOwK,EACP+H,MAAM,WACNne,KAAK,WACLyd,QAAQ,WACRC,MAAM,YACNU,QAAS,SAACjnB,GACRwkB,EAAaxkB,EAAEknB,OAA4BzS,UAG9CoQ,GACC,eAACsC,GAAA,EAAD,CAAOC,SAAS,QAAQd,QAAQ,WAAhC,oCAKJ,gBAACe,GAAA,EAAD,WACE,eAAChB,GAAA,EAAD,CAAQE,MAAM,YAAYC,QAASpB,EAAnC,oBAGA,eAACiB,GAAA,EAAD,CAAQE,MAAM,YAAY1d,KAAK,SAA/B,8B,qECtMNye,GAAwBxD,KAAOyD,KAAV,2GAOdC,GAAiB,WAC5B,MAA4BjD,mBAAoB,CAC9Cxe,KAAM,GACNiJ,YAAa,GACbiQ,SAAU,KACVG,aAAa,IAJf,oBAAOnT,EAAP,KAAewb,EAAf,KAMA,EAAwClD,oBAAS,GAAjD,oBAAOmD,EAAP,KAAqBC,EAArB,KACA,EAA4CpD,oBAAS,GAArD,oBAAOqD,EAAP,KAAuBC,EAAvB,KACA,EAA0DtD,oBAAS,GAAnE,oBAAOuD,EAAP,KAA8BC,EAA9B,KACMvZ,EAAcmV,IAAe,SAACxc,GAAD,OAAWA,EAAMkH,KAAKG,eAEnDwZ,EAAe,SAACC,GAAD,OAA2B,SAACzR,GAC/CiR,EAAU,6BAAKxb,GAAN,mBAAegc,EAAOzR,EAAM0Q,OAAOzS,WAsB9C,OACE,gBAAC6S,GAAD,CAAuBb,SApBJ,SAACjQ,GACpBA,EAAMkQ,iBACN,IAAMwB,EAA8B,KAAhBjc,EAAOlG,KACrBoiB,EAA4C,KAAvBlc,EAAO+C,YAOlC,GALIkZ,IAAgBN,GAAgBC,GAAmBD,GACnDO,IAAuBL,GACzBC,GAA0BD,GAGxBI,GAAeC,GAAsB3Z,EAAa,CACpD,IAAMlH,EAAYD,GAAWrG,MAAMb,KAAKmH,UACxCA,EAAU6D,QACPid,aAAanc,GACbjC,MAAK,kBAAM1C,EAAU6d,gBACrB3H,OAAM,SAAC1U,GAAD,OAAWH,QAAQG,MAAMA,QAKpC,UACE,eAAC+d,GAAA,EAAD,CACEG,MAAM,OACNV,QAAQ,WACRC,MAAM,YACNlD,WAAS,EACTva,MAAO8e,EACPb,WAAYa,GAAkB,mBAC9BpI,SAAUwI,EAAa,UAGzB,eAACnB,GAAA,EAAD,CACEG,MAAM,cACNV,QAAQ,WACRC,MAAM,YACNzd,MAAOgf,EACPf,WAAYe,GAAyB,0BACrCO,WAAS,EACTC,KAAM,EACN9I,SAAUwI,EAAa,iBAGzB,eAACnB,GAAA,EAAD,CACEhe,KAAM6e,EAAe,OAAS,WAC9BV,MAAM,sBACNxH,SAAUwI,EAAa,YACvBzB,MAAM,YACNgC,WAAY,CACVC,aACE,eAACC,GAAA,EAAD,CAAgBC,SAAS,MAAzB,SACE,eAACC,GAAA,EAAD,CACE,aAAW,6BACXnC,QAAS,kBAAMmB,GAAiBD,IAChCkB,KAAK,MAHP,SAKGlB,EAAe,eAAC,KAAD,IAAoB,eAAC,KAAD,WAM9C,eAACrB,GAAA,EAAD,CAAQC,QAAQ,YAAYC,MAAM,YAAY1d,KAAK,SAAnD,wBChFAggB,GAAW/E,KAAOgF,IAAV,yMAWRC,GAAUjF,KAAOgF,IAAV,4IAOPE,GAAoBlF,KAAOgF,IAAV,4MAajBG,GAAoBnF,KAAOgF,IAAV,6EAMjBI,GAAQpF,KAAOqF,GAAV,0FAMLC,GAAUtF,KAAOgF,IAAV,8NAcPO,GAAqBvF,KAAOgF,IAAV,wIAUlBQ,GAAcxF,aAAOyF,KAAPzF,CAAH,gDAIF,SAAS0F,KACtB,MAA4CjF,oBAAS,GAArD,oBAAOkF,EAAP,KAAuBC,EAAvB,KACA,EAAoDnF,oBAAS,GAA7D,oBAAOoF,EAAP,KAA2BC,EAA3B,KACA,EAAwCrF,oBAAS,GAAjD,oBAAOsF,EAAP,KAAqBC,EAArB,KACMtb,EAAcmV,IAAe,SAACxc,GAAD,OAAWA,EAAMkH,KAAKG,eAczD,OACE,uCACE,eAACub,GAAA,EAAD,CACEC,aAAc,CAAEC,SAAU,MAAOC,WAAY,UAC7CrY,KAAMgY,EACNM,iBAAkB,IAClBhe,QAAS,WACP2d,GAAgB,IALpB,SAQE,eAAC3C,GAAA,EAAD,CACEC,SAAS,QACTd,QAAQ,WAERL,MAAO,CAAEC,WAAY,UAAWK,MAAO,WAJzC,8DASF,gBAACsC,GAAD,WACE,eAACE,GAAD,UACGY,EACC,gBAACX,GAAD,WACE,eAACE,GAAD,iCACA,eAACD,GAAD,UACE,eAACN,GAAA,EAAD,CAAYnC,QAAS,kBAAMoD,GAAsB,IAAjD,SACE,eAAC,KAAD,QAGJ,eAAC,GAAD,OAEAH,EACF,gBAACT,GAAD,WACE,gBAACE,GAAD,0BAEE,eAAC/C,GAAA,EAAD,CACEC,MAAM,wDACNgE,UAAU,MAFZ,SAIE,eAACzB,GAAA,EAAD,UACE,eAAC,KAAD,CAAiB3C,UAAU,eAIjC,eAACiD,GAAD,UACE,eAACN,GAAA,EAAD,CAAYnC,QAAS,kBAAMkD,GAAkB,IAA7C,SACE,eAAC,KAAD,QAGJ,eAAC,GAAD,IACA,eAACrD,GAAA,EAAD,CACEC,QAAQ,YACRC,MAAM,YACNC,QAAS,kBAAMoD,GAAsB,IAHvC,gCASF,uCACE,eAACV,GAAD,+BACA,eAACE,GAAD,UAEE,eAAC/C,GAAA,EAAD,CAAQC,QAAQ,YAAYC,MAAM,YAAYC,QA3EtC,WACpB,GAAIhY,EAAa,CACf,IAAMlH,EAAYD,GAAWrG,MAAMb,KAAKmH,UACxCA,EAAU6D,QACPkf,qBACArgB,MAAK,kBAAM1C,EAAU6d,gBACrB3H,OAAM,SAAC1U,GAAD,OAAWH,QAAQG,MAAMA,WAElCghB,GAAgB,IAmEN,uCAgBNtb,GACA,gBAAC6a,GAAD,WACE,2DACA,eAACC,GAAD,CAAa/C,MAAM,uB,6GCrK/B+D,KAAWC,IAAI,CAACC,OAiHhB,IA/GA,I,GAAMzB,GAAUjF,KAAOyD,KAAV,gOAWP2B,GAAQpF,KAAOC,EAAV,6GAOL0G,GAAW3G,KAAOgF,IAAV,8OAeR4B,GAAkB5G,KAAOgF,IAAV,gNAWf6B,GAAW7G,KAAO8G,GAAV,2GAORxB,GAAUtF,KAAOgF,IAAV,oEAKP+B,GAAO/G,KAAOgF,IAAV,0eA6BJgC,GAAQhH,KAAOgF,IAAV,gDAILiC,GAASjH,KAAOgF,IAAV,qGAMNkC,GAAUlH,KAAOgF,IAAV,qIAQPmC,GAAU,CACd,CAAEllB,KAAM,OAAQmlB,ICnIH,0hCDqIb,CAAEnlB,KAAM,OAAQmlB,IErIH,2gCF0INjP,GAAIgP,GAAQ3nB,OAAS,EAAG2Y,GAAI,EAAGA,KAAK,CAC3C,IAAMkP,GAAIxlB,KAAKC,MAAMD,KAAKylB,UAAYnP,GAAI,IADC,GAEf,CAACgP,GAAQE,IAAIF,GAAQhP,KAA/CgP,GAAQhP,IAFiC,MAE7BgP,GAAQE,IAFqB,MAK9B,SAASE,KACtB,MAAwB9G,mBAAiB,IAAzC,oBAAOxe,EAAP,KAAaulB,EAAb,KACA,EAAsC/G,mBAAiB,GAAvD,oBAAOgH,EAAP,KAAoBC,EAApB,KACA,EAA4CjH,oBAAkB,GAA9D,oBAAOqD,EAAP,KAAuBC,EAAvB,KACM1e,EJ/I4BsiB,cIgJ5B/pB,EAAiBiiB,IAAe,SAACxc,GAAD,OAAWA,EAAMwI,KAAKjO,kBACtD+M,EAAakV,IAAe,SAACxc,GAAD,OAAWA,EAAMkH,KAAKI,cAClDC,EAAWiV,IAAe,SAACxc,GAAD,OAAWA,EAAMkH,KAAKK,YAChDC,EAAkBgV,IAAe,SAACxc,GAAD,OAAWA,EAAMkH,KAAKM,mBACvDrE,EAAOjD,GAAWrG,MAAMb,KAAKmK,KAgBnC,OACE,gBAAC,GAAD,CAASmc,SAfU,SAACjQ,GACpBA,EAAMkQ,iBACO,KAAT3gB,EACF8hB,GAAkB,GACTpZ,IACT9F,QAAQC,IAAI,cAAe7C,EAAM,UAAWklB,GAAQM,GAAaxlB,MACjEuE,EAAKohB,eACLphB,EAAK8J,SAASuX,cAAc5lB,GAC5BuE,EAAK8J,SAASwX,iBAAiBX,GAAQM,GAAaxlB,MACpDuE,EAAKa,QAAQ1J,iBACb0H,EAASvB,GAAY,MAKvB,UACE,eAAC,GAAD,sBACA,gBAAC6iB,GAAD,WACE,eAAC1E,GAAA,EAAD,CAAQE,MAAO,CAAEC,WAAYzgB,EAAiBiJ,IAA9C,SACG5I,EAAgB4I,KAEnB,8BAAKA,OAEP,gBAACgc,GAAD,WACE,eAAC,KAAD,IADF,IACsB/b,KAEtB,gBAAC,GAAD,WACE,gBAACkc,GAAD,WACE,eAACF,GAAD,+BACA,eAAC,KAAD,CAEEkB,YAAU,EACVC,aAAc,EACdC,cAAe,EACfC,cAAe,SAACC,GACdT,EAAeS,EAAOC,cAN1B,SASGjB,GAAQlV,KAAI,SAACoW,GAAD,OACX,eAAC,KAAD,UACE,sBAAKC,IAAKD,EAAOjB,IAAKmB,IAAKF,EAAOpmB,QADlBomB,EAAOpmB,cAM/B,gBAAC+kB,GAAD,WACE,eAACjE,GAAA,EAAD,CACExD,WAAS,EACTyD,WAAS,EACTE,MAAM,OACNV,QAAQ,WACRC,MAAM,YACNzd,MAAO8e,EACPb,WAAYa,GAAkB,mBAC9BX,QAAS,SAACjnB,GACRsrB,EAAStrB,EAAEknB,OAA4BzS,UAqB1C/S,GACC,eAACspB,GAAD,UACE,eAAC7D,GAAA,EAAD,CAAOb,QAAQ,WAAf,uCAKR,eAACyE,GAAD,UACE,eAAC1E,GAAA,EAAD,CAAQC,QAAQ,YAAYC,MAAM,YAAY+F,KAAK,QAAQzjB,KAAK,SAAhE,uBGjOR,IAAMggB,GAAW/E,KAAOgF,IAAV,uFAgDCyD,OA1Cf,WACE,IAMIC,EANE1lB,EAAW6c,IAAe,SAACxc,GAAD,OAAWA,EAAMwI,KAAK7I,YAIhD2H,EAAakV,IAAe,SAACxc,GAAD,OAAWA,EAAMkH,KAAKI,cA4BxD,OAjBI+d,EARA1lB,EAUE,+BAOK2H,EAEJ,eAAC4c,GAAD,IAGA,eAAC7B,GAAD,IAIL,eAAC,GAAD,UACGgD,KCxCQC,GAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,8BAAqB3iB,MAAK,YAAkD,IAA/C4iB,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCIdO,IAASC,OACP,eAAC,IAAMC,WAAP,UACE,eAAC,IAAD,CAAUjkB,MAAOA,GAAjB,SACE,eAACkkB,EAAA,EAAD,CAAeC,MAAO/J,GAAtB,SACE,eAAC,GAAD,UAIN7G,SAAS6Q,eAAe,SAM1Bb,O","file":"static/js/main.6cfb853a.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 146;","export enum PlayerBehavior {\n  IDLE,\n  SITTING,\n}\n","import Phaser from 'phaser'\nimport { PlayerBehavior } from '../../../types/PlayerBehavior'\n/**\n * shifting distance for sitting animation\n * format: direction: [xShift, yShift, depthShift]\n */\nexport const sittingShiftData = {\n  up: [0, 3, -10],\n  down: [0, 3, 1],\n  left: [0, -8, 10],\n  right: [0, -8, 10],\n}\n\nexport default class Player extends Phaser.Physics.Arcade.Sprite {\n  playerId: string\n  playerTexture: string\n  playerBehavior = PlayerBehavior.IDLE\n  readyToConnect = false\n  videoConnected = false\n  playerName: Phaser.GameObjects.Text\n  playerContainer: Phaser.GameObjects.Container\n  private playerDialogBubble: Phaser.GameObjects.Container\n  private timeoutID?: number\n\n  constructor(\n    scene: Phaser.Scene,\n    x: number,\n    y: number,\n    texture: string,\n    id: string,\n    frame?: string | number\n  ) {\n    super(scene, x, y, texture, frame)\n\n    this.playerId = id\n    this.playerTexture = texture\n    this.setDepth(this.y)\n\n    this.anims.play(`${this.playerTexture}_idle_down`, true)\n\n    this.playerContainer = this.scene.add.container(this.x, this.y - 30).setDepth(5000)\n\n    // add dialogBubble to playerContainer\n    this.playerDialogBubble = this.scene.add.container(0, 0).setDepth(5000)\n    this.playerContainer.add(this.playerDialogBubble)\n\n    // add playerName to playerContainer\n    this.playerName = this.scene.add\n      .text(0, 0, '')\n      .setFontFamily('Arial')\n      .setFontSize(12)\n      .setColor('#000000')\n      .setOrigin(0.5)\n    this.playerContainer.add(this.playerName)\n\n    this.scene.physics.world.enable(this.playerContainer)\n    const playContainerBody = this.playerContainer.body as Phaser.Physics.Arcade.Body\n    const collisionScale = [0.5, 0.2]\n    playContainerBody\n      .setSize(this.width * collisionScale[0], this.height * collisionScale[1])\n      .setOffset(-8, this.height * (1 - collisionScale[1]) + 6)\n  }\n\n  updateDialogBubble(content: string) {\n    this.clearDialogBubble()\n\n    // preprocessing for dialog bubble text (maximum 70 characters)\n    const dialogBubbleText = content.length <= 70 ? content : content.substring(0, 70).concat('...')\n\n    const innerText = this.scene.add\n      .text(0, 0, dialogBubbleText, { wordWrap: { width: 165, useAdvancedWrap: true } })\n      .setFontFamily('Arial')\n      .setFontSize(12)\n      .setColor('#000000')\n      .setOrigin(0.5)\n\n    // set dialogBox slightly larger than the text in it\n    const innerTextHeight = innerText.height\n    const innerTextWidth = innerText.width\n\n    innerText.setY(-innerTextHeight / 2 - this.playerName.height / 2)\n    const dialogBoxWidth = innerTextWidth + 10\n    const dialogBoxHeight = innerTextHeight + 3\n    const dialogBoxX = innerText.x - innerTextWidth / 2 - 5\n    const dialogBoxY = innerText.y - innerTextHeight / 2 - 2\n\n    this.playerDialogBubble.add(\n      this.scene.add\n        .graphics()\n        .fillStyle(0xffffff, 1)\n        .fillRoundedRect(dialogBoxX, dialogBoxY, dialogBoxWidth, dialogBoxHeight, 3)\n        .lineStyle(1, 0x000000, 1)\n        .strokeRoundedRect(dialogBoxX, dialogBoxY, dialogBoxWidth, dialogBoxHeight, 3)\n    )\n    this.playerDialogBubble.add(innerText)\n\n    // After 6 seconds, clear the dialog bubble\n    this.timeoutID = window.setTimeout(() => {\n      this.clearDialogBubble()\n    }, 6000)\n  }\n\n  private clearDialogBubble() {\n    clearTimeout(this.timeoutID)\n    this.playerDialogBubble.removeAll(true)\n  }\n}\n","import Phaser from 'phaser'\n\nexport const phaserEvents = new Phaser.Events.EventEmitter()\n\nexport enum Event {\n  PLAYER_JOINED = 'player-joined',\n  PLAYER_UPDATED = 'player-updated',\n  PLAYER_LEFT = 'player-left',\n  PLAYER_DISCONNECTED = 'player-disconnected',\n  MY_PLAYER_READY = 'my-player-ready',\n  MY_PLAYER_NAME_CHANGE = 'my-player-name-change',\n  MY_PLAYER_TEXTURE_CHANGE = 'my-player-texture-change',\n  MY_PLAYER_VIDEO_CONNECTED = 'my-player-video-connected',\n  ITEM_USER_ADDED = 'item-user-added',\n  ITEM_USER_REMOVED = 'item-user-removed',\n  UPDATE_DIALOG_BUBBLE = 'update-dialog-bubble',\n}\n","export function sanitizeId(id: string) {\n  let sanitized = id\n\n  if (sanitized.length > 9 && sanitized.endsWith('-ss')) {\n    sanitized = sanitized.substring(0, sanitized.length - 3)\n  }\n\n  return sanitized.replace(/[^0-9a-z]/gi, 'G')\n}\n\nconst colorArr = [\n  '#7bf1a8',\n  '#ff7e50',\n  '#9acd32',\n  '#daa520',\n  '#ff69b4',\n  '#c085f6',\n  '#1e90ff',\n  '#5f9da0',\n]\n\n// determine name color by first character charCode\nexport function getColorByString(string: string) {\n  return colorArr[Math.floor(string.charCodeAt(0) % colorArr.length)]\n}\n\nexport function getAvatarString(name: string) {\n  const part = name.split(' ')\n  return part.length < 2 ? part[0][0] : part[0][0] + part[1][0]\n}\n","export enum BackgroundMode {\n  DAY,\n  NIGHT,\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\r\nimport { sanitizeId } from '../util'\r\nimport { BackgroundMode } from '../../../types/BackgroundMode'\r\n\r\nimport phaserGame from '../PhaserGame'\r\nimport Bootstrap from '../scenes/Bootstrap'\r\n\r\nexport function getInitialBackgroundMode() {\r\n  const currentHour = new Date().getHours()\r\n  return currentHour > 6 && currentHour <= 18 ? BackgroundMode.DAY : BackgroundMode.NIGHT\r\n}\r\n\r\nexport const userSlice = createSlice({\r\n  name: 'user',\r\n  initialState: {\r\n    backgroundMode: getInitialBackgroundMode(),\r\n    sessionId: '',\r\n    videoConnected: false,\r\n    loggedIn: false,\r\n    playerNameMap: new Map<string, string>(),\r\n  },\r\n  reducers: {\r\n    toggleBackgroundMode: (state) => {\r\n      const newMode =\r\n        state.backgroundMode === BackgroundMode.DAY ? BackgroundMode.NIGHT : BackgroundMode.DAY\r\n\r\n      state.backgroundMode = newMode\r\n      const bootstrap = phaserGame.scene.keys.bootstrap as Bootstrap\r\n      bootstrap.changeBackgroundMode(newMode)\r\n    },\r\n    setSessionId: (state, action: PayloadAction<string>) => {\r\n      state.sessionId = action.payload\r\n    },\r\n    setVideoConnected: (state, action: PayloadAction<boolean>) => {\r\n      state.videoConnected = action.payload\r\n    },\r\n    setLoggedIn: (state, action: PayloadAction<boolean>) => {\r\n      state.loggedIn = action.payload\r\n    },\r\n    setPlayerNameMap: (state, action: PayloadAction<{ id: string; name: string }>) => {\r\n      state.playerNameMap.set(sanitizeId(action.payload.id), action.payload.name)\r\n    },\r\n    removePlayerNameMap: (state, action: PayloadAction<string>) => {\r\n      state.playerNameMap.delete(sanitizeId(action.payload))\r\n    },\r\n  },\r\n})\r\n\r\nexport const {\r\n  toggleBackgroundMode,\r\n  setSessionId,\r\n  setVideoConnected,\r\n  setLoggedIn,\r\n  setPlayerNameMap,\r\n  removePlayerNameMap,\r\n} = userSlice.actions\r\n\r\nexport default userSlice.reducer\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { IChatMessage } from '../../../types/IOfficeState'\nimport phaserGame from '../PhaserGame'\nimport Game from '../scenes/Game'\n\nexport enum MessageType {\n  PLAYER_JOINED,\n  PLAYER_LEFT,\n  REGULAR_MESSAGE,\n}\n\nexport const chatSlice = createSlice({\n  name: 'chat',\n  initialState: {\n    chatMessages: new Array<{ messageType: MessageType; chatMessage: IChatMessage }>(),\n    focused: false,\n    showChat: false,\n  },\n  reducers: {\n    pushChatMessage: (state, action: PayloadAction<IChatMessage>) => {\n      state.chatMessages.push({\n        messageType: MessageType.REGULAR_MESSAGE,\n        chatMessage: action.payload,\n      })\n    },\n    pushPlayerJoinedMessage: (state, action: PayloadAction<string>) => {\n      state.chatMessages.push({\n        messageType: MessageType.PLAYER_JOINED,\n        chatMessage: {\n          createdAt: new Date().getTime(),\n          author: action.payload,\n          content: 'joined the lobby',\n        } as IChatMessage,\n      })\n    },\n    pushPlayerLeftMessage: (state, action: PayloadAction<string>) => {\n      state.chatMessages.push({\n        messageType: MessageType.PLAYER_LEFT,\n        chatMessage: {\n          createdAt: new Date().getTime(),\n          author: action.payload,\n          content: 'left the lobby',\n        } as IChatMessage,\n      })\n    },\n    setFocused: (state, action: PayloadAction<boolean>) => {\n      const game = phaserGame.scene.keys.game as Game\n      action.payload ? game.disableKeys() : game.enableKeys()\n      state.focused = action.payload\n    },\n    setShowChat: (state, action: PayloadAction<boolean>) => {\n      state.showChat = action.payload\n    },\n  },\n})\n\nexport const {\n  pushChatMessage,\n  pushPlayerJoinedMessage,\n  pushPlayerLeftMessage,\n  setFocused,\n  setShowChat,\n} = chatSlice.actions\n\nexport default chatSlice.reducer\n","import Peer from 'peerjs'\nimport store from '../stores'\nimport { setMyStream, addVideoStream, removeVideoStream } from '../stores/ComputerStore'\nimport phaserGame from '../PhaserGame'\nimport Game from '../scenes/Game'\n\nexport default class ShareScreenManager {\n  private myPeer: Peer\n  myStream?: MediaStream\n\n  constructor(private userId: string) {\n    const sanatizedId = this.makeId(userId)\n    this.myPeer = new Peer(sanatizedId)\n    this.myPeer.on('error', (err) => {\n      console.log('ShareScreenWebRTC err.type', err.type)\n      console.error('ShareScreenWebRTC', err)\n    })\n\n    this.myPeer.on('call', (call) => {\n      call.answer()\n\n      call.on('stream', (userVideoStream) => {\n        store.dispatch(addVideoStream({ id: call.peer, call, stream: userVideoStream }))\n      })\n      // we handled on close on our own\n    })\n  }\n\n  onOpen() {\n    if (this.myPeer.disconnected) {\n      this.myPeer.reconnect()\n    }\n  }\n\n  onClose() {\n    this.stopScreenShare(false)\n    this.myPeer.disconnect()\n  }\n\n  // PeerJS throws invalid_id error if it contains some characters such as that colyseus generates.\n  // https://peerjs.com/docs.html#peer-id\n  // Also for screen sharing ID add a `-ss` at the end.\n  private makeId(id: string) {\n    return `${id.replace(/[^0-9a-z]/gi, 'G')}-ss`\n  }\n\n  startScreenShare() {\n    navigator.mediaDevices\n      ?.getDisplayMedia({\n        video: true,\n        audio: true,\n      })\n      .then((stream) => {\n        // Detect when user clicks \"Stop sharing\" outside of our UI.\n        // https://stackoverflow.com/a/25179198\n        const track = stream.getVideoTracks()[0]\n        if (track) {\n          track.onended = () => {\n            this.stopScreenShare()\n          }\n        }\n\n        this.myStream = stream\n        store.dispatch(setMyStream(stream))\n\n        // Call all existing users.\n        const game = phaserGame.scene.keys.game as Game\n        const computerItem = game.computerMap.get(store.getState().computer.computerId!)\n        if (computerItem) {\n          for (const userId of computerItem.currentUsers) {\n            this.onUserJoined(userId)\n          }\n        }\n      })\n  }\n\n  // TODO(daxchen): Fix this trash hack, if we call store.dispatch here when calling\n  // from onClose, it causes redux reducer cycle, this may be fixable by using thunk\n  // or something.\n  stopScreenShare(shouldDispatch = true) {\n    this.myStream?.getTracks().forEach((track) => track.stop())\n    this.myStream = undefined\n    if (shouldDispatch) {\n      store.dispatch(setMyStream(null))\n      // Manually let all other existing users know screen sharing is stopped\n      const game = phaserGame.scene.keys.game as Game\n      game.network.onStopScreenShare(store.getState().computer.computerId!)\n    }\n  }\n\n  onUserJoined(userId: string) {\n    if (!this.myStream || userId === this.userId) return\n\n    const sanatizedId = this.makeId(userId)\n    this.myPeer.call(sanatizedId, this.myStream)\n  }\n\n  onUserLeft(userId: string) {\n    if (userId === this.userId) return\n\n    const sanatizedId = this.makeId(userId)\n    store.dispatch(removeVideoStream(sanatizedId))\n  }\n}\n","import Peer from 'peerjs'\r\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit'\r\nimport ShareScreenManager from '../web/ShareScreenManager'\r\nimport phaserGame from '../PhaserGame'\r\nimport Game from '../scenes/Game'\r\nimport { sanitizeId } from '../util'\r\n\r\ninterface ComputerState {\r\n  computerDialogOpen: boolean\r\n  computerId: null | string\r\n  myStream: null | MediaStream\r\n  peerStreams: Map<\r\n    string,\r\n    {\r\n      stream: MediaStream\r\n      call: Peer.MediaConnection\r\n    }\r\n  >\r\n  shareScreenManager: null | ShareScreenManager\r\n}\r\n\r\nconst initialState: ComputerState = {\r\n  computerDialogOpen: false,\r\n  computerId: null,\r\n  myStream: null,\r\n  peerStreams: new Map(),\r\n  shareScreenManager: null,\r\n}\r\n\r\nexport const computerSlice = createSlice({\r\n  name: 'computer',\r\n  initialState,\r\n  reducers: {\r\n    openComputerDialog: (\r\n      state,\r\n      action: PayloadAction<{ computerId: string; myUserId: string }>\r\n    ) => {\r\n      if (!state.shareScreenManager) {\r\n        state.shareScreenManager = new ShareScreenManager(action.payload.myUserId)\r\n      }\r\n      const game = phaserGame.scene.keys.game as Game\r\n      game.disableKeys()\r\n      state.shareScreenManager.onOpen()\r\n      state.computerDialogOpen = true\r\n      state.computerId = action.payload.computerId\r\n    },\r\n    closeComputerDialog: (state) => {\r\n      // Tell server the computer dialog is closed.\r\n      const game = phaserGame.scene.keys.game as Game\r\n      game.enableKeys()\r\n      game.network.disconnectFromComputer(state.computerId!)\r\n      for (const { call } of state.peerStreams.values()) {\r\n        call.close()\r\n      }\r\n      state.shareScreenManager?.onClose()\r\n      state.computerDialogOpen = false\r\n      state.myStream = null\r\n      state.computerId = null\r\n      state.peerStreams.clear()\r\n    },\r\n    setMyStream: (state, action: PayloadAction<null | MediaStream>) => {\r\n      state.myStream = action.payload\r\n    },\r\n    addVideoStream: (\r\n      state,\r\n      action: PayloadAction<{ id: string; call: Peer.MediaConnection; stream: MediaStream }>\r\n    ) => {\r\n      state.peerStreams.set(sanitizeId(action.payload.id), {\r\n        call: action.payload.call,\r\n        stream: action.payload.stream,\r\n      })\r\n    },\r\n    removeVideoStream: (state, action: PayloadAction<string>) => {\r\n      state.peerStreams.delete(sanitizeId(action.payload))\r\n    },\r\n  },\r\n})\r\n\r\nexport const {\r\n  closeComputerDialog,\r\n  openComputerDialog,\r\n  setMyStream,\r\n  addVideoStream,\r\n  removeVideoStream,\r\n} = computerSlice.actions\r\n\r\nexport default computerSlice.reducer\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\n\nimport phaserGame from '../PhaserGame'\nimport Game from '../scenes/Game'\n\ninterface WhiteboardState {\n  whiteboardDialogOpen: boolean\n  whiteboardId: null | string\n  whiteboardUrl: null | string\n  urls: Map<string, string>\n}\n\nconst initialState: WhiteboardState = {\n  whiteboardDialogOpen: false,\n  whiteboardId: null,\n  whiteboardUrl: null,\n  urls: new Map(),\n}\n\nexport const whiteboardSlice = createSlice({\n  name: 'whiteboard',\n  initialState,\n  reducers: {\n    openWhiteboardDialog: (state, action: PayloadAction<string>) => {\n      state.whiteboardDialogOpen = true\n      state.whiteboardId = action.payload\n      const url = state.urls.get(action.payload)\n      if (url) state.whiteboardUrl = url\n      const game = phaserGame.scene.keys.game as Game\n      game.disableKeys()\n    },\n    closeWhiteboardDialog: (state) => {\n      const game = phaserGame.scene.keys.game as Game\n      game.enableKeys()\n      game.network.disconnectFromWhiteboard(state.whiteboardId!)\n      state.whiteboardDialogOpen = false\n      state.whiteboardId = null\n      state.whiteboardUrl = null\n    },\n    setWhiteboardUrls: (state, action: PayloadAction<{ whiteboardId: string; roomId: string }>) => {\n      state.urls.set(\n        action.payload.whiteboardId,\n        `https://www.tldraw.com/r/sky-office-${action.payload.roomId}`\n      )\n    },\n  },\n})\n\nexport const { openWhiteboardDialog, closeWhiteboardDialog, setWhiteboardUrls } =\n  whiteboardSlice.actions\n\nexport default whiteboardSlice.reducer\n","export enum RoomType {\n  LOBBY = 'lobby',\n  PUBLIC = 'skyoffice',\n  CUSTOM = 'custom',\n}\n\nexport interface IRoomData {\n  name: string\n  description: string\n  password: string | null\n  autoDispose: boolean\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { RoomAvailable } from 'colyseus.js'\nimport { RoomType } from '../../../types/Rooms'\n\ninterface RoomInterface extends RoomAvailable {\n  name?: string\n}\n\n/**\n * Colyseus' real time room list always includes the public lobby so we have to remove it manually.\n */\nconst isCustomRoom = (room: RoomInterface) => {\n  return room.name === RoomType.CUSTOM\n}\n\nexport const roomSlice = createSlice({\n  name: 'room',\n  initialState: {\n    lobbyJoined: false,\n    roomJoined: false,\n    roomId: '',\n    roomName: '',\n    roomDescription: '',\n    availableRooms: new Array<RoomAvailable>(),\n  },\n  reducers: {\n    setLobbyJoined: (state, action: PayloadAction<boolean>) => {\n      state.lobbyJoined = action.payload\n    },\n    setRoomJoined: (state, action: PayloadAction<boolean>) => {\n      state.roomJoined = action.payload\n    },\n    setJoinedRoomData: (\n      state,\n      action: PayloadAction<{ id: string; name: string; description: string }>\n    ) => {\n      state.roomId = action.payload.id\n      state.roomName = action.payload.name\n      state.roomDescription = action.payload.description\n    },\n    setAvailableRooms: (state, action: PayloadAction<RoomAvailable[]>) => {\n      state.availableRooms = action.payload.filter((room) => isCustomRoom(room))\n    },\n    addAvailableRooms: (state, action: PayloadAction<{ roomId: string; room: RoomAvailable }>) => {\n      if (!isCustomRoom(action.payload.room)) return\n      const roomIndex = state.availableRooms.findIndex(\n        (room) => room.roomId === action.payload.roomId\n      )\n      if (roomIndex !== -1) {\n        state.availableRooms[roomIndex] = action.payload.room\n      } else {\n        state.availableRooms.push(action.payload.room)\n      }\n    },\n    removeAvailableRooms: (state, action: PayloadAction<string>) => {\n      state.availableRooms = state.availableRooms.filter((room) => room.roomId !== action.payload)\n    },\n  },\n})\n\nexport const {\n  setLobbyJoined,\n  setRoomJoined,\n  setJoinedRoomData,\n  setAvailableRooms,\n  addAvailableRooms,\n  removeAvailableRooms,\n} = roomSlice.actions\n\nexport default roomSlice.reducer\n","import { enableMapSet } from 'immer'\r\nimport { configureStore } from '@reduxjs/toolkit'\r\nimport userReducer from './UserStore'\r\nimport computerReducer from './ComputerStore'\r\nimport whiteboardReducer from './WhiteboardStore'\r\nimport chatReducer from './ChatStore'\r\nimport roomReducer from './RoomStore'\r\n\r\nenableMapSet()\r\n\r\nconst store = configureStore({\r\n  reducer: {\r\n    user: userReducer,\r\n    computer: computerReducer,\r\n    whiteboard: whiteboardReducer,\r\n    chat: chatReducer,\r\n    room: roomReducer,\r\n  },\r\n  // Temporary disable serialize check for redux as we store MediaStream in ComputerStore.\r\n  // https://stackoverflow.com/a/63244831\r\n  middleware: (getDefaultMiddleware) =>\r\n    getDefaultMiddleware({\r\n      serializableCheck: false,\r\n    }),\r\n})\r\n\r\n// Infer the `RootState` and `AppDispatch` types from the store itself\r\nexport type RootState = ReturnType<typeof store.getState>\r\n// Inferred type: {posts: PostsState, comments: CommentsState, users: UsersState}\r\nexport type AppDispatch = typeof store.dispatch\r\n\r\nexport default store\r\n","export enum ItemType {\n  CHAIR,\n  COMPUTER,\n  WHITEBOARD,\n  VENDINGMACHINE,\n}\n","import Phaser from 'phaser'\nimport PlayerSelector from './PlayerSelector'\nimport { PlayerBehavior } from '../../../types/PlayerBehavior'\nimport { sittingShiftData } from './Player'\nimport Player from './Player'\nimport Network from '../services/Network'\nimport Chair from '../items/Chair'\nimport Computer from '../items/Computer'\nimport Whiteboard from '../items/Whiteboard'\n\nimport { phaserEvents, Event } from '../events/EventCenter'\nimport store from '../stores'\nimport { pushPlayerJoinedMessage } from '../stores/ChatStore'\nimport { ItemType } from '../../../types/Items'\n\nexport default class MyPlayer extends Player {\n  private playContainerBody: Phaser.Physics.Arcade.Body\n  private chairOnSit?: Chair\n  constructor(\n    scene: Phaser.Scene,\n    x: number,\n    y: number,\n    texture: string,\n    id: string,\n    frame?: string | number\n  ) {\n    super(scene, x, y, texture, id, frame)\n    this.playContainerBody = this.playerContainer.body as Phaser.Physics.Arcade.Body\n  }\n\n  setPlayerName(name: string) {\n    this.playerName.setText(name)\n    phaserEvents.emit(Event.MY_PLAYER_NAME_CHANGE, name)\n    store.dispatch(pushPlayerJoinedMessage(name))\n  }\n\n  setPlayerTexture(texture: string) {\n    this.playerTexture = texture\n    this.anims.play(`${this.playerTexture}_idle_down`, true)\n    phaserEvents.emit(Event.MY_PLAYER_TEXTURE_CHANGE, this.x, this.y, this.anims.currentAnim.key)\n  }\n\n  update(\n    playerSelector: PlayerSelector,\n    cursors: Phaser.Types.Input.Keyboard.CursorKeys,\n    keyE: Phaser.Input.Keyboard.Key,\n    keyR: Phaser.Input.Keyboard.Key,\n    network: Network\n  ) {\n    if (!cursors) return\n\n    const item = playerSelector.selectedItem\n\n    if (Phaser.Input.Keyboard.JustDown(keyR)) {\n      switch (item?.itemType) {\n        case ItemType.COMPUTER:\n          const computer = item as Computer\n          computer.openDialog(this.playerId, network)\n          break\n        case ItemType.WHITEBOARD:\n          const whiteboard = item as Whiteboard\n          whiteboard.openDialog(network)\n          break\n        case ItemType.VENDINGMACHINE:\n          // hacky and hard-coded, but leaving it as is for now\n          window.open('https://www.buymeacoffee.com/skyoffice', '_blank')\n          break\n      }\n    }\n\n    switch (this.playerBehavior) {\n      case PlayerBehavior.IDLE:\n        // if press E in front of selected chair\n        if (Phaser.Input.Keyboard.JustDown(keyE) && item?.itemType === ItemType.CHAIR) {\n          const chairItem = item as Chair\n          /**\n           * move player to the chair and play sit animation\n           * a delay is called to wait for player movement (from previous velocity) to end\n           * as the player tends to move one more frame before sitting down causing player\n           * not sitting at the center of the chair\n           */\n          this.scene.time.addEvent({\n            delay: 10,\n            callback: () => {\n              // update character velocity and position\n              this.setVelocity(0, 0)\n              if (chairItem.itemDirection) {\n                this.setPosition(\n                  chairItem.x + sittingShiftData[chairItem.itemDirection][0],\n                  chairItem.y + sittingShiftData[chairItem.itemDirection][1]\n                ).setDepth(chairItem.depth + sittingShiftData[chairItem.itemDirection][2])\n                // also update playerNameContainer velocity and position\n                this.playContainerBody.setVelocity(0, 0)\n                this.playerContainer.setPosition(\n                  chairItem.x + sittingShiftData[chairItem.itemDirection][0],\n                  chairItem.y + sittingShiftData[chairItem.itemDirection][1] - 30\n                )\n              }\n\n              this.play(`${this.playerTexture}_sit_${chairItem.itemDirection}`, true)\n              playerSelector.selectedItem = undefined\n              if (chairItem.itemDirection === 'up') {\n                playerSelector.setPosition(this.x, this.y - this.height)\n              } else {\n                playerSelector.setPosition(0, 0)\n              }\n              // send new location and anim to server\n              network.updatePlayer(this.x, this.y, this.anims.currentAnim.key)\n            },\n            loop: false,\n          })\n          // set up new dialog as player sits down\n          chairItem.clearDialogBox()\n          chairItem.setDialogBox('Press E to leave')\n          this.chairOnSit = chairItem\n          this.playerBehavior = PlayerBehavior.SITTING\n          return\n        }\n\n        const speed = 200\n        let vx = 0\n        let vy = 0\n        if (cursors.left?.isDown) vx -= speed\n        if (cursors.right?.isDown) vx += speed\n        if (cursors.up?.isDown) {\n          vy -= speed\n          this.setDepth(this.y) //change player.depth if player.y changes\n        }\n        if (cursors.down?.isDown) {\n          vy += speed\n          this.setDepth(this.y) //change player.depth if player.y changes\n        }\n        // update character velocity\n        this.setVelocity(vx, vy)\n        this.body.velocity.setLength(speed)\n        // also update playerNameContainer velocity\n        this.playContainerBody.setVelocity(vx, vy)\n        this.playContainerBody.velocity.setLength(speed)\n\n        // update animation according to velocity and send new location and anim to server\n        if (vx !== 0 || vy !== 0) network.updatePlayer(this.x, this.y, this.anims.currentAnim.key)\n        if (vx > 0) {\n          this.play(`${this.playerTexture}_run_right`, true)\n        } else if (vx < 0) {\n          this.play(`${this.playerTexture}_run_left`, true)\n        } else if (vy > 0) {\n          this.play(`${this.playerTexture}_run_down`, true)\n        } else if (vy < 0) {\n          this.play(`${this.playerTexture}_run_up`, true)\n        } else {\n          const parts = this.anims.currentAnim.key.split('_')\n          parts[1] = 'idle'\n          const newAnim = parts.join('_')\n          // this prevents idle animation keeps getting called\n          if (this.anims.currentAnim.key !== newAnim) {\n            this.play(parts.join('_'), true)\n            // send new location and anim to server\n            network.updatePlayer(this.x, this.y, this.anims.currentAnim.key)\n          }\n        }\n        break\n\n      case PlayerBehavior.SITTING:\n        // back to idle if player press E while sitting\n        if (Phaser.Input.Keyboard.JustDown(keyE)) {\n          const parts = this.anims.currentAnim.key.split('_')\n          parts[1] = 'idle'\n          this.play(parts.join('_'), true)\n          this.playerBehavior = PlayerBehavior.IDLE\n          this.chairOnSit?.clearDialogBox()\n          playerSelector.setPosition(this.x, this.y)\n          playerSelector.update(this, cursors)\n          network.updatePlayer(this.x, this.y, this.anims.currentAnim.key)\n        }\n        break\n    }\n  }\n}\n\ndeclare global {\n  namespace Phaser.GameObjects {\n    interface GameObjectFactory {\n      myPlayer(x: number, y: number, texture: string, id: string, frame?: string | number): MyPlayer\n    }\n  }\n}\n\nPhaser.GameObjects.GameObjectFactory.register(\n  'myPlayer',\n  function (\n    this: Phaser.GameObjects.GameObjectFactory,\n    x: number,\n    y: number,\n    texture: string,\n    id: string,\n    frame?: string | number\n  ) {\n    const sprite = new MyPlayer(this.scene, x, y, texture, id, frame)\n\n    this.displayList.add(sprite)\n    this.updateList.add(sprite)\n\n    this.scene.physics.world.enableBody(sprite, Phaser.Physics.Arcade.DYNAMIC_BODY)\n\n    const collisionScale = [0.5, 0.2]\n    sprite.body\n      .setSize(sprite.width * collisionScale[0], sprite.height * collisionScale[1])\n      .setOffset(\n        sprite.width * (1 - collisionScale[0]) * 0.5,\n        sprite.height * (1 - collisionScale[1])\n      )\n\n    return sprite\n  }\n)\n","import Phaser from 'phaser'\nimport Player from './Player'\nimport MyPlayer from './MyPlayer'\nimport { sittingShiftData } from './Player'\nimport WebRTC from '../web/WebRTC'\nimport { Event, phaserEvents } from '../events/EventCenter'\n\nexport default class OtherPlayer extends Player {\n  private targetPosition: [number, number]\n  private lastUpdateTimestamp?: number\n  private connectionBufferTime = 0\n  private connected = false\n  private playContainerBody: Phaser.Physics.Arcade.Body\n  private myPlayer?: MyPlayer\n\n  constructor(\n    scene: Phaser.Scene,\n    x: number,\n    y: number,\n    texture: string,\n    id: string,\n    name: string,\n    frame?: string | number\n  ) {\n    super(scene, x, y, texture, id, frame)\n    this.targetPosition = [x, y]\n\n    this.playerName.setText(name)\n    this.playContainerBody = this.playerContainer.body as Phaser.Physics.Arcade.Body\n  }\n\n  makeCall(myPlayer: MyPlayer, webRTC: WebRTC) {\n    this.myPlayer = myPlayer\n    const myPlayerId = myPlayer.playerId\n    if (\n      !this.connected &&\n      this.connectionBufferTime >= 750 &&\n      myPlayer.readyToConnect &&\n      this.readyToConnect &&\n      myPlayer.videoConnected &&\n      myPlayerId > this.playerId\n    ) {\n      webRTC.connectToNewUser(this.playerId)\n      this.connected = true\n      this.connectionBufferTime = 0\n    }\n  }\n\n  updateOtherPlayer(field: string, value: number | string | boolean) {\n    switch (field) {\n      case 'name':\n        if (typeof value === 'string') {\n          this.playerName.setText(value)\n        }\n        break\n\n      case 'x':\n        if (typeof value === 'number') {\n          this.targetPosition[0] = value\n        }\n        break\n\n      case 'y':\n        if (typeof value === 'number') {\n          this.targetPosition[1] = value\n        }\n        break\n\n      case 'anim':\n        if (typeof value === 'string') {\n          this.anims.play(value, true)\n        }\n        break\n\n      case 'readyToConnect':\n        if (typeof value === 'boolean') {\n          this.readyToConnect = value\n        }\n        break\n\n      case 'videoConnected':\n        if (typeof value === 'boolean') {\n          this.videoConnected = value\n        }\n        break\n    }\n  }\n\n  destroy(fromScene?: boolean) {\n    this.playerContainer.destroy()\n\n    super.destroy(fromScene)\n  }\n\n  /** preUpdate is called every frame for every game object. */\n  preUpdate(t: number, dt: number) {\n    super.preUpdate(t, dt)\n\n    // if Phaser has not updated the canvas (when the game tab is not active) for more than 1 sec\n    // directly snap player to their current locations\n    if (this.lastUpdateTimestamp && t - this.lastUpdateTimestamp > 750) {\n      this.lastUpdateTimestamp = t\n      this.x = this.targetPosition[0]\n      this.y = this.targetPosition[1]\n      this.playerContainer.x = this.targetPosition[0]\n      this.playerContainer.y = this.targetPosition[1] - 30\n      return\n    }\n\n    this.lastUpdateTimestamp = t\n    this.setDepth(this.y) // change player.depth based on player.y\n    const animParts = this.anims.currentAnim.key.split('_')\n    const animState = animParts[1]\n    if (animState === 'sit') {\n      const animDir = animParts[2]\n      const sittingShift = sittingShiftData[animDir]\n      if (sittingShift) {\n        // set hardcoded depth (differs between directions) if player sits down\n        this.setDepth(this.depth + sittingShiftData[animDir][2])\n      }\n    }\n\n    const speed = 200 // speed is in unit of pixels per second\n    const delta = (speed / 1000) * dt // minimum distance that a player can move in a frame (dt is in unit of ms)\n    let dx = this.targetPosition[0] - this.x\n    let dy = this.targetPosition[1] - this.y\n\n    // if the player is close enough to the target position, directly snap the player to that position\n    if (Math.abs(dx) < delta) {\n      this.x = this.targetPosition[0]\n      this.playerContainer.x = this.targetPosition[0]\n      dx = 0\n    }\n    if (Math.abs(dy) < delta) {\n      this.y = this.targetPosition[1]\n      this.playerContainer.y = this.targetPosition[1] - 30\n      dy = 0\n    }\n\n    // if the player is still far from target position, impose a constant velocity towards it\n    let vx = 0\n    let vy = 0\n    if (dx > 0) vx += speed\n    else if (dx < 0) vx -= speed\n    if (dy > 0) vy += speed\n    else if (dy < 0) vy -= speed\n\n    // update character velocity\n    this.setVelocity(vx, vy)\n    this.body.velocity.setLength(speed)\n    // also update playerNameContainer velocity\n    this.playContainerBody.setVelocity(vx, vy)\n    this.playContainerBody.velocity.setLength(speed)\n\n    // while currently connected with myPlayer\n    // if myPlayer and the otherPlayer stop overlapping, delete video stream\n    this.connectionBufferTime += dt\n    if (\n      this.connected &&\n      !this.body.embedded &&\n      this.body.touching.none &&\n      this.connectionBufferTime >= 750\n    ) {\n      if (this.x < 610 && this.y > 515 && this.myPlayer!.x < 610 && this.myPlayer!.y > 515) return\n      phaserEvents.emit(Event.PLAYER_DISCONNECTED, this.playerId)\n      this.connectionBufferTime = 0\n      this.connected = false\n    }\n  }\n}\n\ndeclare global {\n  namespace Phaser.GameObjects {\n    interface GameObjectFactory {\n      otherPlayer(\n        x: number,\n        y: number,\n        texture: string,\n        id: string,\n        name: string,\n        frame?: string | number\n      ): OtherPlayer\n    }\n  }\n}\n\nPhaser.GameObjects.GameObjectFactory.register(\n  'otherPlayer',\n  function (\n    this: Phaser.GameObjects.GameObjectFactory,\n    x: number,\n    y: number,\n    texture: string,\n    id: string,\n    name: string,\n    frame?: string | number\n  ) {\n    const sprite = new OtherPlayer(this.scene, x, y, texture, id, name, frame)\n\n    this.displayList.add(sprite)\n    this.updateList.add(sprite)\n\n    this.scene.physics.world.enableBody(sprite, Phaser.Physics.Arcade.DYNAMIC_BODY)\n\n    const collisionScale = [6, 4]\n    sprite.body\n      .setSize(sprite.width * collisionScale[0], sprite.height * collisionScale[1])\n      .setOffset(\n        sprite.width * (1 - collisionScale[0]) * 0.5,\n        sprite.height * (1 - collisionScale[1]) * 0.5 + 17\n      )\n\n    return sprite\n  }\n)\n","export enum Message {\n  UPDATE_PLAYER,\n  UPDATE_PLAYER_NAME,\n  READY_TO_CONNECT,\n  DISCONNECT_STREAM,\n  CONNECT_TO_COMPUTER,\n  DISCONNECT_FROM_COMPUTER,\n  STOP_SCREEN_SHARE,\n  CONNECT_TO_WHITEBOARD,\n  DISCONNECT_FROM_WHITEBOARD,\n  VIDEO_CONNECTED,\n  ADD_CHAT_MESSAGE,\n  SEND_ROOM_DATA,\n}\n","import Phaser from 'phaser'\nimport MyPlayer from './MyPlayer'\nimport { PlayerBehavior } from '../../../types/PlayerBehavior'\nimport Item from '../items/Item'\n\nexport default class PlayerSelector extends Phaser.GameObjects.Zone {\n  selectedItem?: Item\n\n  constructor(scene: Phaser.Scene, x: number, y: number, width: number, height: number) {\n    super(scene, x, y, width, height)\n\n    scene.physics.add.existing(this)\n  }\n\n  update(player: MyPlayer, cursors: Phaser.Types.Input.Keyboard.CursorKeys) {\n    if (!cursors) {\n      return\n    }\n\n    // no need to update player selection while sitting\n    if (player.playerBehavior === PlayerBehavior.SITTING) {\n      return\n    }\n\n    // update player selection box position so that it's always in front of the player\n    const { x, y } = player\n    if (cursors.left?.isDown) {\n      this.setPosition(x - 32, y)\n    } else if (cursors.right?.isDown) {\n      this.setPosition(x + 32, y)\n    } else if (cursors.up?.isDown) {\n      this.setPosition(x, y - 32)\n    } else if (cursors.down?.isDown) {\n      this.setPosition(x, y + 32)\n    }\n\n    // while currently selecting an item,\n    // if the selector and selection item stop overlapping, clear the dialog box and selected item\n    if (this.selectedItem) {\n      if (!this.scene.physics.overlap(this, this.selectedItem)) {\n        this.selectedItem.clearDialogBox()\n        this.selectedItem = undefined\n      }\n    }\n  }\n}\n","import Phaser from 'phaser'\n\n// import { debugDraw } from '../utils/debug'\nimport { createCharacterAnims } from '../anims/CharacterAnims'\n\nimport Item from '../items/Item'\nimport Chair from '../items/Chair'\nimport Computer from '../items/Computer'\nimport Whiteboard from '../items/Whiteboard'\nimport VendingMachine from '../items/VendingMachine'\nimport '../characters/MyPlayer'\nimport '../characters/OtherPlayer'\nimport MyPlayer from '../characters/MyPlayer'\nimport OtherPlayer from '../characters/OtherPlayer'\nimport PlayerSelector from '../characters/PlayerSelector'\nimport Network from '../services/Network'\nimport { IPlayer } from '../../../types/IOfficeState'\nimport { PlayerBehavior } from '../../../types/PlayerBehavior'\nimport { ItemType } from '../../../types/Items'\n\nimport store from '../stores'\nimport { setFocused, setShowChat } from '../stores/ChatStore'\n\nexport default class Game extends Phaser.Scene {\n  network!: Network\n  private cursors!: Phaser.Types.Input.Keyboard.CursorKeys\n  private keyE!: Phaser.Input.Keyboard.Key\n  private keyR!: Phaser.Input.Keyboard.Key\n  private map!: Phaser.Tilemaps.Tilemap\n  myPlayer!: MyPlayer\n  private playerSelector!: Phaser.GameObjects.Zone\n  private otherPlayers!: Phaser.Physics.Arcade.Group\n  private otherPlayerMap = new Map<string, OtherPlayer>()\n  computerMap = new Map<string, Computer>()\n  private whiteboardMap = new Map<string, Whiteboard>()\n\n  constructor() {\n    super('game')\n  }\n\n  registerKeys() {\n    this.cursors = this.input.keyboard.createCursorKeys()\n    // maybe we can have a dedicated method for adding keys if more keys are needed in the future\n    this.keyE = this.input.keyboard.addKey('E')\n    this.keyR = this.input.keyboard.addKey('R')\n    this.input.keyboard.disableGlobalCapture()\n    this.input.keyboard.on('keydown-ENTER', (event) => {\n      store.dispatch(setShowChat(true))\n      store.dispatch(setFocused(true))\n    })\n    this.input.keyboard.on('keydown-ESC', (event) => {\n      store.dispatch(setShowChat(false))\n    })\n  }\n\n  disableKeys() {\n    this.input.keyboard.enabled = false\n  }\n\n  enableKeys() {\n    this.input.keyboard.enabled = true\n  }\n\n  create(data: { network: Network }) {\n    if (!data.network) {\n      throw new Error('server instance missing')\n    } else {\n      this.network = data.network\n    }\n\n    createCharacterAnims(this.anims)\n\n    this.map = this.make.tilemap({ key: 'tilemap' })\n    const FloorAndGround = this.map.addTilesetImage('FloorAndGround', 'tiles_wall')\n\n    const groundLayer = this.map.createLayer('Ground', FloorAndGround)\n    groundLayer.setCollisionByProperty({ collides: true })\n\n    // debugDraw(groundLayer, this)\n\n    this.myPlayer = this.add.myPlayer(705, 500, 'adam', this.network.mySessionId)\n    this.playerSelector = new PlayerSelector(this, 0, 0, 16, 16)\n\n    // import chair objects from Tiled map to Phaser\n    // const chairs = this.physics.add.staticGroup({ classType: Chair })\n    // const chairLayer = this.map.getObjectLayer('Chair')\n    // chairLayer.objects.forEach((chairObj) => {\n    //   const item = this.addObjectFromTiled(chairs, chairObj, 'chairs', 'chair') as Chair\n    //   // custom properties[0] is the object direction specified in Tiled\n    //   item.itemDirection = chairObj.properties[0].value\n    // })\n\n    // import computers objects from Tiled map to Phaser\n    // const computers = this.physics.add.staticGroup({ classType: Computer })\n    // const computerLayer = this.map.getObjectLayer('Computer')\n    // computerLayer.objects.forEach((obj, i) => {\n    //   const item = this.addObjectFromTiled(computers, obj, 'computers', 'computer') as Computer\n    //   item.setDepth(item.y + item.height * 0.27)\n    //   const id = `${i}`\n    //   item.id = id\n    //   this.computerMap.set(id, item)\n    // })\n\n    // import whiteboards objects from Tiled map to Phaser\n    // const whiteboards = this.physics.add.staticGroup({ classType: Whiteboard })\n    // const whiteboardLayer = this.map.getObjectLayer('Whiteboard')\n    // whiteboardLayer.objects.forEach((obj, i) => {\n    //   const item = this.addObjectFromTiled(\n    //     whiteboards,\n    //     obj,\n    //     'whiteboards',\n    //     'whiteboard'\n    //   ) as Whiteboard\n    //   const id = `${i}`\n    //   item.id = id\n    //   this.whiteboardMap.set(id, item)\n    // })\n\n    // import vending machine objects from Tiled map to Phaser\n    // const vendingMachines = this.physics.add.staticGroup({ classType: VendingMachine })\n    // const vendingMachineLayer = this.map.getObjectLayer('VendingMachine')\n    // vendingMachineLayer.objects.forEach((obj, i) => {\n    //   this.addObjectFromTiled(vendingMachines, obj, 'vendingmachines', 'vendingmachine')\n    // })\n\n    // import other objects from Tiled map to Phaser\n    //this.addGroupFromTiled('Wall', 'tiles_wall', 'FloorAndGround', false)\n    //this.addGroupFromTiled('Objects', 'office', 'Modern_Office_Black_Shadow', false)\n    //this.addGroupFromTiled('ObjectsOnCollide', 'office', 'Modern_Office_Black_Shadow', true)\n    \n    // this.addGroupFromTiled('GenericObjects', 'generic', 'Generic', false)\n    // this.addGroupFromTiled('GenericObjectsOnCollide', 'generic', 'Generic', true)\n    // this.addGroupFromTiled('Basement', 'basement', 'Basement', true)\n\n    this.otherPlayers = this.physics.add.group({ classType: OtherPlayer })\n\n    this.cameras.main.zoom = 1.5\n    this.cameras.main.startFollow(this.myPlayer, true)\n\n    this.physics.add.collider([this.myPlayer, this.myPlayer.playerContainer], groundLayer)\n    //this.physics.add.collider([this.myPlayer, this.myPlayer.playerContainer], vendingMachines)\n\n    this.physics.add.overlap(\n      this.playerSelector,\n      //[chairs, computers, whiteboards, vendingMachines],\n      [],\n      this.handleItemSelectorOverlap,\n      undefined,\n      this\n    )\n\n    this.physics.add.overlap(\n      this.myPlayer,\n      this.otherPlayers,\n      this.handlePlayersOverlap,\n      undefined,\n      this\n    )\n\n    // register network event listeners\n    this.network.onPlayerJoined(this.handlePlayerJoined, this)\n    this.network.onPlayerLeft(this.handlePlayerLeft, this)\n    this.network.onMyPlayerReady(this.handleMyPlayerReady, this)\n    this.network.onMyPlayerVideoConnected(this.handleMyVideoConnected, this)\n    this.network.onPlayerUpdated(this.handlePlayerUpdated, this)\n    this.network.onItemUserAdded(this.handleItemUserAdded, this)\n    this.network.onItemUserRemoved(this.handleItemUserRemoved, this)\n    this.network.onChatMessageAdded(this.handleChatMessageAdded, this)\n  }\n\n  private handleItemSelectorOverlap(playerSelector, selectionItem) {\n    const currentItem = playerSelector.selectedItem as Item\n    // currentItem is undefined if nothing was perviously selected\n    if (currentItem) {\n      // if the selection has not changed, do nothing\n      if (currentItem === selectionItem || currentItem.depth >= selectionItem.depth) {\n        return\n      }\n      // if selection changes, clear pervious dialog\n      if (this.myPlayer.playerBehavior !== PlayerBehavior.SITTING) currentItem.clearDialogBox()\n    }\n\n    // set selected item and set up new dialog\n    playerSelector.selectedItem = selectionItem\n    selectionItem.onOverlapDialog()\n  }\n\n  private addObjectFromTiled(\n    group: Phaser.Physics.Arcade.StaticGroup,\n    object: Phaser.Types.Tilemaps.TiledObject,\n    key: string,\n    tilesetName: string\n  ) {\n    const actualX = object.x! + object.width! * 0.5\n    const actualY = object.y! - object.height! * 0.5\n    const obj = group\n      .get(actualX, actualY, key, object.gid! - this.map.getTileset(tilesetName).firstgid)\n      .setDepth(actualY)\n    return obj\n  }\n\n  private addGroupFromTiled(\n    objectLayerName: string,\n    key: string,\n    tilesetName: string,\n    collidable: boolean\n  ) {\n    const group = this.physics.add.staticGroup()\n    const objectLayer = this.map.getObjectLayer(objectLayerName)\n    objectLayer.objects.forEach((object) => {\n      const actualX = object.x! + object.width! * 0.5\n      const actualY = object.y! - object.height! * 0.5\n      group\n        .get(actualX, actualY, key, object.gid! - this.map.getTileset(tilesetName).firstgid)\n        .setDepth(actualY)\n    })\n    if (this.myPlayer && collidable)\n      this.physics.add.collider([this.myPlayer, this.myPlayer.playerContainer], group)\n  }\n\n  // function to add new player to the otherPlayer group\n  private handlePlayerJoined(newPlayer: IPlayer, id: string) {\n    const otherPlayer = this.add.otherPlayer(newPlayer.x, newPlayer.y, 'adam', id, newPlayer.name)\n    this.otherPlayers.add(otherPlayer)\n    this.otherPlayerMap.set(id, otherPlayer)\n  }\n\n  // function to remove the player who left from the otherPlayer group\n  private handlePlayerLeft(id: string) {\n    if (this.otherPlayerMap.has(id)) {\n      const otherPlayer = this.otherPlayerMap.get(id)\n      if (!otherPlayer) return\n      this.otherPlayers.remove(otherPlayer, true, true)\n      this.otherPlayerMap.delete(id)\n    }\n  }\n\n  private handleMyPlayerReady() {\n    this.myPlayer.readyToConnect = true\n  }\n\n  private handleMyVideoConnected() {\n    this.myPlayer.videoConnected = true\n  }\n\n  // function to update target position upon receiving player updates\n  private handlePlayerUpdated(field: string, value: number | string, id: string) {\n    const otherPlayer = this.otherPlayerMap.get(id)\n    otherPlayer?.updateOtherPlayer(field, value)\n  }\n\n  private handlePlayersOverlap(myPlayer, otherPlayer) {\n    otherPlayer.makeCall(myPlayer, this.network?.webRTC)\n  }\n\n  private handleItemUserAdded(playerId: string, itemId: string, itemType: ItemType) {\n    if (itemType === ItemType.COMPUTER) {\n      const computer = this.computerMap.get(itemId)\n      computer?.addCurrentUser(playerId)\n    } else if (itemType === ItemType.WHITEBOARD) {\n      const whiteboard = this.whiteboardMap.get(itemId)\n      whiteboard?.addCurrentUser(playerId)\n    }\n  }\n\n  private handleItemUserRemoved(playerId: string, itemId: string, itemType: ItemType) {\n    if (itemType === ItemType.COMPUTER) {\n      const computer = this.computerMap.get(itemId)\n      computer?.removeCurrentUser(playerId)\n    } else if (itemType === ItemType.WHITEBOARD) {\n      const whiteboard = this.whiteboardMap.get(itemId)\n      whiteboard?.removeCurrentUser(playerId)\n    }\n  }\n\n  private handleChatMessageAdded(playerId: string, content: string) {\n    const otherPlayer = this.otherPlayerMap.get(playerId)\n    otherPlayer?.updateDialogBubble(content)\n  }\n\n  update(t: number, dt: number) {\n    if (this.myPlayer && this.network) {\n      this.playerSelector.update(this.myPlayer, this.cursors)\n      this.myPlayer.update(this.playerSelector, this.cursors, this.keyE, this.keyR, this.network)\n    }\n  }\n}\n","import Phaser from 'phaser'\n\nexport const createCharacterAnims = (anims: Phaser.Animations.AnimationManager) => {\n  const animsFrameRate = 15\n\n  anims.create({\n    key: 'nancy_idle_right',\n    frames: anims.generateFrameNames('nancy', {\n      start: 0,\n      end: 5,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'nancy_idle_up',\n    frames: anims.generateFrameNames('nancy', {\n      start: 6,\n      end: 11,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'nancy_idle_left',\n    frames: anims.generateFrameNames('nancy', {\n      start: 12,\n      end: 17,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'nancy_idle_down',\n    frames: anims.generateFrameNames('nancy', {\n      start: 18,\n      end: 23,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'nancy_run_right',\n    frames: anims.generateFrameNames('nancy', {\n      start: 24,\n      end: 29,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'nancy_run_up',\n    frames: anims.generateFrameNames('nancy', {\n      start: 30,\n      end: 35,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'nancy_run_left',\n    frames: anims.generateFrameNames('nancy', {\n      start: 36,\n      end: 41,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'nancy_run_down',\n    frames: anims.generateFrameNames('nancy', {\n      start: 42,\n      end: 47,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'nancy_sit_down',\n    frames: anims.generateFrameNames('nancy', {\n      start: 48,\n      end: 48,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'nancy_sit_left',\n    frames: anims.generateFrameNames('nancy', {\n      start: 49,\n      end: 49,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'nancy_sit_right',\n    frames: anims.generateFrameNames('nancy', {\n      start: 50,\n      end: 50,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'nancy_sit_up',\n    frames: anims.generateFrameNames('nancy', {\n      start: 51,\n      end: 51,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'lucy_idle_right',\n    frames: anims.generateFrameNames('lucy', {\n      start: 0,\n      end: 5,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'lucy_idle_up',\n    frames: anims.generateFrameNames('lucy', {\n      start: 6,\n      end: 11,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'lucy_idle_left',\n    frames: anims.generateFrameNames('lucy', {\n      start: 12,\n      end: 17,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'lucy_idle_down',\n    frames: anims.generateFrameNames('lucy', {\n      start: 18,\n      end: 23,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'lucy_run_right',\n    frames: anims.generateFrameNames('lucy', {\n      start: 24,\n      end: 29,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'lucy_run_up',\n    frames: anims.generateFrameNames('lucy', {\n      start: 30,\n      end: 35,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'lucy_run_left',\n    frames: anims.generateFrameNames('lucy', {\n      start: 36,\n      end: 41,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'lucy_run_down',\n    frames: anims.generateFrameNames('lucy', {\n      start: 42,\n      end: 47,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'lucy_sit_down',\n    frames: anims.generateFrameNames('lucy', {\n      start: 48,\n      end: 48,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'lucy_sit_left',\n    frames: anims.generateFrameNames('lucy', {\n      start: 49,\n      end: 49,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'lucy_sit_right',\n    frames: anims.generateFrameNames('lucy', {\n      start: 50,\n      end: 50,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'lucy_sit_up',\n    frames: anims.generateFrameNames('lucy', {\n      start: 51,\n      end: 51,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'ash_idle_right',\n    frames: anims.generateFrameNames('ash', {\n      start: 0,\n      end: 5,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'ash_idle_up',\n    frames: anims.generateFrameNames('ash', {\n      start: 6,\n      end: 11,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'ash_idle_left',\n    frames: anims.generateFrameNames('ash', {\n      start: 12,\n      end: 17,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'ash_idle_down',\n    frames: anims.generateFrameNames('ash', {\n      start: 18,\n      end: 23,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'ash_run_right',\n    frames: anims.generateFrameNames('ash', {\n      start: 24,\n      end: 29,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'ash_run_up',\n    frames: anims.generateFrameNames('ash', {\n      start: 30,\n      end: 35,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'ash_run_left',\n    frames: anims.generateFrameNames('ash', {\n      start: 36,\n      end: 41,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'ash_run_down',\n    frames: anims.generateFrameNames('ash', {\n      start: 42,\n      end: 47,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'ash_sit_down',\n    frames: anims.generateFrameNames('ash', {\n      start: 48,\n      end: 48,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'ash_sit_left',\n    frames: anims.generateFrameNames('ash', {\n      start: 49,\n      end: 49,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'ash_sit_right',\n    frames: anims.generateFrameNames('ash', {\n      start: 50,\n      end: 50,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'ash_sit_up',\n    frames: anims.generateFrameNames('ash', {\n      start: 51,\n      end: 51,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'adam_idle_right',\n    frames: anims.generateFrameNames('adam', {\n      start: 0,\n      end: 5,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'adam_idle_up',\n    frames: anims.generateFrameNames('adam', {\n      start: 6,\n      end: 11,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'adam_idle_left',\n    frames: anims.generateFrameNames('adam', {\n      start: 12,\n      end: 17,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'adam_idle_down',\n    frames: anims.generateFrameNames('adam', {\n      start: 18,\n      end: 23,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate * 0.6,\n  })\n\n  anims.create({\n    key: 'adam_run_right',\n    frames: anims.generateFrameNames('adam', {\n      start: 24,\n      end: 29,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'adam_run_up',\n    frames: anims.generateFrameNames('adam', {\n      start: 30,\n      end: 35,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'adam_run_left',\n    frames: anims.generateFrameNames('adam', {\n      start: 36,\n      end: 41,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'adam_run_down',\n    frames: anims.generateFrameNames('adam', {\n      start: 42,\n      end: 47,\n    }),\n    repeat: -1,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'adam_sit_down',\n    frames: anims.generateFrameNames('adam', {\n      start: 48,\n      end: 48,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'adam_sit_left',\n    frames: anims.generateFrameNames('adam', {\n      start: 49,\n      end: 49,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'adam_sit_right',\n    frames: anims.generateFrameNames('adam', {\n      start: 50,\n      end: 50,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n\n  anims.create({\n    key: 'adam_sit_up',\n    frames: anims.generateFrameNames('adam', {\n      start: 51,\n      end: 51,\n    }),\n    repeat: 0,\n    frameRate: animsFrameRate,\n  })\n}\n","import Phaser from 'phaser'\nimport { BackgroundMode } from '../../../types/BackgroundMode'\n\nexport default class Background extends Phaser.Scene {\n  private cloud!: Phaser.Physics.Arcade.Group\n  private cloudKey!: string\n  private backdropKey!: string\n\n  constructor() {\n    super('background')\n  }\n\n  create(data: { backgroundMode: BackgroundMode }) {\n    const sceneHeight = this.cameras.main.height\n    const sceneWidth = this.cameras.main.width\n\n    // set texture of images based on the background mode\n    if (data.backgroundMode === BackgroundMode.DAY) {\n      this.backdropKey = 'backdrop_day'\n      this.cloudKey = 'cloud_day'\n      this.cameras.main.setBackgroundColor('#c6eefc')\n    } else {\n      this.backdropKey = 'backdrop_night'\n      this.cloudKey = 'cloud_night'\n      this.cameras.main.setBackgroundColor('#2c4464')\n    }\n\n    // Add backdrop image\n    const backdropImage = this.add.image(sceneWidth / 2, sceneHeight / 2, this.backdropKey)\n    const scale = Math.max(sceneWidth / backdropImage.width, sceneHeight / backdropImage.height)\n    backdropImage.setScale(scale).setScrollFactor(0)\n\n    // Add sun or moon image\n    const sunMoonImage = this.add.image(sceneWidth / 2, sceneHeight / 2, 'sun_moon')\n    const scale2 = Math.max(sceneWidth / sunMoonImage.width, sceneHeight / sunMoonImage.height)\n    sunMoonImage.setScale(scale2).setScrollFactor(0)\n\n    // Add 24 clouds at random positions and with random speeds\n    const frames = this.textures.get(this.cloudKey).getFrameNames()\n    this.cloud = this.physics.add.group()\n    for (let i = 0; i < 24; i++) {\n      const x = Phaser.Math.RND.between(-sceneWidth * 0.5, sceneWidth * 1.5)\n      const y = Phaser.Math.RND.between(sceneHeight * 0.2, sceneHeight * 0.8)\n      const velocity = Phaser.Math.RND.between(15, 30)\n\n      this.cloud\n        .get(x, y, this.cloudKey, frames[i % 6])\n        .setScale(3)\n        .setVelocity(velocity, 0)\n    }\n  }\n\n  update(t: number, dt: number) {\n    this.physics.world.wrap(this.cloud, 500)\n  }\n}\n","import Peer from 'peerjs'\nimport Network from '../services/Network'\nimport store from '../stores'\nimport { setVideoConnected } from '../stores/UserStore'\n\nexport default class WebRTC {\n  private myPeer: Peer\n  private peers = new Map<string, { call: Peer.MediaConnection; video: HTMLVideoElement }>()\n  private onCalledPeers = new Map<string, { call: Peer.MediaConnection; video: HTMLVideoElement }>()\n  private videoGrid = document.querySelector('.video-grid')\n  private buttonGrid = document.querySelector('.button-grid')\n  private myVideo = document.createElement('video')\n  private myStream?: MediaStream\n  private network: Network\n\n  constructor(userId: string, network: Network) {\n    const sanitizedId = this.replaceInvalidId(userId)\n    this.myPeer = new Peer(sanitizedId)\n    this.network = network\n    console.log('userId:', userId)\n    console.log('sanitizedId:', sanitizedId)\n    this.myPeer.on('error', (err) => {\n      console.log(err.type)\n      console.error(err)\n    })\n\n    // mute your own video stream (you don't want to hear yourself)\n    this.myVideo.muted = true\n\n    // config peerJS\n    this.initialize()\n  }\n\n  // PeerJS throws invalid_id error if it contains some characters such as that colyseus generates.\n  // https://peerjs.com/docs.html#peer-id\n  private replaceInvalidId(userId: string) {\n    return userId.replace(/[^0-9a-z]/gi, 'G')\n  }\n\n  initialize() {\n    this.myPeer.on('call', (call) => {\n      if (!this.onCalledPeers.has(call.peer)) {\n        call.answer(this.myStream)\n        const video = document.createElement('video')\n        this.onCalledPeers.set(call.peer, { call, video })\n\n        call.on('stream', (userVideoStream) => {\n          this.addVideoStream(video, userVideoStream)\n        })\n      }\n      // on close is triggered manually with deleteOnCalledVideoStream()\n    })\n  }\n\n  // check if permission has been granted before\n  checkPreviousPermission() {\n    const permissionName = 'microphone' as PermissionName\n    navigator.permissions?.query({ name: permissionName }).then((result) => {\n      if (result.state === 'granted') this.getUserMedia(false)\n    })\n  }\n\n  getUserMedia(alertOnError = true) {\n    // ask the browser to get user media\n    navigator.mediaDevices\n      ?.getUserMedia({\n        video: true,\n        audio: true,\n      })\n      .then((stream) => {\n        this.myStream = stream\n        this.addVideoStream(this.myVideo, this.myStream)\n        this.setUpButtons()\n        store.dispatch(setVideoConnected(true))\n        this.network.videoConnected()\n      })\n      .catch((error) => {\n        if (alertOnError) window.alert('No webcam or microphone found, or permission is blocked')\n      })\n  }\n\n  // method to call a peer\n  connectToNewUser(userId: string) {\n    if (this.myStream) {\n      const sanitizedId = this.replaceInvalidId(userId)\n      if (!this.peers.has(sanitizedId)) {\n        console.log('calling', sanitizedId)\n        const call = this.myPeer.call(sanitizedId, this.myStream)\n        const video = document.createElement('video')\n        this.peers.set(sanitizedId, { call, video })\n\n        call.on('stream', (userVideoStream) => {\n          this.addVideoStream(video, userVideoStream)\n        })\n\n        // on close is triggered manually with deleteVideoStream()\n      }\n    }\n  }\n\n  // method to add new video stream to videoGrid div\n  addVideoStream(video: HTMLVideoElement, stream: MediaStream) {\n    video.srcObject = stream\n    video.addEventListener('loadedmetadata', () => {\n      video.play()\n    })\n    if (this.videoGrid) this.videoGrid.append(video)\n  }\n\n  // method to remove video stream (when we are the host of the call)\n  deleteVideoStream(userId: string) {\n    const sanitizedId = this.replaceInvalidId(userId)\n    if (this.peers.has(sanitizedId)) {\n      const peer = this.peers.get(sanitizedId)\n      peer?.call.close()\n      peer?.video.remove()\n      this.peers.delete(sanitizedId)\n    }\n  }\n\n  // method to remove video stream (when we are the guest of the call)\n  deleteOnCalledVideoStream(userId: string) {\n    const sanitizedId = this.replaceInvalidId(userId)\n    if (this.onCalledPeers.has(sanitizedId)) {\n      const onCalledPeer = this.onCalledPeers.get(sanitizedId)\n      onCalledPeer?.call.close()\n      onCalledPeer?.video.remove()\n      this.onCalledPeers.delete(sanitizedId)\n    }\n  }\n\n  // method to set up mute/unmute and video on/off buttons\n  setUpButtons() {\n    const audioButton = document.createElement('button')\n    audioButton.innerText = 'Mute'\n    audioButton.addEventListener('click', () => {\n      if (this.myStream) {\n        const audioTrack = this.myStream.getAudioTracks()[0]\n        if (audioTrack.enabled) {\n          audioTrack.enabled = false\n          audioButton.innerText = 'Unmute'\n        } else {\n          audioTrack.enabled = true\n          audioButton.innerText = 'Mute'\n        }\n      }\n    })\n    const videoButton = document.createElement('button')\n    videoButton.innerText = 'Video off'\n    videoButton.addEventListener('click', () => {\n      if (this.myStream) {\n        const audioTrack = this.myStream.getVideoTracks()[0]\n        if (audioTrack.enabled) {\n          audioTrack.enabled = false\n          videoButton.innerText = 'Video on'\n        } else {\n          audioTrack.enabled = true\n          videoButton.innerText = 'Video off'\n        }\n      }\n    })\n    this.buttonGrid?.append(audioButton)\n    this.buttonGrid?.append(videoButton)\n  }\n}\n","import { Client, Room } from 'colyseus.js'\nimport { IComputer, IOfficeState, IPlayer, IWhiteboard } from '../../../types/IOfficeState'\nimport { Message } from '../../../types/Messages'\nimport { IRoomData, RoomType } from '../../../types/Rooms'\nimport { ItemType } from '../../../types/Items'\nimport WebRTC from '../web/WebRTC'\nimport { phaserEvents, Event } from '../events/EventCenter'\nimport store from '../stores'\nimport { setSessionId, setPlayerNameMap, removePlayerNameMap } from '../stores/UserStore'\nimport {\n  setLobbyJoined,\n  setJoinedRoomData,\n  setAvailableRooms,\n  addAvailableRooms,\n  removeAvailableRooms,\n} from '../stores/RoomStore'\nimport {\n  pushChatMessage,\n  pushPlayerJoinedMessage,\n  pushPlayerLeftMessage,\n} from '../stores/ChatStore'\nimport { setWhiteboardUrls } from '../stores/WhiteboardStore'\n\nexport default class Network {\n  private client: Client\n  private room?: Room<IOfficeState>\n  private lobby!: Room\n  webRTC?: WebRTC\n\n  mySessionId!: string\n\n  constructor() {\n    const protocol = window.location.protocol.replace('http', 'ws')\n    const endpoint =\n      process.env.NODE_ENV === 'production'\n        ? `wss://castle-cafe-test.herokuapp.com`\n        : `wss://castle-cafe-test.herokuapp.com`\n    this.client = new Client(endpoint)\n    this.joinLobbyRoom().then(() => {\n      store.dispatch(setLobbyJoined(true))\n    })\n\n    phaserEvents.on(Event.MY_PLAYER_NAME_CHANGE, this.updatePlayerName, this)\n    phaserEvents.on(Event.MY_PLAYER_TEXTURE_CHANGE, this.updatePlayer, this)\n    phaserEvents.on(Event.PLAYER_DISCONNECTED, this.playerStreamDisconnect, this)\n  }\n\n  /**\n   * method to join Colyseus' built-in LobbyRoom, which automatically notifies\n   * connected clients whenever rooms with \"realtime listing\" have updates\n   */\n  async joinLobbyRoom() {\n    this.lobby = await this.client.joinOrCreate(RoomType.LOBBY)\n\n    this.lobby.onMessage('rooms', (rooms) => {\n      store.dispatch(setAvailableRooms(rooms))\n    })\n\n    this.lobby.onMessage('+', ([roomId, room]) => {\n      store.dispatch(addAvailableRooms({ roomId, room }))\n    })\n\n    this.lobby.onMessage('-', (roomId) => {\n      store.dispatch(removeAvailableRooms(roomId))\n    })\n  }\n\n  // method to join the public lobby\n  async joinOrCreatePublic() {\n    this.room = await this.client.joinOrCreate(RoomType.PUBLIC)\n    this.initialize()\n  }\n\n  // method to join a custom room\n  async joinCustomById(roomId: string, password: string | null) {\n    this.room = await this.client.joinById(roomId, { password })\n    this.initialize()\n  }\n\n  // method to create a custom room\n  async createCustom(roomData: IRoomData) {\n    const { name, description, password, autoDispose } = roomData\n    this.room = await this.client.create(RoomType.CUSTOM, {\n      name,\n      description,\n      password,\n      autoDispose,\n    })\n    this.initialize()\n  }\n\n  // set up all network listeners before the game starts\n  initialize() {\n    if (!this.room) return\n\n    this.lobby.leave()\n    this.mySessionId = this.room.sessionId\n    store.dispatch(setSessionId(this.room.sessionId))\n    this.webRTC = new WebRTC(this.mySessionId, this)\n\n    // new instance added to the players MapSchema\n    this.room.state.players.onAdd = (player: IPlayer, key: string) => {\n      if (key === this.mySessionId) return\n\n      // track changes on every child object inside the players MapSchema\n      player.onChange = (changes) => {\n        changes.forEach((change) => {\n          const { field, value } = change\n          phaserEvents.emit(Event.PLAYER_UPDATED, field, value, key)\n\n          // when a new player finished setting up player name\n          if (field === 'name' && value !== '') {\n            phaserEvents.emit(Event.PLAYER_JOINED, player, key)\n            store.dispatch(setPlayerNameMap({ id: key, name: value }))\n            store.dispatch(pushPlayerJoinedMessage(value))\n          }\n        })\n      }\n    }\n\n    // an instance removed from the players MapSchema\n    this.room.state.players.onRemove = (player: IPlayer, key: string) => {\n      phaserEvents.emit(Event.PLAYER_LEFT, key)\n      this.webRTC?.deleteVideoStream(key)\n      this.webRTC?.deleteOnCalledVideoStream(key)\n      store.dispatch(pushPlayerLeftMessage(player.name))\n      store.dispatch(removePlayerNameMap(key))\n    }\n\n    // new instance added to the computers MapSchema\n    this.room.state.computers.onAdd = (computer: IComputer, key: string) => {\n      // track changes on every child object's connectedUser\n      computer.connectedUser.onAdd = (item, index) => {\n        phaserEvents.emit(Event.ITEM_USER_ADDED, item, key, ItemType.COMPUTER)\n      }\n      computer.connectedUser.onRemove = (item, index) => {\n        phaserEvents.emit(Event.ITEM_USER_REMOVED, item, key, ItemType.COMPUTER)\n      }\n    }\n\n    // new instance added to the whiteboards MapSchema\n    this.room.state.whiteboards.onAdd = (whiteboard: IWhiteboard, key: string) => {\n      store.dispatch(\n        setWhiteboardUrls({\n          whiteboardId: key,\n          roomId: whiteboard.roomId,\n        })\n      )\n      // track changes on every child object's connectedUser\n      whiteboard.connectedUser.onAdd = (item, index) => {\n        phaserEvents.emit(Event.ITEM_USER_ADDED, item, key, ItemType.WHITEBOARD)\n      }\n      whiteboard.connectedUser.onRemove = (item, index) => {\n        phaserEvents.emit(Event.ITEM_USER_REMOVED, item, key, ItemType.WHITEBOARD)\n      }\n    }\n\n    // new instance added to the chatMessages ArraySchema\n    this.room.state.chatMessages.onAdd = (item, index) => {\n      store.dispatch(pushChatMessage(item))\n    }\n\n    // when the server sends room data\n    this.room.onMessage(Message.SEND_ROOM_DATA, (content) => {\n      store.dispatch(setJoinedRoomData(content))\n    })\n\n    // when a user sends a message\n    this.room.onMessage(Message.ADD_CHAT_MESSAGE, ({ clientId, content }) => {\n      phaserEvents.emit(Event.UPDATE_DIALOG_BUBBLE, clientId, content)\n    })\n\n    // when a peer disconnects with myPeer\n    this.room.onMessage(Message.DISCONNECT_STREAM, (clientId: string) => {\n      this.webRTC?.deleteOnCalledVideoStream(clientId)\n    })\n\n    // when a computer user stops sharing screen\n    this.room.onMessage(Message.STOP_SCREEN_SHARE, (clientId: string) => {\n      const computerState = store.getState().computer\n      computerState.shareScreenManager?.onUserLeft(clientId)\n    })\n  }\n\n  // method to register event listener and call back function when a item user added\n  onChatMessageAdded(callback: (playerId: string, content: string) => void, context?: any) {\n    phaserEvents.on(Event.UPDATE_DIALOG_BUBBLE, callback, context)\n  }\n\n  // method to register event listener and call back function when a item user added\n  onItemUserAdded(\n    callback: (playerId: string, key: string, itemType: ItemType) => void,\n    context?: any\n  ) {\n    phaserEvents.on(Event.ITEM_USER_ADDED, callback, context)\n  }\n\n  // method to register event listener and call back function when a item user removed\n  onItemUserRemoved(\n    callback: (playerId: string, key: string, itemType: ItemType) => void,\n    context?: any\n  ) {\n    phaserEvents.on(Event.ITEM_USER_REMOVED, callback, context)\n  }\n\n  // method to register event listener and call back function when a player joined\n  onPlayerJoined(callback: (Player: IPlayer, key: string) => void, context?: any) {\n    phaserEvents.on(Event.PLAYER_JOINED, callback, context)\n  }\n\n  // method to register event listener and call back function when a player left\n  onPlayerLeft(callback: (key: string) => void, context?: any) {\n    phaserEvents.on(Event.PLAYER_LEFT, callback, context)\n  }\n\n  // method to register event listener and call back function when myPlayer is ready to connect\n  onMyPlayerReady(callback: (key: string) => void, context?: any) {\n    phaserEvents.on(Event.MY_PLAYER_READY, callback, context)\n  }\n\n  // method to register event listener and call back function when my video is connected\n  onMyPlayerVideoConnected(callback: (key: string) => void, context?: any) {\n    phaserEvents.on(Event.MY_PLAYER_VIDEO_CONNECTED, callback, context)\n  }\n\n  // method to register event listener and call back function when a player updated\n  onPlayerUpdated(\n    callback: (field: string, value: number | string, key: string) => void,\n    context?: any\n  ) {\n    phaserEvents.on(Event.PLAYER_UPDATED, callback, context)\n  }\n\n  // method to send player updates to Colyseus server\n  updatePlayer(currentX: number, currentY: number, currentAnim: string) {\n    this.room?.send(Message.UPDATE_PLAYER, { x: currentX, y: currentY, anim: currentAnim })\n  }\n\n  // method to send player name to Colyseus server\n  updatePlayerName(currentName: string) {\n    this.room?.send(Message.UPDATE_PLAYER_NAME, { name: currentName })\n  }\n\n  // method to send ready-to-connect signal to Colyseus server\n  readyToConnect() {\n    this.room?.send(Message.READY_TO_CONNECT)\n    phaserEvents.emit(Event.MY_PLAYER_READY)\n  }\n\n  // method to send ready-to-connect signal to Colyseus server\n  videoConnected() {\n    this.room?.send(Message.VIDEO_CONNECTED)\n    phaserEvents.emit(Event.MY_PLAYER_VIDEO_CONNECTED)\n  }\n\n  // method to send stream-disconnection signal to Colyseus server\n  playerStreamDisconnect(id: string) {\n    this.room?.send(Message.DISCONNECT_STREAM, { clientId: id })\n    this.webRTC?.deleteVideoStream(id)\n  }\n\n  connectToComputer(id: string) {\n    this.room?.send(Message.CONNECT_TO_COMPUTER, { computerId: id })\n  }\n\n  disconnectFromComputer(id: string) {\n    this.room?.send(Message.DISCONNECT_FROM_COMPUTER, { computerId: id })\n  }\n\n  connectToWhiteboard(id: string) {\n    this.room?.send(Message.CONNECT_TO_WHITEBOARD, { whiteboardId: id })\n  }\n\n  disconnectFromWhiteboard(id: string) {\n    this.room?.send(Message.DISCONNECT_FROM_WHITEBOARD, { whiteboardId: id })\n  }\n\n  onStopScreenShare(id: string) {\n    this.room?.send(Message.STOP_SCREEN_SHARE, { computerId: id })\n  }\n\n  addChatMessage(content: string) {\n    this.room?.send(Message.ADD_CHAT_MESSAGE, { content: content })\n  }\n}\n","import Phaser from 'phaser'\nimport Network from '../services/Network'\nimport { BackgroundMode } from '../../../types/BackgroundMode'\nimport store from '../stores'\nimport { setRoomJoined } from '../stores/RoomStore'\n\nexport default class Bootstrap extends Phaser.Scene {\n  network!: Network\n\n  constructor() {\n    super('bootstrap')\n  }\n\n  preload() {\n    this.load.atlas(\n      'cloud_day',\n      'assets/background/cloud_day.png',\n      'assets/background/cloud_day.json'\n    )\n    this.load.image('backdrop_day', 'assets/background/backdrop_day.png')\n    this.load.atlas(\n      'cloud_night',\n      'assets/background/cloud_night.png',\n      'assets/background/cloud_night.json'\n    )\n    this.load.image('backdrop_night', 'assets/background/backdrop_night.png')\n    this.load.image('sun_moon', 'assets/background/sun_moon.png')\n\n    this.load.tilemapTiledJSON('tilemap', 'assets/map/map.json')\n    this.load.spritesheet('tiles_wall', 'assets/map/FloorAndGround.png', {\n      frameWidth: 32,\n      frameHeight: 32,\n    })\n    this.load.spritesheet('chairs', 'assets/items/chair.png', {\n      frameWidth: 32,\n      frameHeight: 64,\n    })\n    this.load.spritesheet('computers', 'assets/items/computer.png', {\n      frameWidth: 96,\n      frameHeight: 64,\n    })\n    this.load.spritesheet('whiteboards', 'assets/items/whiteboard.png', {\n      frameWidth: 64,\n      frameHeight: 64,\n    })\n    this.load.spritesheet('vendingmachines', 'assets/items/vendingmachine.png', {\n      frameWidth: 48,\n      frameHeight: 72,\n    })\n    this.load.spritesheet('office', 'assets/items/Modern_Office_Black_Shadow.png', {\n      frameWidth: 32,\n      frameHeight: 32,\n    })\n    this.load.spritesheet('basement', 'assets/items/Basement.png', {\n      frameWidth: 32,\n      frameHeight: 32,\n    })\n    this.load.spritesheet('generic', 'assets/items/Generic.png', {\n      frameWidth: 32,\n      frameHeight: 32,\n    })\n    this.load.spritesheet('adam', 'assets/character/adam.png', {\n      frameWidth: 32,\n      frameHeight: 48,\n    })\n    this.load.spritesheet('ash', 'assets/character/ash.png', {\n      frameWidth: 32,\n      frameHeight: 48,\n    })\n    this.load.spritesheet('lucy', 'assets/character/lucy.png', {\n      frameWidth: 32,\n      frameHeight: 48,\n    })\n    this.load.spritesheet('nancy', 'assets/character/nancy.png', {\n      frameWidth: 32,\n      frameHeight: 48,\n    })\n  }\n\n  init() {\n    this.network = new Network()\n  }\n\n  create() {\n    this.launchBackground(store.getState().user.backgroundMode)\n  }\n\n  private launchBackground(backgroundMode: BackgroundMode) {\n    //this.scene.launch('background', { backgroundMode })\n  }\n\n  launchGame() {\n    this.network.webRTC?.checkPreviousPermission()\n    this.scene.launch('game', {\n      network: this.network,\n    })\n\n    // update Redux state\n    store.dispatch(setRoomJoined(true))\n  }\n\n  changeBackgroundMode(backgroundMode: BackgroundMode) {\n    this.scene.stop('background')\n    this.launchBackground(backgroundMode)\n  }\n}\n","import Phaser from 'phaser'\r\nimport Game from './scenes/Game'\r\nimport Background from './scenes/Background'\r\nimport Bootstrap from './scenes/Bootstrap'\r\n\r\nconst config: Phaser.Types.Core.GameConfig = {\r\n  type: Phaser.AUTO,\r\n  parent: 'phaser-container',\r\n  backgroundColor: '#93cbee',\r\n  pixelArt: true, // Prevent pixel art from becoming blurred when scaled.\r\n  scale: {\r\n    mode: Phaser.Scale.ScaleModes.RESIZE,\r\n    width: window.innerWidth,\r\n    height: window.innerHeight,\r\n  },\r\n  physics: {\r\n    default: 'arcade',\r\n    arcade: {\r\n      gravity: { y: 0 },\r\n      debug: false,\r\n    },\r\n  },\r\n  autoFocus: true,\r\n  scene: [Bootstrap, Background, Game],\r\n}\r\n\r\nconst phaserGame = new Phaser.Game(config)\r\n\r\n;(window as any).game = phaserGame\r\n\r\nexport default phaserGame\r\n","import { createTheme } from '@mui/material/styles'\n\nconst muiTheme = createTheme({\n  palette: {\n    mode: 'dark',\n    primary: {\n      main: '#426dea',\n    },\n    secondary: {\n      main: '#42eacb',\n    },\n  },\n})\n\nexport default muiTheme\n","import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux'\r\nimport type { RootState, AppDispatch } from './stores'\r\n\r\n// Use throughout your app instead of plain `useDispatch` and `useSelector`\r\nexport const useAppDispatch = () => useDispatch<AppDispatch>()\r\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector\r\n","import React, { useState } from 'react'\nimport styled from 'styled-components'\nimport Button from '@mui/material/Button'\nimport Paper from '@mui/material/Paper'\nimport TableContainer from '@mui/material/TableContainer'\nimport Table from '@mui/material/Table'\nimport TableRow from '@mui/material/TableRow'\nimport TableCell from '@mui/material/TableCell'\nimport TableHead from '@mui/material/TableHead'\nimport TableBody from '@mui/material/TableBody'\nimport Tooltip from '@mui/material/Tooltip'\nimport TextField from '@mui/material/TextField'\nimport Dialog from '@mui/material/Dialog'\nimport DialogActions from '@mui/material/DialogActions'\nimport DialogContent from '@mui/material/DialogContent'\nimport Alert from '@mui/material/Alert'\nimport Avatar from '@mui/material/Avatar'\nimport PeopleAltIcon from '@mui/icons-material/PeopleAlt'\nimport LockIcon from '@mui/icons-material/Lock'\nimport { useAppSelector } from '../hooks'\nimport { getAvatarString, getColorByString } from '../util'\n\nimport phaserGame from '../PhaserGame'\nimport Bootstrap from '../scenes/Bootstrap'\n\nconst MessageText = styled.p`\n  margin: 10px;\n  font-size: 18px;\n  color: #eee;\n  text-align: center;\n`\n\nconst CustomRoomTableContainer = styled(TableContainer)`\n  max-height: 500px;\n\n  table {\n    min-width: 650px;\n  }\n`\n\nconst TableRowWrapper = styled(TableRow)`\n  &:last-child td,\n  &:last-child th {\n    border: 0;\n  }\n\n  .avatar {\n    height: 30px;\n    width: 30px;\n    font-size: 15px;\n  }\n\n  .name {\n    min-width: 100px;\n    overflow-wrap: anywhere;\n  }\n\n  .description {\n    min-width: 200px;\n    overflow-wrap: anywhere;\n  }\n\n  .join-wrapper {\n    display: flex;\n    gap: 3px;\n    align-items: center;\n  }\n\n  .lock-icon {\n    font-size: 18px;\n  }\n`\n\nconst PasswordDialog = styled(Dialog)`\n  .dialog-content {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n  }\n\n  .MuiDialog-paper {\n    background: #222639;\n  }\n`\n\nexport const CustomRoomTable = () => {\n  const [password, setPassword] = useState('')\n  const [selectedRoom, setSelectedRoom] = useState('')\n  const [showPasswordDialog, setShowPasswordDialog] = useState(false)\n  const [showPasswordError, setShowPasswordError] = useState(false)\n  const [passwordFieldEmpty, setPasswordFieldEmpty] = useState(false)\n  const lobbyJoined = useAppSelector((state) => state.room.lobbyJoined)\n  const availableRooms = useAppSelector((state) => state.room.availableRooms)\n\n  const handleJoinClick = (roomId: string, password: string | null) => {\n    if (!lobbyJoined) return\n    const bootstrap = phaserGame.scene.keys.bootstrap as Bootstrap\n    bootstrap.network\n      .joinCustomById(roomId, password)\n      .then(() => bootstrap.launchGame())\n      .catch((error) => {\n        console.error(error)\n        if (password) setShowPasswordError(true)\n      })\n  }\n\n  const handlePasswordSubmit = (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault()\n    const isValidPassword = password !== ''\n\n    if (isValidPassword === passwordFieldEmpty) setPasswordFieldEmpty(!passwordFieldEmpty)\n    if (isValidPassword) handleJoinClick(selectedRoom, password)\n  }\n\n  const resetPasswordDialog = () => {\n    setShowPasswordDialog(false)\n    setPassword('')\n    setPasswordFieldEmpty(false)\n    setShowPasswordError(false)\n  }\n\n  return availableRooms.length === 0 ? (\n    <MessageText>There are no custom rooms now, create one or join the public lobby.</MessageText>\n  ) : (\n    <>\n      <CustomRoomTableContainer component={Paper}>\n        <Table>\n          <TableHead>\n            <TableRow>\n              <TableCell></TableCell>\n              <TableCell>Name</TableCell>\n              <TableCell>Description</TableCell>\n              <TableCell>ID</TableCell>\n              <TableCell align=\"center\">\n                <PeopleAltIcon />\n              </TableCell>\n              <TableCell align=\"right\"></TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {availableRooms.map((room) => {\n              const { roomId, metadata, clients } = room\n              const { name, description, hasPassword } = metadata\n              return (\n                <TableRowWrapper key={roomId}>\n                  <TableCell>\n                    <Avatar className=\"avatar\" style={{ background: getColorByString(name) }}>\n                      {getAvatarString(name)}\n                    </Avatar>\n                  </TableCell>\n                  <TableCell>\n                    <div className=\"name\">{name}</div>\n                  </TableCell>\n                  <TableCell>\n                    <div className=\"description\">{description}</div>\n                  </TableCell>\n                  <TableCell>{roomId}</TableCell>\n                  <TableCell align=\"center\">{clients}</TableCell>\n                  <TableCell align=\"center\">\n                    <Tooltip title={hasPassword ? 'Password required' : ''}>\n                      <Button\n                        variant=\"outlined\"\n                        color=\"secondary\"\n                        onClick={() => {\n                          if (hasPassword) {\n                            setShowPasswordDialog(true)\n                            setSelectedRoom(roomId)\n                          } else {\n                            handleJoinClick(roomId, null)\n                          }\n                        }}\n                      >\n                        <div className=\"join-wrapper\">\n                          {hasPassword && <LockIcon className=\"lock-icon\" />}\n                          Join\n                        </div>\n                      </Button>\n                    </Tooltip>\n                  </TableCell>\n                </TableRowWrapper>\n              )\n            })}\n          </TableBody>\n        </Table>\n      </CustomRoomTableContainer>\n      <PasswordDialog open={showPasswordDialog} onClose={resetPasswordDialog}>\n        <form onSubmit={handlePasswordSubmit}>\n          <DialogContent className=\"dialog-content\">\n            <MessageText>This a private room, please enter password:</MessageText>\n            <TextField\n              autoFocus\n              fullWidth\n              error={passwordFieldEmpty}\n              helperText={passwordFieldEmpty && 'Required'}\n              value={password}\n              label=\"Password\"\n              type=\"password\"\n              variant=\"outlined\"\n              color=\"secondary\"\n              onInput={(e) => {\n                setPassword((e.target as HTMLInputElement).value)\n              }}\n            />\n            {showPasswordError && (\n              <Alert severity=\"error\" variant=\"outlined\">\n                Incorrect Password!\n              </Alert>\n            )}\n          </DialogContent>\n          <DialogActions>\n            <Button color=\"secondary\" onClick={resetPasswordDialog}>\n              Cancel\n            </Button>\n            <Button color=\"secondary\" type=\"submit\">\n              Join\n            </Button>\n          </DialogActions>\n        </form>\n      </PasswordDialog>\n    </>\n  )\n}\n","import React, { useState } from 'react'\nimport styled from 'styled-components'\nimport Button from '@mui/material/Button'\nimport IconButton from '@mui/material/IconButton'\nimport TextField from '@mui/material/TextField'\nimport InputAdornment from '@mui/material/InputAdornment'\nimport Visibility from '@mui/icons-material/Visibility'\nimport VisibilityOff from '@mui/icons-material/VisibilityOff'\n\nimport { IRoomData } from '../../../types/Rooms'\nimport { useAppSelector } from '../hooks'\n\nimport phaserGame from '../PhaserGame'\nimport Bootstrap from '../scenes/Bootstrap'\n\nconst CreateRoomFormWrapper = styled.form`\n  display: flex;\n  flex-direction: column;\n  width: 320px;\n  gap: 20px;\n`\n\nexport const CreateRoomForm = () => {\n  const [values, setValues] = useState<IRoomData>({\n    name: '',\n    description: '',\n    password: null,\n    autoDispose: true,\n  })\n  const [showPassword, setShowPassword] = useState(false)\n  const [nameFieldEmpty, setNameFieldEmpty] = useState(false)\n  const [descriptionFieldEmpty, setDescriptionFieldEmpty] = useState(false)\n  const lobbyJoined = useAppSelector((state) => state.room.lobbyJoined)\n\n  const handleChange = (prop: keyof IRoomData) => (event: React.ChangeEvent<HTMLInputElement>) => {\n    setValues({ ...values, [prop]: event.target.value })\n  }\n\n  const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault()\n    const isValidName = values.name !== ''\n    const isValidDescription = values.description !== ''\n\n    if (isValidName === nameFieldEmpty) setNameFieldEmpty(!nameFieldEmpty)\n    if (isValidDescription === descriptionFieldEmpty)\n      setDescriptionFieldEmpty(!descriptionFieldEmpty)\n\n    // create custom room if name and description are not empty\n    if (isValidName && isValidDescription && lobbyJoined) {\n      const bootstrap = phaserGame.scene.keys.bootstrap as Bootstrap\n      bootstrap.network\n        .createCustom(values)\n        .then(() => bootstrap.launchGame())\n        .catch((error) => console.error(error))\n    }\n  }\n\n  return (\n    <CreateRoomFormWrapper onSubmit={handleSubmit}>\n      <TextField\n        label=\"Name\"\n        variant=\"outlined\"\n        color=\"secondary\"\n        autoFocus\n        error={nameFieldEmpty}\n        helperText={nameFieldEmpty && 'Name is required'}\n        onChange={handleChange('name')}\n      />\n\n      <TextField\n        label=\"Description\"\n        variant=\"outlined\"\n        color=\"secondary\"\n        error={descriptionFieldEmpty}\n        helperText={descriptionFieldEmpty && 'Description is required'}\n        multiline\n        rows={4}\n        onChange={handleChange('description')}\n      />\n\n      <TextField\n        type={showPassword ? 'text' : 'password'}\n        label=\"Password (optional)\"\n        onChange={handleChange('password')}\n        color=\"secondary\"\n        InputProps={{\n          endAdornment: (\n            <InputAdornment position=\"end\">\n              <IconButton\n                aria-label=\"toggle password visibility\"\n                onClick={() => setShowPassword(!showPassword)}\n                edge=\"end\"\n              >\n                {showPassword ? <VisibilityOff /> : <Visibility />}\n              </IconButton>\n            </InputAdornment>\n          ),\n        }}\n      />\n      <Button variant=\"contained\" color=\"secondary\" type=\"submit\">\n        Create\n      </Button>\n    </CreateRoomFormWrapper>\n  )\n}\n","import React, { useState } from 'react'\nimport logo from '../assets/logo.png'\nimport styled from 'styled-components'\nimport Button from '@mui/material/Button'\nimport IconButton from '@mui/material/IconButton'\nimport Tooltip from '@mui/material/Tooltip'\nimport LinearProgress from '@mui/material/LinearProgress'\nimport Alert from '@mui/material/Alert'\nimport Snackbar from '@mui/material/Snackbar'\nimport HelpOutlineIcon from '@mui/icons-material/HelpOutline'\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack'\n\nimport { CustomRoomTable } from './CustomRoomTable'\nimport { CreateRoomForm } from './CreateRoomForm'\nimport { useAppSelector } from '../hooks'\n\nimport phaserGame from '../PhaserGame'\nimport Bootstrap from '../scenes/Bootstrap'\n\nconst Backdrop = styled.div`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  display: flex;\n  flex-direction: column;\n  gap: 60px;\n  align-items: center;\n`\n\nconst Wrapper = styled.div`\n  background: #222639;\n  border-radius: 16px;\n  padding: 36px 60px;\n  box-shadow: 0px 0px 5px #0000006f;\n`\n\nconst CustomRoomWrapper = styled.div`\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n  align-items: center;\n  justify-content: center;\n\n  .tip {\n    font-size: 18px;\n  }\n`\n\nconst BackButtonWrapper = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n`\n\nconst Title = styled.h1`\n  font-size: 24px;\n  color: #eee;\n  text-align: center;\n`\n\nconst Content = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n  margin: 20px 0;\n  align-items: center;\n  justify-content: center;\n\n  img {\n    border-radius: 8px;\n    height: 120px;\n  }\n`\n\nconst ProgressBarWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  h3 {\n    color: #33ac96;\n  }\n`\n\nconst ProgressBar = styled(LinearProgress)`\n  width: 360px;\n`\n\nexport default function RoomSelectionDialog() {\n  const [showCustomRoom, setShowCustomRoom] = useState(false)\n  const [showCreateRoomForm, setShowCreateRoomForm] = useState(false)\n  const [showSnackbar, setShowSnackbar] = useState(false)\n  const lobbyJoined = useAppSelector((state) => state.room.lobbyJoined)\n\n  const handleConnect = () => {\n    if (lobbyJoined) {\n      const bootstrap = phaserGame.scene.keys.bootstrap as Bootstrap\n      bootstrap.network\n        .joinOrCreatePublic()\n        .then(() => bootstrap.launchGame())\n        .catch((error) => console.error(error))\n    } else {\n      setShowSnackbar(true)\n    }\n  }\n\n  return (\n    <>\n      <Snackbar\n        anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\n        open={showSnackbar}\n        autoHideDuration={3000}\n        onClose={() => {\n          setShowSnackbar(false)\n        }}\n      >\n        <Alert\n          severity=\"error\"\n          variant=\"outlined\"\n          // overwrites the dark theme on render\n          style={{ background: '#fdeded', color: '#7d4747' }}\n        >\n          Trying to connect to server, please try again!\n        </Alert>\n      </Snackbar>\n      <Backdrop>\n        <Wrapper>\n          {showCreateRoomForm ? (\n            <CustomRoomWrapper>\n              <Title>Create Custom Room</Title>\n              <BackButtonWrapper>\n                <IconButton onClick={() => setShowCreateRoomForm(false)}>\n                  <ArrowBackIcon />\n                </IconButton>\n              </BackButtonWrapper>\n              <CreateRoomForm />\n            </CustomRoomWrapper>\n          ) : showCustomRoom ? (\n            <CustomRoomWrapper>\n              <Title>\n                Custom Rooms\n                <Tooltip\n                  title=\"We update the results in realtime, no refresh needed!\"\n                  placement=\"top\"\n                >\n                  <IconButton>\n                    <HelpOutlineIcon className=\"tip\" />\n                  </IconButton>\n                </Tooltip>\n              </Title>\n              <BackButtonWrapper>\n                <IconButton onClick={() => setShowCustomRoom(false)}>\n                  <ArrowBackIcon />\n                </IconButton>\n              </BackButtonWrapper>\n              <CustomRoomTable />\n              <Button\n                variant=\"contained\"\n                color=\"secondary\"\n                onClick={() => setShowCreateRoomForm(true)}\n              >\n                Create new room\n              </Button>\n            </CustomRoomWrapper>\n          ) : (\n            <>\n              <Title>Castle Cafe Test</Title>\n              <Content>\n                {/* <img src={logo} alt=\"logo\" /> */}\n                <Button variant=\"contained\" color=\"secondary\" onClick={handleConnect}>\n                  Connect to server\n                </Button>\n{/*                 \n                <Button\n                  variant=\"outlined\"\n                  color=\"secondary\"\n                  onClick={() => (lobbyJoined ? setShowCustomRoom(true) : setShowSnackbar(true))}\n                >\n                  Create/find custom rooms\n                </Button>\n                 */}\n              </Content>\n            </>\n          )}\n        </Wrapper>\n        {!lobbyJoined && (\n          <ProgressBarWrapper>\n            <h3> Connecting to server...</h3>\n            <ProgressBar color=\"secondary\" />\n          </ProgressBarWrapper>\n        )}\n      </Backdrop>\n    </>\n  )\n}\n","import React, { useState } from 'react'\nimport styled from 'styled-components'\nimport TextField from '@mui/material/TextField'\nimport Button from '@mui/material/Button'\nimport Avatar from '@mui/material/Avatar'\nimport Alert from '@mui/material/Alert'\nimport AlertTitle from '@mui/material/AlertTitle'\nimport ArrowRightIcon from '@mui/icons-material/ArrowRight'\n\nimport { Swiper, SwiperSlide } from 'swiper/react'\nimport SwiperCore, { Navigation } from 'swiper'\nimport 'swiper/swiper.min.css'\nimport 'swiper/components/navigation/navigation.min.css'\n\nimport Adam from '../assets/Adam_login.png'\nimport Ash from '../assets/Ash_login.png'\nimport Lucy from '../assets/Lucy_login.png'\nimport Nancy from '../assets/Nancy_login.png'\nimport { useAppSelector, useAppDispatch } from '../hooks'\nimport { setLoggedIn } from '../stores/UserStore'\nimport { getAvatarString, getColorByString } from '../util'\n\nimport phaserGame from '../PhaserGame'\nimport Game from '../scenes/Game'\n\nSwiperCore.use([Navigation])\n\nconst Wrapper = styled.form`\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background: #222639;\n  border-radius: 16px;\n  padding: 36px 60px;\n  box-shadow: 0px 0px 5px #0000006f;\n`\n\nconst Title = styled.p`\n  margin: 5px;\n  font-size: 20px;\n  color: #c2c2c2;\n  text-align: center;\n`\n\nconst RoomName = styled.div`\n  max-width: 500px;\n  max-height: 120px;\n  overflow-wrap: anywhere;\n  overflow-y: auto;\n  display: flex;\n  gap: 10px;\n  justify-content: center;\n\n  h3 {\n    font-size: 24px;\n    color: #eee;\n  }\n`\n\nconst RoomDescription = styled.div`\n  max-width: 500px;\n  max-height: 150px;\n  overflow-wrap: anywhere;\n  overflow-y: auto;\n  font-size: 16px;\n  color: #c2c2c2;\n  display: flex;\n  justify-content: center;\n`\n\nconst SubTitle = styled.h3`\n  width: 160px;\n  font-size: 16px;\n  color: #eee;\n  text-align: center;\n`\n\nconst Content = styled.div`\n  display: flex;\n  margin: 36px 0;\n`\n\nconst Left = styled.div`\n  margin-right: 48px;\n\n  --swiper-navigation-size: 24px;\n\n  .swiper-container {\n    width: 160px;\n    height: 220px;\n    border-radius: 8px;\n    overflow: hidden;\n  }\n\n  .swiper-slide {\n    width: 160px;\n    height: 220px;\n    background: #dbdbe0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .swiper-slide img {\n    display: block;\n    width: 95px;\n    height: 136px;\n    object-fit: contain;\n  }\n`\n\nconst Right = styled.div`\n  width: 300px;\n`\n\nconst Bottom = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\n\nconst Warning = styled.div`\n  margin-top: 30px;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  gap: 3px;\n`\n\nconst avatars = [\n  { name: 'adam', img: Adam },\n  //{ name: 'ash', img: Ash },\n  { name: 'lucy', img: Lucy },\n  //{ name: 'nancy', img: Nancy },\n]\n\n// shuffle the avatars array\nfor (let i = avatars.length - 1; i > 0; i--) {\n  const j = Math.floor(Math.random() * (i + 1))\n  ;[avatars[i], avatars[j]] = [avatars[j], avatars[i]]\n}\n\nexport default function LoginDialog() {\n  const [name, setName] = useState<string>('')\n  const [avatarIndex, setAvatarIndex] = useState<number>(0)\n  const [nameFieldEmpty, setNameFieldEmpty] = useState<boolean>(false)\n  const dispatch = useAppDispatch()\n  const videoConnected = useAppSelector((state) => state.user.videoConnected)\n  const roomJoined = useAppSelector((state) => state.room.roomJoined)\n  const roomName = useAppSelector((state) => state.room.roomName)\n  const roomDescription = useAppSelector((state) => state.room.roomDescription)\n  const game = phaserGame.scene.keys.game as Game\n\n  const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault()\n    if (name === '') {\n      setNameFieldEmpty(true)\n    } else if (roomJoined) {\n      console.log('Join! Name:', name, 'Avatar:', avatars[avatarIndex].name)\n      game.registerKeys()\n      game.myPlayer.setPlayerName(name)\n      game.myPlayer.setPlayerTexture(avatars[avatarIndex].name)\n      game.network.readyToConnect()\n      dispatch(setLoggedIn(true))\n    }\n  }\n\n  return (\n    <Wrapper onSubmit={handleSubmit}>\n      <Title>Joining</Title>\n      <RoomName>\n        <Avatar style={{ background: getColorByString(roomName) }}>\n          {getAvatarString(roomName)}\n        </Avatar>\n        <h3>{roomName}</h3>\n      </RoomName>\n      <RoomDescription>\n        <ArrowRightIcon /> {roomDescription}\n      </RoomDescription>\n      <Content>\n        <Left>\n          <SubTitle>Select an avatar</SubTitle>\n          <Swiper\n            // install Swiper modules\n            navigation\n            spaceBetween={0}\n            slidesPerView={1}\n            onSlideChange={(swiper) => {\n              setAvatarIndex(swiper.activeIndex)\n            }}\n          >\n            {avatars.map((avatar) => (\n              <SwiperSlide key={avatar.name}>\n                <img src={avatar.img} alt={avatar.name} />\n              </SwiperSlide>\n            ))}\n          </Swiper>\n        </Left>\n        <Right>\n          <TextField\n            autoFocus\n            fullWidth\n            label=\"Name\"\n            variant=\"outlined\"\n            color=\"secondary\"\n            error={nameFieldEmpty}\n            helperText={nameFieldEmpty && 'Name is required'}\n            onInput={(e) => {\n              setName((e.target as HTMLInputElement).value)\n            }}\n          />\n          {/* {!videoConnected && (\n            <Warning>\n              <Alert variant=\"outlined\" severity=\"warning\">\n                <AlertTitle>Warning</AlertTitle>\n                No webcam/mic connected - <strong>connect one for best experience!</strong>\n              </Alert>\n              <Button\n                variant=\"outlined\"\n                color=\"secondary\"\n                onClick={() => {\n                  game.network.webRTC?.getUserMedia()\n                }}\n              >\n                Connect Webcam\n              </Button>\n            </Warning>\n          )} */}\n\n          {videoConnected && (\n            <Warning>\n              <Alert variant=\"outlined\">Webcam connected!</Alert>\n            </Warning>\n          )}\n        </Right>\n      </Content>\n      <Bottom>\n        <Button variant=\"contained\" color=\"secondary\" size=\"large\" type=\"submit\">\n          Join\n        </Button>\n      </Bottom>\n    </Wrapper>\n  )\n}\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAABICAMAAACHrYYZAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAclBMVEUAAABWWXJrb2lIS1RAQFc6OlBcYWdcX1dGRl5gY1xISVNISVhFRlBCQll0Z3JRSWZUTGpuXGR0YmuDbG88PFJHR19RRmRWWXJGRl46OlCVnVhoclNfaUpdYEO7o4b/y7D2rp/2l4SAXo6fdKj/uJP///9thjlLAAAAF3RSTlMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAL2TUGAAAAABYktHRCXDAckPAAAAB3RJTUUH5QoFBSgkkKZAkgAAAAFvck5UAc+id5oAAAFaSURBVEjHzZbHcoNAEERFzhljYZMM/P83ukUDhUxpb4zcB7Q704/SpmFvt/8nTdN0Xf9cdH9WXdeGYZimaVmWJGDbNqxfJ30vIuY4juu6YgDcSLwCmqZBG5jneStzPYAOc2c3AaZgw/wKAwoBw+T6vv8YxvUA95zCymfbtuswrgeCIKgXIdRsOmPIwhOGoQBAK93IdV1HU7dpB8gIA0j3fU93vwntdwG9UsIAdtUwDGoABhY1AQBbHK09gdDRd+zCFkWRAIBCEMfxPgws6hFglwOA7VE1rgfwwUuShMDPouGgPQJDmqZiAOZuHMe7UjTIAFmWAZimaVQKBgB5ngsA+JnnmYxCtOEpBmA5eVbP/54nEwYxoCgKhljRzmvM+sXXwSwAYD+hcJRlidCrrzVSMMC2numLAYqngun9iszrIIGny7EgwKVF42PRMfIWoKoqriga1qI/ESngF89yOEmzGHKGAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIxLTEwLTA1VDA1OjM5OjUxKzAwOjAwksUfagAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMS0xMC0wNVQwNTozOTo1MSswMDowMOOYp9YAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAABICAMAAACHrYYZAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAclBMVEUAAABWWXJ6aGVnUVBGRl51ZGFOT2hjU1lfTlRAQFdCQllcS1ByXmODcnk8PFI6OlBHR19pVVNWWXJGRl7CiEvMllmzez+rZzavcjs6OlD/oKD2rp//y7A7eqJ3STTgcHC/ppDQvpxaZ3VqhJPHjFn///+qkMhRAAAAEnRSTlMAAAAAAAAAAAAAAAAAAAAAAACVcz0/AAAAAWJLR0QlwwHJDwAAAAd0SU1FB+UKBgMZFREdlEYAAAABb3JOVAHPoneaAAABUklEQVRIx+2W2VKDQBBFw74lIIoBwiKg//+NXudq1whK+ULnxfvCdM85KZgJxZxO//lzHMdxXffR5GkTz/N839cUQAdBALSqqmcrV5O6rtfO8UIYhqAxZ9OQKWBAR03AJYoi1Jxb0fwVCnEcfzjHC0mSoECraZrrT+Ez0AGsIKRp2rZt/ZWtJlPAACsIWZbxGbZpTOxnAKwg7NDc8tvtJk3ACoK9psLJ/6/rur7v0ZSV1RTkpskRZTBWFmwUpY2ivIvAgvc9DENvhaWyMI4j1xTdF5POinS42YB1BNzZNE32V3D7dQQATEc4n8+o53medgMAGGAFARfsJZ2dCKYmYC+xaly+VdCUl0RHuFwubCHLsmxPV2hyFmPACgJOA/j65nmO1usvwRQAYJ9njYMFpigKEeRNwEAEAN/OrVrCmwkGDyZ25y5CWZbcUQwKk1VHS3gHKAAJ6thLGQcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjEtMTAtMDZUMDM6MjU6MTUrMDA6MDCwX2HiAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIxLTEwLTA2VDAzOjI1OjE1KzAwOjAwwQLZXgAAAABJRU5ErkJggg==\"","import React from 'react'\nimport styled from 'styled-components'\n\nimport { useAppSelector } from './hooks'\n\nimport RoomSelectionDialog from './components/RoomSelectionDialog'\nimport LoginDialog from './components/LoginDialog'\nimport ComputerDialog from './components/ComputerDialog'\nimport WhiteboardDialog from './components/WhiteboardDialog'\nimport VideoConnectionDialog from './components/VideoConnectionDialog'\nimport Chat from './components/Chat'\nimport HelperButtonGroup from './components/HelperButtonGroup'\n\nconst Backdrop = styled.div`\n  position: absolute;\n  height: 100%;\n  width: 100%;\n`\n\nfunction App() {\n  const loggedIn = useAppSelector((state) => state.user.loggedIn)\n  //const computerDialogOpen = useAppSelector((state) => state.computer.computerDialogOpen)\n  //const whiteboardDialogOpen = useAppSelector((state) => state.whiteboard.whiteboardDialogOpen)\n  //const videoConnected = useAppSelector((state) => state.user.videoConnected)\n  const roomJoined = useAppSelector((state) => state.room.roomJoined)\n\n  let ui: JSX.Element\n  if (loggedIn) {\n    // if (computerDialogOpen) {\n    //   /* Render ComputerDialog if user is using a computer. */\n    //   ui = <ComputerDialog />\n    // } else if (whiteboardDialogOpen) {\n    //   /* Render WhiteboardDialog if user is using a whiteboard. */\n    //   ui = <WhiteboardDialog />\n    // } else {\n      ui = (\n        /* Render Chat or VideoConnectionDialog if no dialogs are opened. */\n        <>\n          {/* <Chat /> */}\n          {/* Render VideoConnectionDialog if user is not connected to a webcam. */}\n          {/* {!videoConnected && <VideoConnectionDialog />} */}\n        </>\n      )\n    // }\n  } else if (roomJoined) {\n    /* Render LoginDialog if not logged in but selected a room. */\n    ui = <LoginDialog />\n  } else {\n    /* Render RoomSelectionDialog if yet selected a room. */\n    ui = <RoomSelectionDialog />\n  }\n\n  return (\n    <Backdrop>\n      {ui}\n      {/* Render HelperButtonGroup if no dialogs are opened. */}\n      {/* {!computerDialogOpen && !whiteboardDialogOpen && <HelperButtonGroup />} */}\n    </Backdrop>\n  )\n}\n\nexport default App\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import 'regenerator-runtime/runtime'\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport { Provider } from 'react-redux'\nimport { ThemeProvider } from '@mui/material/styles'\n\nimport './index.scss'\nimport './PhaserGame'\nimport muiTheme from './MuiTheme'\nimport App from './App'\nimport reportWebVitals from './reportWebVitals'\nimport store from './stores'\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <ThemeProvider theme={muiTheme}>\n        <App />\n      </ThemeProvider>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}